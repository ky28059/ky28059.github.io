(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[399],{3947:function(e,t,n){Promise.resolve().then(n.bind(n,73343)),Promise.resolve().then(n.bind(n,78251))},62804:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(57437);function r(e){let{value:t,setValue:n,label:r}=e;return(0,a.jsxs)("div",{className:"flex flex-col gap-1 flex-grow",children:[(0,a.jsx)("label",{className:"text-xs text-secondary dark:text-secondary-dark",children:r}),(0,a.jsx)("input",{type:"text",value:t,onChange:e=>n(e.target.value),className:"rounded px-3 py-1 dark:bg-[#2b2b2b] border border-secondary/40 dark:border-secondary-dark/40"})]})}},78251:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var a=n(57437),r=n(258);function o(e){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"text-sm mb-1 text-secondary dark:text-secondary-dark",children:["Code:"," ",(0,a.jsx)("button",{onClick:()=>navigator.clipboard.writeText(e.children),className:"hover:underline",children:"(copy)"})]}),(0,a.jsx)("div",{className:"rounded-lg overflow-hidden text-xs"+(e.className?" ".concat(e.className):""),children:(0,a.jsx)(r.SyntaxHighlighter,{language:"javascript",children:e.children})})]})}},73343:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var a=n(57437),r=n(2265),o=n(78251),s=n(62804);function i(){let[e,t]=(0,r.useState)(1e3),[n,i]=(0,r.useState)(2e4),[l,u]=(0,r.useState)(1e3),[m,h]=(0,r.useState)([1,34,16,6,4,5]),[f,p]=(0,r.useState)([165,167,166]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-x-3 gap-y-1.5 mb-6 md:mb-4",children:[(0,a.jsx)(s.Z,{label:"Lower room rate ($)",value:e,setValue:e=>!isNaN(Number(e))&&t(Number(e))}),(0,a.jsx)(s.Z,{label:"Upper room rate ($)",value:n,setValue:e=>!isNaN(Number(e))&&i(Number(e))}),(0,a.jsx)(s.Z,{label:"Delay (ms)",value:l,setValue:e=>!isNaN(Number(e))&&u(Number(e))})]}),(0,a.jsxs)("div",{className:"flex gap-24 pl-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(d,{id:166,ids:f,setIds:p,children:"Apartment"}),(0,a.jsx)(d,{id:165,ids:f,setIds:p,children:"Double"}),(0,a.jsx)(d,{id:198,ids:f,setIds:p,children:"Quad"}),(0,a.jsx)(d,{id:169,ids:f,setIds:p,children:"Single"}),(0,a.jsx)(d,{id:167,ids:f,setIds:p,children:"Suite"}),(0,a.jsx)(d,{id:168,ids:f,setIds:p,children:"Triple"})]}),(0,a.jsxs)("div",{className:"grid sm:grid-cols-2 lg:grid-rows-6 lg:grid-flow-col gap-x-6",children:[(0,a.jsx)(d,{id:1,ids:m,setIds:h,children:"Cary Quadrangle"}),(0,a.jsx)(d,{id:2,ids:m,setIds:h,children:"Earhart"}),(0,a.jsx)(d,{id:3,ids:m,setIds:h,children:"First Street Towers"}),(0,a.jsx)(d,{id:34,ids:m,setIds:h,children:"Frieda Parker"}),(0,a.jsx)(d,{id:4,ids:m,setIds:h,children:"Harrison"}),(0,a.jsx)(d,{id:5,ids:m,setIds:h,children:"Hawkins"}),(0,a.jsx)(d,{id:6,ids:m,setIds:h,children:"Hillenbrand"}),(0,a.jsx)(d,{id:17,ids:m,setIds:h,children:"Honors"}),(0,a.jsx)(d,{id:8,ids:m,setIds:h,children:"McCutcheon"}),(0,a.jsx)(d,{id:9,ids:m,setIds:h,children:"Meredith"}),(0,a.jsx)(d,{id:33,ids:m,setIds:h,children:"Meredith South"}),(0,a.jsx)(d,{id:10,ids:m,setIds:h,children:"Owen"}),(0,a.jsx)(d,{id:12,ids:m,setIds:h,children:"Shreve"}),(0,a.jsx)(d,{id:13,ids:m,setIds:h,children:"Tarkington"}),(0,a.jsx)(d,{id:14,ids:m,setIds:h,children:"Wiley"}),(0,a.jsx)(d,{id:15,ids:m,setIds:h,children:"Windsor"}),(0,a.jsx)(d,{id:16,ids:m,setIds:h,children:"Winifred Parker"})]})]}),(0,a.jsx)(o.default,{className:"mb-10",children:c(e,n,l,f,m)})]})}function d(e){let{id:t,ids:n,setIds:r,children:o}=e;return(0,a.jsxs)("div",{className:"flex gap-3 text-primary dark:text-primary-dark",children:[(0,a.jsx)("input",{type:"checkbox",className:"accent-grapefruit",checked:n.includes(t),onChange:e=>{e.target.checked?r([...n,t]):r(n.filter(e=>e!==t))}}),o]})}let c=(e,t,n,a,r)=>"const roomTypeIds = [".concat(a.join(", "),"];\nconst buildingIds = [").concat(r.join(", "),"];\nconst lowerRoomRate = ").concat(e,";\nconst upperRoomRate = ").concat(t,";\nconst delay = ").concat(n,';\n\nlet id;\n;(async () => {\n    // Parse URL token from search param after login\n    const params = new URLSearchParams(location.search);\n    const urlToken = params.get(\'UrlToken\');\n\n    const dateStart = params.get(\'DateStart\');\n    const dateEnd = params.get(\'DateEnd\');\n    const termId = params.get(\'TermID\');\n    const classificationId = params.get(\'ClassificationID\');\n\n    const verificationToken = document.body.innerHTML.match(/<input name="__RequestVerificationToken" type="hidden" value="(.+)"\\s*\\/?>/)?.[1];\n    if (!verificationToken) return log(\'Could not parse request verification token!\');\n\n    const data = document.body.innerHTML.match(/<div class="" data-actualaddingroomtocartoption=".*" data-canaddroomstocart=".*" data-classificationid=".+" data-currencysymbol=".*" data-currentpagenumber="(.+)" data-dateend="(.+)" data-datestart="(.+)" data-filterresultshash="(.+)" data-invalidfieldresponse=".*" data-isauthenticated=".*" data-lowerroomratevalue=".*" data-maximumroomratefilterarialabel=".*" data-maximumroomratefiltervalue=".*" data-minimumroomratefilterarialabel=".*" data-minimumroomratefiltervalue=".*" data-mustselectroommessage=".+" data-portalpageid=".+" data-portalrulestatus=".*" data-processid="(.+)" data-roombaseids=".*" data-roomrateid=".*" data-roomselectionpageid="(.*)" data-showfilterswithoutrooms=".*" data-termid=".+" data-unknowninvalidfieldresponse=".*" data-upperroomratevalue=".*" data-useroommateclassifications=".*" id="page-container">/)\n    if (!data) return log(\'Could not parse other page data!\');\n    const [, currentPageNumber, dateEndISO, dateStartISO, filterHash, processId, roomSelectionPageId] = data;\n\n    // Construct filter request body\n    const filterBody = {\n        classificationID: Number(classificationId),\n        currentPageNumber: Number(currentPageNumber),\n        termID: Number(termId),\n        filters: {\n            DateStart: dateStartISO,\n            DateEnd: dateEndISO,\n            ProfileItemID: roomTypeIds, // Room type IDs\n            RoomLocationID: buildingIds, // Building IDs\n            RoomBaseIDs: [],\n            RoomLocationAreaID: [],\n            RoomLocationFloorSuiteID: [],\n            RoomTypeID: [],\n            UseRoommateClassifications: false,\n            LowerRoomRateValue: lowerRoomRate,\n            UpperRoomRateValue: upperRoomRate,\n        }\n    }\n\n    id = setInterval(queryRooms, delay);\n\n    async function queryRooms() {\n        const res = await fetch(`https://purdue.starrezhousing.com/StarRezPortalX/General/RoomSearch/roomsearch/GetFilterResultsAuthenticated?hash=${filterHash}&pageID=${roomSelectionPageId}&processID=${processId}`, {\n            method: \'POST\',\n            body: JSON.stringify(filterBody),\n            headers: {\n                __RequestVerificationToken: verificationToken,\n                \'Content-Type\': \'application/json\',\n                \'X-Requested-With\': \'XMLHttpRequest\'\n            }\n        });\n        if (!res.ok) return log(\'Error while fetching filter endpoint\');\n\n        const parsed = await res.json();\n        if (!(\'ResultsHtml\' in parsed)) {\n            log(\'Error response when fetching filter endpoint\');\n            return console.log(parsed);\n        }\n\n        console.log(parsed.ResultsHtml);\n\n        // Search HTML response for "add to cart" buttons\n        const matches = [...parsed.ResultsHtml.matchAll(/<button aria-label="Add (.+) To Cart" class="ui-add-room-to-cart sr_button_primary sr_button" data-hash="(.+)" data-url="(.+)" title="Add To Cart" type="button">.+<\\/button>/g)];\n        if (!matches.length) return log(\'No rooms found\');\n\n        for (const [, name, hash, url] of matches) {\n            log(`Found room ${name}`);\n\n            // Match room base and rate ID from broken url data param\n            const roomMatch = url.match(/roomBaseID=(.+?)&amp;roomRateID=(.+?)&amp;/);\n            if (!roomMatch) {\n                log(`Couldn\'t find base and rate ID for room ${name}`)\n                continue;\n            }\n\n            // Add room to cart\n            const [, roomBaseId, roomRateId] = roomMatch;\n            const res = await fetch(`https://purdue.starrezhousing.com/StarRezPortalX/General/RoomSearch/roomsearch/AddRoomToCartForTerm?hash=${hash}&checkInDate=${dateStartISO}&checkOutDate=${dateEndISO}&termID=${termId}&pageID=${roomSelectionPageId}&roomBaseID=${roomBaseId}&roomRateID=${roomRateId}`, {\n                method: \'POST\',\n                body: JSON.stringify({}),\n                headers: {\n                    __RequestVerificationToken: verificationToken,\n                    \'Content-Type\': \'application/json\',\n                    \'X-Requested-With\': \'XMLHttpRequest\'\n                }\n            });\n            if (!res.ok) {\n                log(`Error adding room ${name} to cart`);\n                continue;\n            }\n\n            // Construct next page request body\n            const continueBody = {\n                RoomLocationID: buildingIds,\n                ProfileItemID: roomTypeIds,\n                PageWidgetData: []\n            }\n            for (const id of [1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 16, 17, 33, 34])\n                continueBody[`${id}-checkbox`] = buildingIds.includes(id);\n            for (const id of [165, 166, 167, 168, 169, 198])\n                continueBody[`${id}-checkbox`] = roomTypeIds.includes(id);\n\n            // Fetch next page URL and open it in a new tab if everything is successful\n            const checkoutRawUrl = await (await fetch(window.location.href, {\n                method: \'POST\',\n                body: JSON.stringify(continueBody),\n                headers: {\n                    __RequestVerificationToken: verificationToken,\n                    \'Content-Type\': \'application/json\',\n                    \'X-Requested-With\': \'XMLHttpRequest\'\n                }\n            })).text();\n\n            window.open(checkoutRawUrl.slice(1, -1).replaceAll(\'\\\\u0026\', \'&\'));\n            clearInterval(id);\n        }\n    }\n})();\n\nfunction log(m) {\n    console.log(`[${new Date().toLocaleTimeString()}]: ${m}`);\n}')},258:function(e,t,n){"use strict";n.r(t),n.d(t,{SyntaxHighlighter:function(){return i},default:function(){return s}});var a=n(57437),r=n(2265),o=n(71542);function s(e){var t,n,o;let{sources:s}=e,[d,c]=(0,r.useState)(0),[l,u]=(0,r.useState)([]);return(0,r.useEffect)(()=>{Promise.all(s.map(e=>fetch(e).then(e=>e.text()))).then(e=>u(e))},[]),(0,a.jsxs)("div",{className:"flex flex-col rounded-lg overflow-hidden w-[36rem] h-[36rem] max-w-full flex-none text-xs bg-[#2b2b2b] border border-gray-100/20",children:[(0,a.jsx)("div",{className:"flex bg-[#484a4a]/50",children:s.map((e,t)=>{var n;return(0,a.jsx)("button",{className:"px-3.5 py-1.5 font-[Consolas,_Monaco,_'Andale_Mono',_monospace] text-[#a9b7c6]"+(d===t?" bg-[#2b2b2b]":""),onClick:()=>c(t),children:null===(n=e.match(/.+\/(.+)/))||void 0===n?void 0:n[1]},e)})}),(0,a.jsx)(i,{language:null!==(n="kt"===(o=null===(t=s[d].match(/.+\.(.+)/))||void 0===t?void 0:t[1])?"kotlin":o)&&void 0!==n?n:"java",children:l[d]})]})}function i(e){return(0,a.jsx)(o.Z,{language:e.language,codeTagProps:{style:{}},showLineNumbers:!0,useInlineStyles:!1,children:e.children})}}},function(e){e.O(0,[235,971,596,744],function(){return e(e.s=3947)}),_N_E=e.O()}]);