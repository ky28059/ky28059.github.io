<!DOCTYPE html><!--nDyrqgKsYWBjc5CSiVf1q--><html class="dark scroll-smooth"><head><meta charSet="utf-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="https://gist.github.com/assets/60120929/8a7bcf44-918b-4380-b7e2-44a5ce655b41"/><link rel="preload" as="image" href="https://gist.github.com/assets/60120929/18a24f96-2c02-4724-8f82-83cbc7d6fca0"/><link rel="preload" as="image" href="https://gist.github.com/assets/60120929/b64bfd80-e89b-4b45-9a85-ee9b43ba78d0"/><link rel="preload" as="image" href="https://gist.github.com/assets/60120929/fbdb0a75-094d-4e7e-aa77-ca984f9b4b72"/><link rel="preload" as="image" href="https://gist.github.com/assets/60120929/7b8dd2a2-0d32-4f4d-86a1-4bf6d90b0844"/><link rel="preload" as="image" href="https://gist.github.com/assets/60120929/a8c791eb-cd5e-4aed-b4e6-0d6d3978fc29"/><link rel="stylesheet" href="/_next/static/css/5137b7a074c35308.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-d11e0b30904b49ad.js"/><script src="/_next/static/chunks/4bd1b696-9911af18dede28aa.js" async=""></script><script src="/_next/static/chunks/964-2bcac1827bbf29c7.js" async=""></script><script src="/_next/static/chunks/main-app-771e5b53791411ad.js" async=""></script><script src="/_next/static/chunks/874-3e820bd666038662.js" async=""></script><script src="/_next/static/chunks/app/writeups/%5Bid%5D/layout-2577bd3482649595.js" async=""></script><script src="/_next/static/chunks/bc9c3264-6371ca03223855d4.js" async=""></script><script src="/_next/static/chunks/48507feb-8452885980bba250.js" async=""></script><script src="/_next/static/chunks/08ffe114-f47006c90e36a3eb.js" async=""></script><script src="/_next/static/chunks/800-bd0deb6e7b7e903a.js" async=""></script><script src="/_next/static/chunks/app/writeups/%5Bid%5D/page-54fe20cc7a9d3224.js" async=""></script><meta name="next-size-adjust" content=""/><title>LA CTF 2024 — gacha | kevin.fish</title><meta name="description" content="All my friends have been getting into genshin and honkai recently and keep sending me pictures. However, they keep hiding their favorite characters, demanding for more money for their gacha pulls."/><meta property="og:title" content="LA CTF 2024 — gacha"/><meta property="og:description" content="All my friends have been getting into genshin and honkai recently and keep sending me pictures. However, they keep hiding their favorite characters, demanding for more money for their gacha pulls."/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="LA CTF 2024 — gacha"/><meta name="twitter:description" content="All my friends have been getting into genshin and honkai recently and keep sending me pictures. However, they keep hiding their favorite characters, demanding for more money for their gacha pulls."/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="text-dark dark:text-white dark:bg-midnight" style="font-family:&#x27;Inter&#x27;, &#x27;Inter Fallback&#x27;;font-style:normal"><div hidden=""><!--$--><!--/$--></div><main class="container pt-20 pb-24"><a class="text-secondary text-sm mb-10 -ml-5 block w-max" href="/writeups">← Back to writeups</a><div><main class="text-pretty max-w-5xl mx-auto text-sm [&amp;_h1]:text-5xl [&amp;_h1]:font-semibold [&amp;_h1]:mb-8 [&amp;_blockquote]:text-secondary [&amp;_blockquote]:space-y-3 [&amp;_blockquote]:border-l-4 [&amp;_blockquote]:border-secondary [&amp;_blockquote]:pl-5 [&amp;_blockquote]:mb-5 [&amp;&gt;_p]:my-4 [&amp;_img]:my-5 [&amp;_ul]:list-disc [&amp;_ul]:pl-6 [&amp;_ol]:list-decimal [&amp;_ol]:pl-6 [&amp;_img]:rounded [&amp;_li]:my-2"><h1>LA CTF 2024 — gacha</h1>
<blockquote>
<p>All my friends have been getting into genshin and honkai recently and keep sending me pictures. However, they keep hiding their favorite characters, demanding for more money for their gacha pulls.</p>
<p>Can you free zhongli my waifu???</p>
</blockquote>
<p>We&#x27;re given three PNG files:</p>
<p><img src="https://gist.github.com/assets/60120929/8a7bcf44-918b-4380-b7e2-44a5ce655b41" alt="owo"/>
<code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">owo.png</code></p>
<p><img src="https://gist.github.com/assets/60120929/18a24f96-2c02-4724-8f82-83cbc7d6fca0" alt="uwu"/>
<code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">uwu.png</code></p>
<p><img src="https://gist.github.com/assets/60120929/b64bfd80-e89b-4b45-9a85-ee9b43ba78d0" alt="fiscl"/>
<code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">fiscl.png</code></p>
<p>The last one seems unrelated, but the first two are reminiscent of <a href="https://gist.github.com/ky28059/e7fed465703f2943e482cd2d6618ceb4">IslandParty</a>. Writing a script to diff them and view the channels,</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"></path></svg> <!-- -->py<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">import</span><span class=""> cv2
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">owo </span><span class="token operator">=</span><span class=""> cv2</span><span class="token punctuation">.</span><span class="">imread</span><span class="token punctuation">(</span><span class="token string">&#x27;owo.png&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="">uwu </span><span class="token operator">=</span><span class=""> cv2</span><span class="token punctuation">.</span><span class="">imread</span><span class="token punctuation">(</span><span class="token string">&#x27;uwu.png&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class="">res </span><span class="token operator">=</span><span class=""> owo </span><span class="token operator">-</span><span class=""> uwu
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="">cv2</span><span class="token punctuation">.</span><span class="">namedWindow</span><span class="token punctuation">(</span><span class="token string">&#x27;image&#x27;</span><span class="token punctuation">,</span><span class=""> cv2</span><span class="token punctuation">.</span><span class="">WINDOW_NORMAL</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">cv2</span><span class="token punctuation">.</span><span class="">imshow</span><span class="token punctuation">(</span><span class="token string">&#x27;image&#x27;</span><span class="token punctuation">,</span><span class=""> res</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="">cv2</span><span class="token punctuation">.</span><span class="">waitKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div></div>
<p><img src="https://gist.github.com/assets/60120929/fbdb0a75-094d-4e7e-aa77-ca984f9b4b72" alt="gacha2"/></p>
<p>(see any letters in the middle row?)</p>
<p>Amplifying the contrast a bit, we can make out a few more letters and...</p>
<p><img src="https://gist.github.com/assets/60120929/7b8dd2a2-0d32-4f4d-86a1-4bf6d90b0844" alt="image"/></p>
<p>...is that a <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">x0r</code> at the end of the flag?</p>
<p>XOR&#x27;ing the images together, we get the flag:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"></path></svg> <!-- -->py<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">import</span><span class=""> cv2
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">owo </span><span class="token operator">=</span><span class=""> cv2</span><span class="token punctuation">.</span><span class="">imread</span><span class="token punctuation">(</span><span class="token string">&#x27;owo.png&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="">uwu </span><span class="token operator">=</span><span class=""> cv2</span><span class="token punctuation">.</span><span class="">imread</span><span class="token punctuation">(</span><span class="token string">&#x27;uwu.png&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class="">res </span><span class="token operator">=</span><span class=""> owo </span><span class="token operator">^</span><span class=""> uwu
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="">cv2</span><span class="token punctuation">.</span><span class="">namedWindow</span><span class="token punctuation">(</span><span class="token string">&#x27;image&#x27;</span><span class="token punctuation">,</span><span class=""> cv2</span><span class="token punctuation">.</span><span class="">WINDOW_NORMAL</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">cv2</span><span class="token punctuation">.</span><span class="">imshow</span><span class="token punctuation">(</span><span class="token string">&#x27;image&#x27;</span><span class="token punctuation">,</span><span class=""> res</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="">cv2</span><span class="token punctuation">.</span><span class="">waitKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div></div>
<p><img src="https://gist.github.com/assets/60120929/a8c791eb-cd5e-4aed-b4e6-0d6d3978fc29" alt="gacha"/></p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary">Code<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">lactf{zh0ng_l7_x_ch7ld3_b4t_w7th_x0r}</span></code></pre></div></div></main></div><!--$--><!--/$--></main><script src="/_next/static/chunks/webpack-d11e0b30904b49ad.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[87555,[],\"\"]\n3:I[31295,[],\"\"]\n4:I[6874,[\"874\",\"static/chunks/874-3e820bd666038662.js\",\"633\",\"static/chunks/app/writeups/%5Bid%5D/layout-2577bd3482649595.js\"],\"\"]\n6:I[59665,[],\"OutletBoundary\"]\n8:I[74911,[],\"AsyncMetadataOutlet\"]\na:I[59665,[],\"ViewportBoundary\"]\nc:I[59665,[],\"MetadataBoundary\"]\nd:\"$Sreact.suspense\"\nf:I[28393,[],\"\"]\n:HL[\"/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/5137b7a074c35308.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"nDyrqgKsYWBjc5CSiVf1q\",\"p\":\"\",\"c\":[\"\",\"writeups\",\"11bd9429d863a3f0e1e9f86579cfdc28\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"writeups\",{\"children\":[[\"id\",\"11bd9429d863a3f0e1e9f86579cfdc28\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/5137b7a074c35308.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"className\":\"dark scroll-smooth\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}]}],[\"$\",\"body\",null,{\"className\":\"text-dark dark:text-white dark:bg-midnight\",\"style\":{\"fontFamily\":\"'Inter', 'Inter Fallback'\",\"fontStyle\":\"normal\"},\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"h-screen flex items-center justify-center\",\"children\":[\"$\",\"main\",null,{\"className\":\"relative pl-14\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"absolute left-0 top-2 text-5xl text-grapefruit\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],[\"$\",\"h1\",null,{\"className\":\"font-bold text-7xl underline decoration-grapefruit mb-5\",\"children\":\"404.\"}],[\"$\",\"p\",null,{\"children\":\"Your requested page was not found.\"}],[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"font-medium text-inherit\",\"children\":\"Return to home →\"}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"writeups\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"main\",null,{\"className\":\"container pt-20 pb-24\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}],{\"children\":[[\"id\",\"11bd9429d863a3f0e1e9f86579cfdc28\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[[\"$\",\"$L4\",null,{\"href\":\"/writeups\",\"className\":\"text-secondary text-sm mb-10 -ml-5 block w-max\",\"children\":\"← Back to writeups\"}],[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$L7\",[\"$\",\"$L8\",null,{\"promise\":\"$@9\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$La\",null,{\"children\":\"$Lb\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$Lc\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$d\",null,{\"fallback\":null,\"children\":\"$Le\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n7:null\n"])</script><script>self.__next_f.push([1,"10:I[50674,[\"263\",\"static/chunks/bc9c3264-6371ca03223855d4.js\",\"810\",\"static/chunks/48507feb-8452885980bba250.js\",\"330\",\"static/chunks/08ffe114-f47006c90e36a3eb.js\",\"800\",\"static/chunks/800-bd0deb6e7b7e903a.js\",\"134\",\"static/chunks/app/writeups/%5Bid%5D/page-54fe20cc7a9d3224.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"children\":[\"$\",\"main\",null,{\"className\":\"text-pretty max-w-5xl mx-auto text-sm [\u0026_h1]:text-5xl [\u0026_h1]:font-semibold [\u0026_h1]:mb-8 [\u0026_blockquote]:text-secondary [\u0026_blockquote]:space-y-3 [\u0026_blockquote]:border-l-4 [\u0026_blockquote]:border-secondary [\u0026_blockquote]:pl-5 [\u0026_blockquote]:mb-5 [\u0026\u003e_p]:my-4 [\u0026_img]:my-5 [\u0026_ul]:list-disc [\u0026_ul]:pl-6 [\u0026_ol]:list-decimal [\u0026_ol]:pl-6 [\u0026_img]:rounded [\u0026_li]:my-2\",\"children\":[[\"$\",\"h1\",\"h1-0\",{\"children\":\"LA CTF 2024 — gacha\"}],\"\\n\",[\"$\",\"blockquote\",\"blockquote-0\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"All my friends have been getting into genshin and honkai recently and keep sending me pictures. However, they keep hiding their favorite characters, demanding for more money for their gacha pulls.\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":\"Can you free zhongli my waifu???\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"We're given three PNG files:\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":[[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/assets/60120929/8a7bcf44-918b-4380-b7e2-44a5ce655b41\",\"alt\":\"owo\"}],\"\\n\",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"owo.png\"}]]}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":[[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/assets/60120929/18a24f96-2c02-4724-8f82-83cbc7d6fca0\",\"alt\":\"uwu\"}],\"\\n\",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"uwu.png\"}]]}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":[[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/assets/60120929/b64bfd80-e89b-4b45-9a85-ee9b43ba78d0\",\"alt\":\"fiscl\"}],\"\\n\",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"fiscl.png\"}]]}],\"\\n\",[\"$\",\"p\",\"p-4\",{\"children\":[\"The last one seems unrelated, but the first two are reminiscent of \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://gist.github.com/ky28059/e7fed465703f2943e482cd2d6618ceb4\",\"children\":\"IslandParty\"}],\". Writing a script to diff them and view the channels,\"]}],\"\\n\",[\"$\",\"$L10\",\"pre-0\",{\"className\":\"my-2\",\"children\":\"import cv2\\n\\nowo = cv2.imread('owo.png')\\nuwu = cv2.imread('uwu.png')\\n\\nres = owo - uwu\\n\\ncv2.namedWindow('image', cv2.WINDOW_NORMAL)\\ncv2.imshow('image', res)\\ncv2.waitKey()\",\"language\":\"py\"}],\"\\n\",[\"$\",\"p\",\"p-5\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/assets/60120929/fbdb0a75-094d-4e7e-aa77-ca984f9b4b72\",\"alt\":\"gacha2\"}]}],\"\\n\",[\"$\",\"p\",\"p-6\",{\"children\":\"(see any letters in the middle row?)\"}],\"\\n\",[\"$\",\"p\",\"p-7\",{\"children\":\"Amplifying the contrast a bit, we can make out a few more letters and...\"}],\"\\n\",[\"$\",\"p\",\"p-8\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/assets/60120929/7b8dd2a2-0d32-4f4d-86a1-4bf6d90b0844\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-9\",{\"children\":[\"...is that a \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"x0r\"}],\" at the end of the flag?\"]}],\"\\n\",[\"$\",\"p\",\"p-10\",{\"children\":\"XOR'ing the images together, we get the flag:\"}],\"\\n\",[\"$\",\"$L10\",\"pre-1\",{\"className\":\"my-2\",\"children\":\"import cv2\\n\\nowo = cv2.imread('owo.png')\\nuwu = cv2.imread('uwu.png')\\n\\nres = owo ^ uwu\\n\\ncv2.namedWindow('image', cv2.WINDOW_NORMAL)\\ncv2.imshow('image', res)\\ncv2.waitKey()\",\"language\":\"py\"}],\"\\n\",[\"$\",\"p\",\"p-11\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/assets/60120929/a8c791eb-cd5e-4aed-b4e6-0d6d3978fc29\",\"alt\":\"gacha\"}]}],\"\\n\",[\"$\",\"$L10\",\"pre-2\",{\"className\":\"my-2\",\"children\":\"lactf{zh0ng_l7_x_ch7ld3_b4t_w7th_x0r}\",\"language\":\"$undefined\"}]]}]}]\n"])</script><script>self.__next_f.push([1,"9:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"LA CTF 2024 — gacha | kevin.fish\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"All my friends have been getting into genshin and honkai recently and keep sending me pictures. However, they keep hiding their favorite characters, demanding for more money for their gacha pulls.\"}],[\"$\",\"meta\",\"2\",{\"property\":\"og:title\",\"content\":\"LA CTF 2024 — gacha\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:description\",\"content\":\"All my friends have been getting into genshin and honkai recently and keep sending me pictures. However, they keep hiding their favorite characters, demanding for more money for their gacha pulls.\"}],[\"$\",\"meta\",\"4\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"5\",{\"name\":\"twitter:title\",\"content\":\"LA CTF 2024 — gacha\"}],[\"$\",\"meta\",\"6\",{\"name\":\"twitter:description\",\"content\":\"All my friends have been getting into genshin and honkai recently and keep sending me pictures. However, they keep hiding their favorite characters, demanding for more money for their gacha pulls.\"}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"e:\"$9:metadata\"\n"])</script></body></html>