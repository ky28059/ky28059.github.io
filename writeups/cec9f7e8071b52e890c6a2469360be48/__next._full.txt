1:"$Sreact.fragment"
2:I[39756,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/d037381d3416c607.js"],"default"]
3:I[37457,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/d037381d3416c607.js"],"default"]
4:I[22016,["/_next/static/chunks/44838f11011a9f2d.js"],""]
6:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/d037381d3416c607.js"],"OutletBoundary"]
7:"$Sreact.suspense"
9:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/d037381d3416c607.js"],"ViewportBoundary"]
b:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/d037381d3416c607.js"],"MetadataBoundary"]
d:I[68027,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/d037381d3416c607.js"],"default"]
:HL["/_next/static/chunks/0ae28dad4c293945.css","style"]
:HL["/_next/static/media/70bc3e132a0a741e-s.p.15008bfb.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/83afe278b6a6bb3c-s.p.3a6ba036.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
0:{"P":null,"b":"FqfWdJCztNJa3QVRETEoN","c":["","writeups","cec9f7e8071b52e890c6a2469360be48"],"q":"","i":false,"f":[[["",{"children":["writeups",{"children":[["id","cec9f7e8071b52e890c6a2469360be48","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],[["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/chunks/0ae28dad4c293945.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"className":"dark scroll-smooth jetbrains_mono_cc80ae23-module__2tkX8G__variable","children":[["$","head",null,{"children":["$","meta",null,{"charSet":"utf-8"}]}],["$","body",null,{"className":"text-dark dark:text-white dark:bg-midnight","style":{"fontFamily":"'Inter', 'Inter Fallback'","fontStyle":"normal"},"children":["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","div",null,{"className":"h-screen flex items-center justify-center","children":["$","main",null,{"className":"relative pl-14","children":[["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"absolute left-0 top-2 text-5xl text-grapefruit","children":["$undefined",[["$","path","0",{"d":"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z","children":[]}]]],"style":{"color":"$undefined"},"height":"1em","width":"1em","xmlns":"http://www.w3.org/2000/svg"}],["$","h1",null,{"className":"font-bold text-7xl underline decoration-grapefruit mb-5","children":"404."}],["$","p",null,{"children":"Your requested page was not found."}],["$","$L4",null,{"href":"/","className":"font-medium text-inherit","children":"Return to home →"}]]}]}],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]]}]]}],{"children":[["$","$1","c",{"children":[null,["$","main",null,{"className":"container pt-20 pb-24","children":["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]}]]}],{"children":[["$","$1","c",{"children":[[["$","script","script-0",{"src":"/_next/static/chunks/44838f11011a9f2d.js","async":true,"nonce":"$undefined"}]],[["$","$L4",null,{"href":"/writeups","className":"text-secondary text-sm mb-10 -ml-5 block w-max","children":"← Back to writeups"}],["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]]}],{"children":[["$","$1","c",{"children":["$L5",[["$","script","script-0",{"src":"/_next/static/chunks/03f4569ba78edab9.js","async":true,"nonce":"$undefined"}],["$","script","script-1",{"src":"/_next/static/chunks/44f6ea3170f4e31a.js","async":true,"nonce":"$undefined"}],["$","script","script-2",{"src":"/_next/static/chunks/39b99946d2be6a43.js","async":true,"nonce":"$undefined"}],["$","script","script-3",{"src":"/_next/static/chunks/116d3b69f07f8eb7.js","async":true,"nonce":"$undefined"}]],["$","$L6",null,{"children":["$","$7",null,{"name":"Next.MetadataOutlet","children":"$@8"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],["$","$1","h",{"children":[null,["$","$L9",null,{"children":"$@a"}],["$","div",null,{"hidden":true,"children":["$","$Lb",null,{"children":["$","$7",null,{"name":"Next.Metadata","children":"$@c"}]}]}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}],false]],"m":"$undefined","G":["$d",[]],"S":true}
a:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
e:I[10453,["/_next/static/chunks/44838f11011a9f2d.js","/_next/static/chunks/03f4569ba78edab9.js","/_next/static/chunks/44f6ea3170f4e31a.js","/_next/static/chunks/39b99946d2be6a43.js","/_next/static/chunks/116d3b69f07f8eb7.js"],"default"]
f:T459,    package com.tarek.myvault;

import android.os.Bundle;
import android.widget.Button;
import android.widget.EditText;
import d.m;
import i.c;
import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;

public class MainActivity extends m {
    public final void onCreate(Bundle bundle) {
        super.onCreate(bundle);
        setContentView((int) R.layout.activity_main);
        File file = new File(getCacheDir() + "/vault.enc");
        if (!file.exists()) {
            try {
                InputStream open = getAssets().open("vault.enc");
                byte[] bArr = new byte[open.available()];
                open.read(bArr);
                open.close();
                FileOutputStream fileOutputStream = new FileOutputStream(file);
                fileOutputStream.write(bArr);
                fileOutputStream.close();
                ((Button) findViewById(R.id.btnSubmit)).setOnClickListener(new c(this, (EditText) findViewById(R.id.editTextOTP), 2));
            } catch (Exception e3) {
                throw new RuntimeException(e3);
            }
        }
    }
}10:T435,kevin@ky28059:/mnt/c/users/kevin/Downloads$ xxd vault.enc
00000000: 3797 080e c05e 8e05 90f0 9c57 bf4e d622  7....^.....W.N."
00000010: 6c56 fd13 e3c9 52b3 21ec 1871 fb08 b3a2  lV....R.!..q....
00000020: 23de 50c3 a027 4a15 0fd9 2251 0703 c3e2  #.P..'J..."Q....
00000030: 37c6 7ce3 0414 2328 cb24 ca12 1520 6d1e  7.|...#(.$... m.
00000040: ba4d 692a b1e3 cacb 847b a957 df74 9896  .Mi*.....{.W.t..
00000050: 578c 67b8 b837 cf6c 4993 df21 3728 e001  W.g..7.lI..!7(..
00000060: e357 9a89 b1a5 2624 57e9 d093 0242 c0e9  .W....&$W....B..
00000070: dd42 4cb7 4c77 7c8f 1c93 17c4 184a 1cb9  .BL.Lw|......J..
00000080: cb02 d559 b5db d990 6c73 7ae0 7e50 3b6b  ...Y....lsz.~P;k
00000090: 7255 8c0b fe25 3c08 39e9 205a bb09 3531  rU...%<.9. Z..51
000000a0: 00cc 6330 d44e f54c 4d8d 44f7 18c7 cdad  ..c0.N.LM.D.....
000000b0: 370d 48ed 2635 7b00 e492 2354 474e e616  7.H.&5{...#TGN..
000000c0: 35dc 780c 9e21 f756 0bcb 451e 7b64 cbd4  5.x..!.V..E.{d..
000000d0: fe95 bab6 fda9 9c26 08b5 c17c dd85 c421  .......&...|...!
000000e0: 0eaa 5e78 7512 8829 2331 8fd0 2be6 7401  ..^xu..)#1..+.t.5:["$","div",null,{"children":["$","main",null,{"className":"text-pretty max-w-5xl mx-auto text-sm [&_h1]:text-5xl [&_h1]:font-semibold [&_h1]:mb-8 [&_blockquote]:text-secondary [&_blockquote]:space-y-3 [&_blockquote]:border-l-4 [&_blockquote]:border-secondary [&_blockquote]:pl-5 [&_blockquote]:mb-5 [&>_p]:my-4 [&_img]:my-5 [&_ul]:list-disc [&_ul]:pl-6 [&_ol]:list-decimal [&_ol]:pl-6 [&_img]:rounded [&_li]:my-2","children":[["$","h1","h1-0",{"children":"0xL4ugh CTF 2024 — MyVault"}],"\n",["$","blockquote","blockquote-0",{"children":["\n",["$","p","p-0",{"children":"Welcome to our secure vault !"}],"\n"]}],"\n",["$","p","p-0",{"children":"We're given an APK file that decompiles to, among other things,"}],"\n",["$","$Le","pre-0",{"className":"my-2","children":"$f","language":"java"}],"\n",["$","p","p-1",{"children":["The main activity reads bytes from the encoded ",["$","code","code-0",{"className":"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]","children":"vault.enc"}]," file, then sets up a click listener via ",["$","code","code-1",{"className":"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]","children":"new c()"}],"."]}],"\n",["$","$Le","pre-1",{"className":"my-2","children":"$10","language":"$undefined"}],"\n","$L11","\n","$L12","\n","$L13","\n","$L14","\n","$L15","\n","$L16","\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b"]}]}]
11:["$","p","p-2",{"children":["Looking in ",["$","code","code-0",{"className":"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]","children":"i.c"}],","]}]
1c:T7b5,    package i;

import android.view.KeyEvent;
import android.view.View;
import android.view.Window;
import android.widget.EditText;
import android.widget.Toast;
import com.tarek.myvault.MainActivity;
import h.a;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;

public final class c implements View.OnClickListener {

    // ...

    public final void onClick(View view) {
        // ...
        switch (i3) {
            // ...
            default:
                String obj3 = ((EditText) obj2).getText().toString();
                MainActivity mainActivity = (MainActivity) obj;
                mainActivity.getClass();
                try {
                    String sb = new StringBuilder(obj3).reverse().toString();
                    File file = new File(mainActivity.getCacheDir(), "vault.txt");
                    File file2 = new File(mainActivity.getCacheDir(), "vault.enc");
                    SecretKeySpec secretKeySpec = new SecretKeySpec((obj3 + sb + obj3 + sb).getBytes(), "AES");
                    Cipher instance = Cipher.getInstance("AES");
                    instance.init(2, secretKeySpec);
                    FileInputStream fileInputStream = new FileInputStream(file2);
                    byte[] bArr = new byte[((int) file2.length())];
                    fileInputStream.read(bArr);
                    byte[] doFinal = instance.doFinal(bArr);
                    FileOutputStream fileOutputStream = new FileOutputStream(file);
                    fileOutputStream.write(doFinal);
                    fileInputStream.close();
                    fileOutputStream.close();
                    str = "Congrats!";
                } catch (Exception unused) {
                    str = "Incorrect OTP";
                }
                Toast.makeText(mainActivity, str, 0).show();
                return;
        }
    }

    // ...
}12:["$","$Le","pre-2",{"className":"my-2","children":"$1c","language":"java"}]
13:["$","p","p-3",{"children":"On click, the handler pulls a string from a text input, creating an AES key equal to"}]
14:["$","$Le","pre-3",{"className":"my-2","children":"{string}{reversed string}{string}{reversed string}","language":"$undefined"}]
15:["$","p","p-4",{"children":["and uses it to attempt to decrypt the vault. On success, it writes the result to ",["$","code","code-0",{"className":"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]","children":"vault.txt"}],"."]}]
16:["$","$Le","pre-4",{"className":"my-2","children":"String obj3 = ((EditText) obj2).getText().toString();\nString sb = new StringBuilder(obj3).reverse().toString();\n\n// ...\n\nSecretKeySpec secretKeySpec = new SecretKeySpec((obj3 + sb + obj3 + sb).getBytes(), \"AES\");\nCipher instance = Cipher.getInstance(\"AES\");\ninstance.init(2, secretKeySpec);\n\n// ...\n\nbyte[] doFinal = instance.doFinal(bArr);","language":"java"}]
17:["$","p","p-5",{"children":"Because we know the key is the same string repeated (and reversed) 4 times, we only need to find the first fourth of the key to get the flag."}]
18:["$","p","p-6",{"children":["Unfortunately, there doesn't appear to be any other path forward than sheer brute force. AES accepts keys of ",["$","a","a-0",{"href":"https://docs.oracle.com/javase/8/docs/technotes/guides/security/StandardNames.html#Cipher","children":"128, 192, and 256 bits"}]," — 16, 24, and 32 bytes, or 4, 6, and 8 bytes for us to guess. Assuming the smallest key size, here's a Kotlin script that brute forces just that:"]}]
19:["$","$Le","pre-5",{"className":"my-2","children":"import java.io.File\nimport java.nio.ByteBuffer\nimport javax.crypto.Cipher\nimport javax.crypto.spec.SecretKeySpec\n\nfun main() {\n    val encBytes = File(\"./vault.enc\").readBytes()\n\n    for (i in 0u..UInt.MAX_VALUE) {\n        val bytes = i.toInt().toByteArray()\n\n        val key = bytes + bytes.reversed() + bytes + bytes.reversed()\n        if (i % 100000u == 0u) println(\"key (${key.size} bytes): ${key.toList()}\")\n\n        val spec = SecretKeySpec(key, \"AES\")\n        val cipher = Cipher.getInstance(\"AES\")\n        cipher.init(2, spec)\n\n        try {\n            val res = cipher.doFinal(encBytes).toString(Charsets.UTF_8)\n            if (res.contains(\"0xL4ugh\")) {\n                println(res)\n                break\n            }\n        } catch (e: Exception) {\n            // println(\"Decryption failed\")\n        }\n    }\n}\n\nfun Int.toByteArray(): ByteArray {\n    val buffer = ByteBuffer.allocate(Int.SIZE_BYTES)\n    buffer.putInt(this)\n    return buffer.array()\n}","language":"kt"}]
1a:["$","p","p-7",{"children":"After a few hours, we get the flag:"}]
1b:["$","$Le","pre-6",{"className":"my-2","children":"key (16 bytes): [55, 46, -106, 64, 64, -106, 46, 55, 55, 46, -106, 64, 64, -106, 46, 55]\nkey (16 bytes): [55, 48, 28, -32, -32, 28, 48, 55, 55, 48, 28, -32, -32, 28, 48, 55]\nkey (16 bytes): [55, 49, -93, -128, -128, -93, 49, 55, 55, 49, -93, -128, -128, -93, 49, 55]\nkey (16 bytes): [55, 51, 42, 32, 32, 42, 51, 55, 55, 51, 42, 32, 32, 42, 51, 55]\n{\n  \"vault\": [\n    {\n      \"id\": 0,\n      \"name\": \"Mohamed Tarek\",\n      \"content\": \"I hope You enjoyed with me!\"\n    },\n    {\n      \"id\": 1337,\n      \"name\": \"flag\",\n      \"content\": \"0xL4ugh{Y0u_Ar3_FoRceR_Like_A_H0uRc3}\"\n    }\n  ]\n}","language":"$undefined"}]
c:[["$","title","0",{"children":"0xL4ugh CTF 2024 — MyVault | kevin.fish"}],["$","meta","1",{"name":"description","content":"Welcome to our secure vault !"}],["$","meta","2",{"property":"og:title","content":"0xL4ugh CTF 2024 — MyVault"}],["$","meta","3",{"property":"og:description","content":"Welcome to our secure vault !"}],["$","meta","4",{"name":"twitter:card","content":"summary"}],["$","meta","5",{"name":"twitter:title","content":"0xL4ugh CTF 2024 — MyVault"}],["$","meta","6",{"name":"twitter:description","content":"Welcome to our secure vault !"}]]
8:null
