<!DOCTYPE html><html class="dark scroll-smooth"><head><meta charSet="utf-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/c66ca812-f460-43d5-b7c1-238e0ef25457"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/bd8a7188-6944-4b3f-893f-6492b8b1600a"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/ba966615-b9e0-409e-b51a-3212475f77fa"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/498744ae-2741-481a-93d7-ba5a786e61be"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/71aff1bd-07cd-4283-ab93-9b7ebff7f426"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/ed9ab6a2-45fa-466c-93e7-623bf9cd6ae8"/><link rel="stylesheet" href="/_next/static/css/b41869de3b22c447.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-50d183473e3f8178.js"/><script src="/_next/static/chunks/4bd1b696-12b3d90ac4ed3802.js" async=""></script><script src="/_next/static/chunks/684-d3c2077e7b7fefb9.js" async=""></script><script src="/_next/static/chunks/main-app-99381da9a4c58049.js" async=""></script><script src="/_next/static/chunks/874-c62c375efd21db20.js" async=""></script><script src="/_next/static/chunks/app/writeups/layout-0d6432ad4376bd82.js" async=""></script><script src="/_next/static/chunks/325-8cc74193b249521f.js" async=""></script><script src="/_next/static/chunks/app/writeups/%5Bid%5D/page-d2275216898ea7fa.js" async=""></script><meta name="next-size-adjust" content=""/><title>kevin.fish</title><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="text-dark dark:text-white dark:bg-midnight" style="font-family:&#x27;Inter&#x27;, &#x27;Inter Fallback&#x27;;font-style:normal"><main class="container pt-20 pb-24"><a class="text-secondary text-sm mb-10 -ml-5 block w-max" href="/">← Back to home</a><div><main class="max-w-5xl mx-auto text-sm [&amp;_h1]:text-5xl [&amp;_h1]:font-semibold [&amp;_h1]:mb-8 [&amp;_blockquote]:text-secondary [&amp;_blockquote]:space-y-3 [&amp;_blockquote]:border-l-4 [&amp;_blockquote]:border-secondary [&amp;_blockquote]:pl-5 [&amp;_blockquote]:mb-5 [&amp;&gt;_p]:my-3 [&amp;_img]:my-5 [&amp;_ul]:list-disc [&amp;_ul]:pl-6 [&amp;_img]:rounded [&amp;_li]:my-2"><h1>1337UP LIVE CTF 2024 — Pizza Paradise</h1>
<blockquote>
<p>Something weird going on at this pizza store!!</p>
<p>https://pizzaparadise.ctf.intigriti.io</p>
</blockquote>
<p>We&#x27;re given a simple pizza chain website looking like this:</p>
<p><img src="https://gist.github.com/user-attachments/assets/c66ca812-f460-43d5-b7c1-238e0ef25457" alt="image"/></p>
<p>Looking at the source code, CSS, and images, nothing seems out of the ordinary. However, going to <code class="text-primary bg-black/20 rounded p-1">robots.txt</code>,</p>
<p><img src="https://gist.github.com/user-attachments/assets/bd8a7188-6944-4b3f-893f-6492b8b1600a" alt="image"/></p>
<p>Going to that suspicious route, we find a &quot;top secret&quot; login page looking like this:</p>
<p><img src="https://gist.github.com/user-attachments/assets/ba966615-b9e0-409e-b51a-3212475f77fa" alt="image"/></p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (html)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token doctype punctuation">&lt;!</span><span class="token doctype doctype-tag">DOCTYPE</span><span class="token doctype"> </span><span class="token doctype name">html</span><span class="token doctype punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token tag punctuation">&lt;</span><span class="token tag">html</span><span class="token tag"> </span><span class="token tag attr-name">lang</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">en</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">    </span><span class="token tag punctuation">&lt;</span><span class="token tag">head</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="">        </span><span class="token tag punctuation">&lt;</span><span class="token tag">meta</span><span class="token tag"> </span><span class="token tag attr-name">charset</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">UTF-8</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">        </span><span class="token tag punctuation">&lt;</span><span class="token tag">title</span><span class="token tag punctuation">&gt;</span><span class="">Top Secret Government Access</span><span class="token tag punctuation">&lt;/</span><span class="token tag">title</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class="">        </span><span class="token tag punctuation">&lt;</span><span class="token tag">link</span><span class="token tag">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="token tag">            </span><span class="token tag attr-name">href</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">https://fonts.googleapis.com/css2?family=Orbitron&amp;display=swap</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="token tag">            </span><span class="token tag attr-name">rel</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">stylesheet</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="token tag">        </span><span class="token tag punctuation">/&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="">        </span><span class="token tag punctuation">&lt;</span><span class="token tag">link</span><span class="token tag"> </span><span class="token tag attr-name">rel</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">stylesheet</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">href</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">/assets/css/secret-theme.css</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class="">        </span><span class="token tag punctuation">&lt;</span><span class="token tag">script</span><span class="token tag"> </span><span class="token tag attr-name">src</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">/assets/js/auth.js</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="token tag punctuation">&lt;/</span><span class="token tag">script</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class="">        </span><span class="token tag punctuation">&lt;</span><span class="token tag">script</span><span class="token tag"> </span><span class="token tag attr-name">src</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="token tag punctuation">&lt;/</span><span class="token tag">script</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class="">        </span><span class="token tag punctuation">&lt;</span><span class="token tag">script</span><span class="token tag punctuation">&gt;</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class="token script language-javascript">            </span><span class="token script language-javascript keyword">function</span><span class="token script language-javascript"> </span><span class="token script language-javascript function">hashPassword</span><span class="token script language-javascript punctuation">(</span><span class="token script language-javascript parameter">password</span><span class="token script language-javascript punctuation">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation">{</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class="token script language-javascript">                </span><span class="token script language-javascript keyword control-flow">return</span><span class="token script language-javascript"> </span><span class="token script language-javascript maybe-class-name">CryptoJS</span><span class="token script language-javascript punctuation">.</span><span class="token script language-javascript constant">SHA256</span><span class="token script language-javascript punctuation">(</span><span class="token script language-javascript">password</span><span class="token script language-javascript punctuation">)</span><span class="token script language-javascript punctuation">.</span><span class="token script language-javascript method function property-access">toString</span><span class="token script language-javascript punctuation">(</span><span class="token script language-javascript punctuation">)</span><span class="token script language-javascript punctuation">;</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">16</span><span class="token script language-javascript">            </span><span class="token script language-javascript punctuation">}</span><span class="token script language-javascript">
</span><span class="token script language-javascript"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">17</span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">18</span><span class="token script language-javascript">            </span><span class="token script language-javascript keyword">function</span><span class="token script language-javascript"> </span><span class="token script language-javascript function">validate</span><span class="token script language-javascript punctuation">(</span><span class="token script language-javascript punctuation">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation">{</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">19</span><span class="token script language-javascript">                </span><span class="token script language-javascript keyword">const</span><span class="token script language-javascript"> username </span><span class="token script language-javascript operator">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript dom variable">document</span><span class="token script language-javascript punctuation">.</span><span class="token script language-javascript method function property-access">getElementById</span><span class="token script language-javascript punctuation">(</span><span class="token script language-javascript string">&quot;username&quot;</span><span class="token script language-javascript punctuation">)</span><span class="token script language-javascript punctuation">.</span><span class="token script language-javascript property-access">value</span><span class="token script language-javascript punctuation">;</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">20</span><span class="token script language-javascript">                </span><span class="token script language-javascript keyword">const</span><span class="token script language-javascript"> password </span><span class="token script language-javascript operator">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript dom variable">document</span><span class="token script language-javascript punctuation">.</span><span class="token script language-javascript method function property-access">getElementById</span><span class="token script language-javascript punctuation">(</span><span class="token script language-javascript string">&quot;password&quot;</span><span class="token script language-javascript punctuation">)</span><span class="token script language-javascript punctuation">.</span><span class="token script language-javascript property-access">value</span><span class="token script language-javascript punctuation">;</span><span class="token script language-javascript">
</span><span class="token script language-javascript"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">21</span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">22</span><span class="token script language-javascript">                </span><span class="token script language-javascript keyword">const</span><span class="token script language-javascript"> credentials </span><span class="token script language-javascript operator">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript function">getCredentials</span><span class="token script language-javascript punctuation">(</span><span class="token script language-javascript punctuation">)</span><span class="token script language-javascript punctuation">;</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">23</span><span class="token script language-javascript">                </span><span class="token script language-javascript keyword">const</span><span class="token script language-javascript"> passwordHash </span><span class="token script language-javascript operator">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript function">hashPassword</span><span class="token script language-javascript punctuation">(</span><span class="token script language-javascript">password</span><span class="token script language-javascript punctuation">)</span><span class="token script language-javascript punctuation">;</span><span class="token script language-javascript">
</span><span class="token script language-javascript"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">24</span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">25</span><span class="token script language-javascript">                </span><span class="token script language-javascript keyword control-flow">if</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation">(</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">26</span><span class="token script language-javascript">                    username </span><span class="token script language-javascript operator">===</span><span class="token script language-javascript"> credentials</span><span class="token script language-javascript punctuation">.</span><span class="token script language-javascript property-access">username</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator">&amp;&amp;</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">27</span><span class="token script language-javascript">                    passwordHash </span><span class="token script language-javascript operator">===</span><span class="token script language-javascript"> credentials</span><span class="token script language-javascript punctuation">.</span><span class="token script language-javascript property-access">passwordHash</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">28</span><span class="token script language-javascript">                </span><span class="token script language-javascript punctuation">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation">{</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">29</span><span class="token script language-javascript">                    </span><span class="token script language-javascript keyword control-flow">return</span><span class="token script language-javascript"> </span><span class="token script language-javascript boolean">true</span><span class="token script language-javascript punctuation">;</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">30</span><span class="token script language-javascript">                </span><span class="token script language-javascript punctuation">}</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword control-flow">else</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation">{</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">31</span><span class="token script language-javascript">                    </span><span class="token script language-javascript function">alert</span><span class="token script language-javascript punctuation">(</span><span class="token script language-javascript string">&quot;Invalid credentials!&quot;</span><span class="token script language-javascript punctuation">)</span><span class="token script language-javascript punctuation">;</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">32</span><span class="token script language-javascript">                    </span><span class="token script language-javascript keyword control-flow">return</span><span class="token script language-javascript"> </span><span class="token script language-javascript boolean">false</span><span class="token script language-javascript punctuation">;</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">33</span><span class="token script language-javascript">                </span><span class="token script language-javascript punctuation">}</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">34</span><span class="token script language-javascript">            </span><span class="token script language-javascript punctuation">}</span><span class="token script language-javascript">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">35</span><span class="token script language-javascript">        </span><span class="token tag punctuation">&lt;/</span><span class="token tag">script</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">36</span><span class="">    </span><span class="token tag punctuation">&lt;/</span><span class="token tag">head</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">37</span><span class="">    </span><span class="token tag punctuation">&lt;</span><span class="token tag">body</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">38</span><span class="">        </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag"> </span><span class="token tag attr-name">class</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">container</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">39</span><span class="">            </span><span class="token tag punctuation">&lt;</span><span class="token tag">h1</span><span class="token tag punctuation">&gt;</span><span class="">Top Secret Government Access</span><span class="token tag punctuation">&lt;/</span><span class="token tag">h1</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">40</span><span class="">            </span><span class="token tag punctuation">&lt;</span><span class="token tag">form</span><span class="token tag"> </span><span class="token tag attr-name">id</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">loginForm</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">action</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">login.php</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">method</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">POST</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag special-attr attr-name">onsubmit</span><span class="token tag special-attr attr-value punctuation attr-equals">=</span><span class="token tag special-attr attr-value punctuation">&quot;</span><span class="token tag special-attr attr-value value javascript language-javascript keyword control-flow">return</span><span class="token tag special-attr attr-value value javascript language-javascript"> </span><span class="token tag special-attr attr-value value javascript language-javascript function">validate</span><span class="token tag special-attr attr-value value javascript language-javascript punctuation">(</span><span class="token tag special-attr attr-value value javascript language-javascript punctuation">)</span><span class="token tag special-attr attr-value value javascript language-javascript punctuation">;</span><span class="token tag special-attr attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">41</span><span class="">                </span><span class="token tag punctuation">&lt;</span><span class="token tag">label</span><span class="token tag"> </span><span class="token tag attr-name">for</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">username</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">Username:</span><span class="token tag punctuation">&lt;/</span><span class="token tag">label</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">42</span><span class="">                </span><span class="token tag punctuation">&lt;</span><span class="token tag">input</span><span class="token tag"> </span><span class="token tag attr-name">type</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">text</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">id</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">username</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">name</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">username</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">required</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token tag punctuation">&lt;</span><span class="token tag">br</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">43</span><span class="">                </span><span class="token tag punctuation">&lt;</span><span class="token tag">label</span><span class="token tag"> </span><span class="token tag attr-name">for</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">password</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">Password:</span><span class="token tag punctuation">&lt;/</span><span class="token tag">label</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">44</span><span class="">                </span><span class="token tag punctuation">&lt;</span><span class="token tag">input</span><span class="token tag"> </span><span class="token tag attr-name">type</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">password</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">id</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">password</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">name</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">password</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">required</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token tag punctuation">&lt;</span><span class="token tag">br</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">45</span><span class="">                </span><span class="token tag punctuation">&lt;</span><span class="token tag">input</span><span class="token tag"> </span><span class="token tag attr-name">type</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">submit</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">value</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">Login</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">46</span><span class="">            </span><span class="token tag punctuation">&lt;/</span><span class="token tag">form</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">47</span><span class="">        </span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">48</span><span class="">    </span><span class="token tag punctuation">&lt;/</span><span class="token tag">body</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">49</span><span class=""></span><span class="token tag punctuation">&lt;/</span><span class="token tag">html</span><span class="token tag punctuation">&gt;</span></code></pre></div></div>
<p>Trying some simple SQL injection payloads, nothing happens. But looking at the <code class="text-primary bg-black/20 rounded p-1">validate()</code> code, because validation is done on the client side, we can find the credentials we need to match in <code class="text-primary bg-black/20 rounded p-1">auth.js</code>:</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">const</span><span class=""> validUsername </span><span class="token operator">=</span><span class=""> </span><span class="token string">&quot;agent_1337&quot;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token keyword">const</span><span class=""> validPasswordHash </span><span class="token operator">=</span><span class=""> </span><span class="token string">&quot;91a915b6bdcfb47045859288a9e2bd651af246f07a083f11958550056bed8eac&quot;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token keyword">function</span><span class=""> </span><span class="token function">getCredentials</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">    </span><span class="token keyword control-flow">return</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class="">        </span><span class="token literal-property property">username</span><span class="token operator">:</span><span class=""> validUsername</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">        </span><span class="token literal-property property">passwordHash</span><span class="token operator">:</span><span class=""> validPasswordHash</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="">    </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class=""></span><span class="token punctuation">}</span></code></pre></div></div>
<p>But what&#x27;s the unhashed version of the password? We can try some sketchy online hash-cracker lookup websites, and to my surprise,</p>
<p><img src="https://gist.github.com/user-attachments/assets/498744ae-2741-481a-93d7-ba5a786e61be" alt="image"/></p>
<p>Then, we have our final credentials:</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">username: agent_1337
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>password: intel420</code></pre></div></div>
<p>Logging in, we get to the &quot;top secret government portal&quot;:</p>
<p><img src="https://gist.github.com/user-attachments/assets/71aff1bd-07cd-4283-ab93-9b7ebff7f426" alt="image"/></p>
<p>We can download four AI-generated images, but nothing seems off about them either. The realization here is that this page reveals a special route for downloading files:</p>
<p><img src="https://gist.github.com/user-attachments/assets/ed9ab6a2-45fa-466c-93e7-623bf9cd6ae8" alt="image"/></p>
<p>We can try to download other <code class="text-primary bg-black/20 rounded p-1">topsecretx.png</code> images, but none exist. We can also notice that any path not beginning with <code class="text-primary bg-black/20 rounded p-1">/assets/images/</code> fails with &quot;path not allowed&quot;. Instead, we can finally apply path traversal to download the PHP handler for the admin portal endpoint,</p>
<p>https://pizzaparadise.ctf.intigriti.io/topsecret_a9aedc6c39f654e55275ad8e65e316b3.php?download=/assets/images/../../topsecret_a9aedc6c39f654e55275ad8e65e316b3.php</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (php)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token php language-php delimiter important">&lt;?php</span><span class="token php language-php">
</span><span class="token php language-php"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="token php language-php"></span><span class="token php language-php variable">$flag</span><span class="token php language-php"> </span><span class="token php language-php operator">=</span><span class="token php language-php"> </span><span class="token php language-php string single-quoted-string">&#x27;INTIGRITI{70p_53cr37_m15510n_c0mpl373}&#x27;</span><span class="token php language-php punctuation">;</span><span class="token php language-php">
</span><span class="token php language-php"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="token php language-php"></span><span class="token php language-php keyword">if</span><span class="token php language-php"> </span><span class="token php language-php punctuation">(</span><span class="token php language-php keyword">isset</span><span class="token php language-php punctuation">(</span><span class="token php language-php global">$_GET</span><span class="token php language-php punctuation">[</span><span class="token php language-php string single-quoted-string">&#x27;download&#x27;</span><span class="token php language-php punctuation">]</span><span class="token php language-php punctuation">)</span><span class="token php language-php punctuation">)</span><span class="token php language-php"> </span><span class="token php language-php punctuation">{</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class="token php language-php">    </span><span class="token php language-php variable">$file</span><span class="token php language-php"> </span><span class="token php language-php operator">=</span><span class="token php language-php"> </span><span class="token php language-php global">$_GET</span><span class="token php language-php punctuation">[</span><span class="token php language-php string single-quoted-string">&#x27;download&#x27;</span><span class="token php language-php punctuation">]</span><span class="token php language-php punctuation">;</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="token php language-php">    </span><span class="token php language-php keyword">if</span><span class="token php language-php"> </span><span class="token php language-php punctuation">(</span><span class="token php language-php function">strpos</span><span class="token php language-php punctuation">(</span><span class="token php language-php variable">$file</span><span class="token php language-php punctuation">,</span><span class="token php language-php"> </span><span class="token php language-php string single-quoted-string">&#x27;/assets/images/&#x27;</span><span class="token php language-php punctuation">)</span><span class="token php language-php"> </span><span class="token php language-php operator">===</span><span class="token php language-php"> </span><span class="token php language-php number">0</span><span class="token php language-php punctuation">)</span><span class="token php language-php"> </span><span class="token php language-php punctuation">{</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="token php language-php">        </span><span class="token php language-php variable">$filePath</span><span class="token php language-php"> </span><span class="token php language-php operator">=</span><span class="token php language-php"> </span><span class="token php language-php constant">__DIR__</span><span class="token php language-php"> </span><span class="token php language-php operator">.</span><span class="token php language-php"> </span><span class="token php language-php string single-quoted-string">&#x27;/&#x27;</span><span class="token php language-php"> </span><span class="token php language-php operator">.</span><span class="token php language-php"> </span><span class="token php language-php variable">$file</span><span class="token php language-php punctuation">;</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="token php language-php">        </span><span class="token php language-php keyword">if</span><span class="token php language-php"> </span><span class="token php language-php punctuation">(</span><span class="token php language-php function">file_exists</span><span class="token php language-php punctuation">(</span><span class="token php language-php variable">$filePath</span><span class="token php language-php punctuation">)</span><span class="token php language-php punctuation">)</span><span class="token php language-php"> </span><span class="token php language-php punctuation">{</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="token php language-php">            </span><span class="token php language-php function">header</span><span class="token php language-php punctuation">(</span><span class="token php language-php string single-quoted-string">&#x27;Content-Type: application/octet-stream&#x27;</span><span class="token php language-php punctuation">)</span><span class="token php language-php punctuation">;</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class="token php language-php">            </span><span class="token php language-php function">header</span><span class="token php language-php punctuation">(</span><span class="token php language-php string single-quoted-string">&#x27;Content-Disposition: attachment; filename=&quot;&#x27;</span><span class="token php language-php"> </span><span class="token php language-php operator">.</span><span class="token php language-php"> </span><span class="token php language-php function">basename</span><span class="token php language-php punctuation">(</span><span class="token php language-php variable">$filePath</span><span class="token php language-php punctuation">)</span><span class="token php language-php"> </span><span class="token php language-php operator">.</span><span class="token php language-php"> </span><span class="token php language-php string single-quoted-string">&#x27;&quot;&#x27;</span><span class="token php language-php punctuation">)</span><span class="token php language-php punctuation">;</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class="token php language-php">            </span><span class="token php language-php function">header</span><span class="token php language-php punctuation">(</span><span class="token php language-php string single-quoted-string">&#x27;Content-Length: &#x27;</span><span class="token php language-php"> </span><span class="token php language-php operator">.</span><span class="token php language-php"> </span><span class="token php language-php function">filesize</span><span class="token php language-php punctuation">(</span><span class="token php language-php variable">$filePath</span><span class="token php language-php punctuation">)</span><span class="token php language-php punctuation">)</span><span class="token php language-php punctuation">;</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class="token php language-php">            </span><span class="token php language-php function">readfile</span><span class="token php language-php punctuation">(</span><span class="token php language-php variable">$filePath</span><span class="token php language-php punctuation">)</span><span class="token php language-php punctuation">;</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class="token php language-php">            </span><span class="token php language-php keyword">exit</span><span class="token php language-php punctuation">(</span><span class="token php language-php punctuation">)</span><span class="token php language-php punctuation">;</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class="token php language-php">        </span><span class="token php language-php punctuation">}</span><span class="token php language-php"> </span><span class="token php language-php keyword">else</span><span class="token php language-php"> </span><span class="token php language-php punctuation">{</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">16</span><span class="token php language-php">            </span><span class="token php language-php keyword">die</span><span class="token php language-php punctuation">(</span><span class="token php language-php string single-quoted-string">&#x27;File not found!&#x27;</span><span class="token php language-php punctuation">)</span><span class="token php language-php punctuation">;</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">17</span><span class="token php language-php">        </span><span class="token php language-php punctuation">}</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">18</span><span class="token php language-php">    </span><span class="token php language-php punctuation">}</span><span class="token php language-php"> </span><span class="token php language-php keyword">else</span><span class="token php language-php"> </span><span class="token php language-php punctuation">{</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">19</span><span class="token php language-php">        </span><span class="token php language-php keyword">die</span><span class="token php language-php punctuation">(</span><span class="token php language-php string single-quoted-string">&#x27;File path not allowed!&#x27;</span><span class="token php language-php punctuation">)</span><span class="token php language-php punctuation">;</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">20</span><span class="token php language-php">    </span><span class="token php language-php punctuation">}</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">21</span><span class="token php language-php"></span><span class="token php language-php punctuation">}</span><span class="token php language-php">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">22</span><span class="token php language-php"></span><span class="token php language-php delimiter important">?&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">23</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">24</span><span class=""></span><span class="token doctype punctuation">&lt;!</span><span class="token doctype doctype-tag">DOCTYPE</span><span class="token doctype"> </span><span class="token doctype name">html</span><span class="token doctype punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">25</span><span class=""></span><span class="token tag punctuation">&lt;</span><span class="token tag">html</span><span class="token tag"> </span><span class="token tag attr-name">lang</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">en</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">26</span><span class=""></span><span class="token tag punctuation">&lt;</span><span class="token tag">head</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">27</span><span class="">    </span><span class="token tag punctuation">&lt;</span><span class="token tag">meta</span><span class="token tag"> </span><span class="token tag attr-name">charset</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">UTF-8</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">28</span><span class="">    </span><span class="token tag punctuation">&lt;</span><span class="token tag">title</span><span class="token tag punctuation">&gt;</span><span class="">Top Secret Portal</span><span class="token tag punctuation">&lt;/</span><span class="token tag">title</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">29</span><span class="">    </span><span class="token tag punctuation">&lt;</span><span class="token tag">link</span><span class="token tag"> </span><span class="token tag attr-name">href</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">https://fonts.googleapis.com/css2?family=Orbitron&amp;display=swap</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">rel</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">stylesheet</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">30</span><span class="">    </span><span class="token tag punctuation">&lt;</span><span class="token tag">link</span><span class="token tag"> </span><span class="token tag attr-name">rel</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">stylesheet</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">href</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">/assets/css/secret-theme.css</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">31</span><span class="">    </span><span class="token tag punctuation">&lt;</span><span class="token tag">script</span><span class="token tag"> </span><span class="token tag attr-name">src</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">/assets/js/displayImage.js</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="token tag punctuation">&lt;/</span><span class="token tag">script</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">32</span><span class=""></span><span class="token tag punctuation">&lt;/</span><span class="token tag">head</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">33</span><span class=""></span><span class="token tag punctuation">&lt;</span><span class="token tag">body</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">34</span><span class="">    </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag"> </span><span class="token tag attr-name">class</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">container</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">35</span><span class="">        </span><span class="token tag punctuation">&lt;</span><span class="token tag">h1</span><span class="token tag punctuation">&gt;</span><span class="">Welcome to the Top Secret Government Portal</span><span class="token tag punctuation">&lt;/</span><span class="token tag">h1</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">36</span><span class="">        </span><span class="token tag punctuation">&lt;</span><span class="token tag">p</span><span class="token tag punctuation">&gt;</span><span class="">Authorized personnel only.</span><span class="token tag punctuation">&lt;/</span><span class="token tag">p</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">37</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">38</span><span class="">        </span><span class="token tag punctuation">&lt;</span><span class="token tag">img</span><span class="token tag"> </span><span class="token tag attr-name">id</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">selectedImage</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">src</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">/assets/images/topsecret1.png</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">alt</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">Selected Image</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">39</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">40</span><span class="">        </span><span class="token tag punctuation">&lt;</span><span class="token tag">form</span><span class="token tag"> </span><span class="token tag attr-name">method</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">GET</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">action</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">41</span><span class="">            </span><span class="token tag punctuation">&lt;</span><span class="token tag">label</span><span class="token tag"> </span><span class="token tag attr-name">for</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">image</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">Select Image to Download:</span><span class="token tag punctuation">&lt;/</span><span class="token tag">label</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">42</span><span class="">            </span><span class="token tag punctuation">&lt;</span><span class="token tag">select</span><span class="token tag"> </span><span class="token tag attr-name">name</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">download</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">id</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">image</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag special-attr attr-name">onchange</span><span class="token tag special-attr attr-value punctuation attr-equals">=</span><span class="token tag special-attr attr-value punctuation">&quot;</span><span class="token tag special-attr attr-value value javascript language-javascript function">updateImage</span><span class="token tag special-attr attr-value value javascript language-javascript punctuation">(</span><span class="token tag special-attr attr-value value javascript language-javascript punctuation">)</span><span class="token tag special-attr attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">43</span><span class="">                </span><span class="token tag punctuation">&lt;</span><span class="token tag">option</span><span class="token tag"> </span><span class="token tag attr-name">value</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">/assets/images/topsecret1.png</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">Image 1</span><span class="token tag punctuation">&lt;/</span><span class="token tag">option</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">44</span><span class="">                </span><span class="token tag punctuation">&lt;</span><span class="token tag">option</span><span class="token tag"> </span><span class="token tag attr-name">value</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">/assets/images/topsecret2.png</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">Image 2</span><span class="token tag punctuation">&lt;/</span><span class="token tag">option</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">45</span><span class="">                </span><span class="token tag punctuation">&lt;</span><span class="token tag">option</span><span class="token tag"> </span><span class="token tag attr-name">value</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">/assets/images/topsecret3.png</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">Image 3</span><span class="token tag punctuation">&lt;/</span><span class="token tag">option</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">46</span><span class="">                </span><span class="token tag punctuation">&lt;</span><span class="token tag">option</span><span class="token tag"> </span><span class="token tag attr-name">value</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">/assets/images/topsecret4.png</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">Image 4</span><span class="token tag punctuation">&lt;/</span><span class="token tag">option</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">47</span><span class="">            </span><span class="token tag punctuation">&lt;/</span><span class="token tag">select</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">48</span><span class="">            </span><span class="token tag punctuation">&lt;</span><span class="token tag">button</span><span class="token tag"> </span><span class="token tag attr-name">type</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">submit</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="">Download</span><span class="token tag punctuation">&lt;/</span><span class="token tag">button</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">49</span><span class="">        </span><span class="token tag punctuation">&lt;/</span><span class="token tag">form</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">50</span><span class="">    </span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">51</span><span class=""></span><span class="token tag punctuation">&lt;/</span><span class="token tag">body</span><span class="token tag punctuation">&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">52</span><span class=""></span><span class="token tag punctuation">&lt;/</span><span class="token tag">html</span><span class="token tag punctuation">&gt;</span></code></pre></div></div>
<p>getting us the flag.</p></main></div><!--$--><!--/$--><!--$--><!--/$--></main><script src="/_next/static/chunks/webpack-50d183473e3f8178.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[87555,[],\"\"]\n3:I[31295,[],\"\"]\n4:I[6874,[\"874\",\"static/chunks/874-c62c375efd21db20.js\",\"319\",\"static/chunks/app/writeups/layout-0d6432ad4376bd82.js\"],\"\"]\n6:I[59665,[],\"MetadataBoundary\"]\n8:I[59665,[],\"OutletBoundary\"]\nb:I[74911,[],\"AsyncMetadataOutlet\"]\nd:I[59665,[],\"ViewportBoundary\"]\nf:I[26614,[],\"\"]\n:HL[\"/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/b41869de3b22c447.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"NtM4hj5y3IN8pkVEe4T_n\",\"p\":\"\",\"c\":[\"\",\"writeups\",\"91df12b57366ef5ab356fb09239eb4d8\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"writeups\",{\"children\":[[\"id\",\"91df12b57366ef5ab356fb09239eb4d8\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b41869de3b22c447.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"className\":\"dark scroll-smooth\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}]}],[\"$\",\"body\",null,{\"className\":\"text-dark dark:text-white dark:bg-midnight\",\"style\":{\"fontFamily\":\"'Inter', 'Inter Fallback'\",\"fontStyle\":\"normal\"},\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"h-screen flex items-center justify-center\",\"children\":[\"$\",\"main\",null,{\"className\":\"relative pl-14\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"absolute left-0 top-2 text-5xl text-grapefruit\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],[\"$\",\"h1\",null,{\"className\":\"font-bold text-7xl underline decoration-grapefruit mb-5\",\"children\":\"404.\"}],[\"$\",\"p\",null,{\"children\":\"Your requested page was not found.\"}],[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"font-medium text-inherit\",\"children\":\"Return to home →\"}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"writeups\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"main\",null,{\"className\":\"container pt-20 pb-24\",\"children\":[[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"text-secondary text-sm mb-10 -ml-5 block w-max\",\"children\":\"← Back to home\"}],[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]]}],{\"children\":[[\"id\",\"91df12b57366ef5ab356fb09239eb4d8\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[\"$\",\"$L6\",null,{\"children\":\"$L7\"}],null,[\"$\",\"$L8\",null,{\"children\":[\"$L9\",\"$La\",[\"$\",\"$Lb\",null,{\"promise\":\"$@c\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"T_2v5acPAexc8QsZw9mJD\",{\"children\":[[\"$\",\"$Ld\",null,{\"children\":\"$Le\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"10:\"$Sreact.suspense\"\n11:I[74911,[],\"AsyncMetadata\"]\n7:[\"$\",\"$10\",null,{\"fallback\":null,\"children\":[\"$\",\"$L11\",null,{\"promise\":\"$@12\"}]}]\n"])</script><script>self.__next_f.push([1,"a:null\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n9:null\n"])</script><script>self.__next_f.push([1,"12:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"kevin.fish\"}]],\"error\":null,\"digest\":\"$undefined\"}\nc:{\"metadata\":\"$12:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"13:I[50674,[\"325\",\"static/chunks/325-8cc74193b249521f.js\",\"134\",\"static/chunks/app/writeups/%5Bid%5D/page-d2275216898ea7fa.js\"],\"default\"]\n14:T755,\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n    \u003chead\u003e\n        \u003cmeta charset=\"UTF-8\" /\u003e\n        \u003ctitle\u003eTop Secret Government Access\u003c/title\u003e\n        \u003clink\n            href=\"https://fonts.googleapis.com/css2?family=Orbitron\u0026display=swap\"\n            rel=\"stylesheet\"\n        /\u003e\n        \u003clink rel=\"stylesheet\" href=\"/assets/css/secret-theme.css\" /\u003e\n        \u003cscript src=\"/assets/js/auth.js\"\u003e\u003c/script\u003e\n        \u003cscript src=\"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js\"\u003e\u003c/script\u003e\n        \u003cscript\u003e\n            function hashPassword(password) {\n                return CryptoJS.SHA256(password).toString();\n            }\n\n            function validate() {\n                const username = document.getElementById(\"username\").value;\n                const password = document.getElementById(\"password\").value;\n\n                const credentials = getCredentials();\n                const passwordHash = hashPassword(password);\n\n                if (\n                    username === credentials.username \u0026\u0026\n                    passwordHash === credentials.passwordHash\n                ) {\n                    return true;\n                } else {\n                    alert(\"Invalid credentials!\");\n                    return false;\n                }\n            }\n        \u003c/script\u003e\n    \u003c/head\u003e\n    \u003cbody\u003e\n        \u003cdiv class=\"container\"\u003e\n            \u003ch1\u003eTop Secret Government Access\u003c/h1\u003e\n            \u003cform id=\"loginForm\" action=\"login.php\" method=\"POST\" onsubmit=\"return validate();\"\u003e\n                \u003clabel for=\"username\"\u003eUsername:\u003c/label\u003e\n                \u003cinput type=\"text\" id=\"username\" name=\"username\" required /\u003e\u003cbr /\u003e\n                \u003clabel for=\"password\"\u003ePassword:\u003c/label\u003e\n                \u003cinput type=\"password\" id=\"password\" name=\"password\" required /\u003e\u003cbr /\u003e\n                \u003cinput type=\"submit\" value=\"Login\" /\u003e\n            \u003c/form\u003e\n        \u003c/div\u003e\n    \u003c/body\u003e\n\u003c/html\u003e15:T71a,\u003c?php\n\n$flag = '"])</script><script>self.__next_f.push([1,"INTIGRITI{70p_53cr37_m15510n_c0mpl373}';\n\nif (isset($_GET['download'])) {\n    $file = $_GET['download'];\n    if (strpos($file, '/assets/images/') === 0) {\n        $filePath = __DIR__ . '/' . $file;\n        if (file_exists($filePath)) {\n            header('Content-Type: application/octet-stream');\n            header('Content-Disposition: attachment; filename=\"' . basename($filePath) . '\"');\n            header('Content-Length: ' . filesize($filePath));\n            readfile($filePath);\n            exit();\n        } else {\n            die('File not found!');\n        }\n    } else {\n        die('File path not allowed!');\n    }\n}\n?\u003e\n\n\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"UTF-8\"\u003e\n    \u003ctitle\u003eTop Secret Portal\u003c/title\u003e\n    \u003clink href=\"https://fonts.googleapis.com/css2?family=Orbitron\u0026display=swap\" rel=\"stylesheet\"\u003e\n    \u003clink rel=\"stylesheet\" href=\"/assets/css/secret-theme.css\"\u003e\n    \u003cscript src=\"/assets/js/displayImage.js\"\u003e\u003c/script\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n    \u003cdiv class=\"container\"\u003e\n        \u003ch1\u003eWelcome to the Top Secret Government Portal\u003c/h1\u003e\n        \u003cp\u003eAuthorized personnel only.\u003c/p\u003e\n\n        \u003cimg id=\"selectedImage\" src=\"/assets/images/topsecret1.png\" alt=\"Selected Image\"\u003e\n\n        \u003cform method=\"GET\" action=\"\"\u003e\n            \u003clabel for=\"image\"\u003eSelect Image to Download:\u003c/label\u003e\n            \u003cselect name=\"download\" id=\"image\" onchange=\"updateImage()\"\u003e\n                \u003coption value=\"/assets/images/topsecret1.png\"\u003eImage 1\u003c/option\u003e\n                \u003coption value=\"/assets/images/topsecret2.png\"\u003eImage 2\u003c/option\u003e\n                \u003coption value=\"/assets/images/topsecret3.png\"\u003eImage 3\u003c/option\u003e\n                \u003coption value=\"/assets/images/topsecret4.png\"\u003eImage 4\u003c/option\u003e\n            \u003c/select\u003e\n            \u003cbutton type=\"submit\"\u003eDownload\u003c/button\u003e\n        \u003c/form\u003e\n    \u003c/div\u003e\n\u003c/body\u003e\n\u003c/html\u003e"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"children\":[\"$\",\"main\",null,{\"className\":\"max-w-5xl mx-auto text-sm [\u0026_h1]:text-5xl [\u0026_h1]:font-semibold [\u0026_h1]:mb-8 [\u0026_blockquote]:text-secondary [\u0026_blockquote]:space-y-3 [\u0026_blockquote]:border-l-4 [\u0026_blockquote]:border-secondary [\u0026_blockquote]:pl-5 [\u0026_blockquote]:mb-5 [\u0026\u003e_p]:my-3 [\u0026_img]:my-5 [\u0026_ul]:list-disc [\u0026_ul]:pl-6 [\u0026_img]:rounded [\u0026_li]:my-2\",\"children\":[[\"$\",\"h1\",\"h1-0\",{\"children\":\"1337UP LIVE CTF 2024 — Pizza Paradise\"}],\"\\n\",[\"$\",\"blockquote\",\"blockquote-0\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"Something weird going on at this pizza store!!\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":\"https://pizzaparadise.ctf.intigriti.io\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"We're given a simple pizza chain website looking like this:\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/c66ca812-f460-43d5-b7c1-238e0ef25457\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":[\"Looking at the source code, CSS, and images, nothing seems out of the ordinary. However, going to \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"robots.txt\"}],\",\"]}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/bd8a7188-6944-4b3f-893f-6492b8b1600a\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-4\",{\"children\":\"Going to that suspicious route, we find a \\\"top secret\\\" login page looking like this:\"}],\"\\n\",[\"$\",\"p\",\"p-5\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/ba966615-b9e0-409e-b51a-3212475f77fa\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"$L13\",\"pre-0\",{\"className\":\"my-4\",\"children\":\"$14\",\"language\":\"html\"}],\"\\n\",[\"$\",\"p\",\"p-6\",{\"children\":[\"Trying some simple SQL injection payloads, nothing happens. But looking at the \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"validate()\"}],\" code, because validation is done on the client side, we can find the credentials we need to match in \",[\"$\",\"code\",\"code-1\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"auth.js\"}],\":\"]}],\"\\n\",[\"$\",\"$L13\",\"pre-1\",{\"className\":\"my-4\",\"children\":\"const validUsername = \\\"agent_1337\\\";\\nconst validPasswordHash = \\\"91a915b6bdcfb47045859288a9e2bd651af246f07a083f11958550056bed8eac\\\";\\n\\nfunction getCredentials() {\\n    return {\\n        username: validUsername,\\n        passwordHash: validPasswordHash,\\n    };\\n}\",\"language\":\"js\"}],\"\\n\",[\"$\",\"p\",\"p-7\",{\"children\":\"But what's the unhashed version of the password? We can try some sketchy online hash-cracker lookup websites, and to my surprise,\"}],\"\\n\",[\"$\",\"p\",\"p-8\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/498744ae-2741-481a-93d7-ba5a786e61be\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-9\",{\"children\":\"Then, we have our final credentials:\"}],\"\\n\",[\"$\",\"$L13\",\"pre-2\",{\"className\":\"my-4\",\"children\":\"username: agent_1337\\npassword: intel420\",\"language\":\"$undefined\"}],\"\\n\",[\"$\",\"p\",\"p-10\",{\"children\":\"Logging in, we get to the \\\"top secret government portal\\\":\"}],\"\\n\",[\"$\",\"p\",\"p-11\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/71aff1bd-07cd-4283-ab93-9b7ebff7f426\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-12\",{\"children\":\"We can download four AI-generated images, but nothing seems off about them either. The realization here is that this page reveals a special route for downloading files:\"}],\"\\n\",[\"$\",\"p\",\"p-13\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/ed9ab6a2-45fa-466c-93e7-623bf9cd6ae8\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-14\",{\"children\":[\"We can try to download other \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"topsecretx.png\"}],\" images, but none exist. We can also notice that any path not beginning with \",[\"$\",\"code\",\"code-1\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"/assets/images/\"}],\" fails with \\\"path not allowed\\\". Instead, we can finally apply path traversal to download the PHP handler for the admin portal endpoint,\"]}],\"\\n\",[\"$\",\"p\",\"p-15\",{\"children\":\"https://pizzaparadise.ctf.intigriti.io/topsecret_a9aedc6c39f654e55275ad8e65e316b3.php?download=/assets/images/../../topsecret_a9aedc6c39f654e55275ad8e65e316b3.php\"}],\"\\n\",[\"$\",\"$L13\",\"pre-3\",{\"className\":\"my-4\",\"children\":\"$15\",\"language\":\"php\"}],\"\\n\",[\"$\",\"p\",\"p-16\",{\"children\":\"getting us the flag.\"}]]}]}]\n"])</script></body></html>