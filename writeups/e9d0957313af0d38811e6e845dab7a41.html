<!DOCTYPE html><!--nDyrqgKsYWBjc5CSiVf1q--><html class="dark scroll-smooth"><head><meta charSet="utf-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/5137b7a074c35308.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-d11e0b30904b49ad.js"/><script src="/_next/static/chunks/4bd1b696-9911af18dede28aa.js" async=""></script><script src="/_next/static/chunks/964-2bcac1827bbf29c7.js" async=""></script><script src="/_next/static/chunks/main-app-771e5b53791411ad.js" async=""></script><script src="/_next/static/chunks/874-3e820bd666038662.js" async=""></script><script src="/_next/static/chunks/app/writeups/%5Bid%5D/layout-2577bd3482649595.js" async=""></script><script src="/_next/static/chunks/bc9c3264-6371ca03223855d4.js" async=""></script><script src="/_next/static/chunks/48507feb-8452885980bba250.js" async=""></script><script src="/_next/static/chunks/08ffe114-f47006c90e36a3eb.js" async=""></script><script src="/_next/static/chunks/800-bd0deb6e7b7e903a.js" async=""></script><script src="/_next/static/chunks/app/writeups/%5Bid%5D/page-54fe20cc7a9d3224.js" async=""></script><meta name="next-size-adjust" content=""/><title>San Diego CTF 2024 — Raccoon Run | kevin.fish</title><meta name="description" content="The annual UC San Diego Raccoon Run is happening right now!! Apparently there&#x27;s an underground gambling ring going on there. Maybe you can make it big?"/><meta property="og:title" content="San Diego CTF 2024 — Raccoon Run"/><meta property="og:description" content="The annual UC San Diego Raccoon Run is happening right now!! Apparently there&#x27;s an underground gambling ring going on there. Maybe you can make it big?"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="San Diego CTF 2024 — Raccoon Run"/><meta name="twitter:description" content="The annual UC San Diego Raccoon Run is happening right now!! Apparently there&#x27;s an underground gambling ring going on there. Maybe you can make it big?"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="text-dark dark:text-white dark:bg-midnight" style="font-family:&#x27;Inter&#x27;, &#x27;Inter Fallback&#x27;;font-style:normal"><div hidden=""><!--$--><!--/$--></div><main class="container pt-20 pb-24"><a class="text-secondary text-sm mb-10 -ml-5 block w-max" href="/writeups">← Back to writeups</a><div><main class="text-pretty max-w-5xl mx-auto text-sm [&amp;_h1]:text-5xl [&amp;_h1]:font-semibold [&amp;_h1]:mb-8 [&amp;_blockquote]:text-secondary [&amp;_blockquote]:space-y-3 [&amp;_blockquote]:border-l-4 [&amp;_blockquote]:border-secondary [&amp;_blockquote]:pl-5 [&amp;_blockquote]:mb-5 [&amp;&gt;_p]:my-4 [&amp;_img]:my-5 [&amp;_ul]:list-disc [&amp;_ul]:pl-6 [&amp;_ol]:list-decimal [&amp;_ol]:pl-6 [&amp;_img]:rounded [&amp;_li]:my-2"><h1>San Diego CTF 2024 — Raccoon Run</h1>
<blockquote>
<p>The annual UC San Diego Raccoon Run is happening right now!! Apparently there&#x27;s an underground gambling ring going on there. Maybe you can make it big?</p>
</blockquote>
<p>We&#x27;re given a Python server that looks like this:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"></path></svg> <!-- -->py<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">import</span><span class=""> json
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token keyword">from</span><span class=""> time </span><span class="token keyword">import</span><span class=""> time
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token keyword">import</span><span class=""> tornado
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token keyword">import</span><span class=""> tornado</span><span class="token punctuation">.</span><span class="">websocket
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token keyword">import</span><span class=""> tornado</span><span class="token punctuation">.</span><span class="">ioloop
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class=""></span><span class="token keyword">import</span><span class=""> random
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class=""></span><span class="token keyword">import</span><span class=""> asyncio
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class=""></span><span class="token keyword">import</span><span class=""> os
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class=""></span><span class="token keyword">from</span><span class=""> datetime </span><span class="token keyword">import</span><span class=""> timedelta
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">10</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class=""></span><span class="token keyword">import</span><span class=""> tornado</span><span class="token punctuation">.</span><span class="">web
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class=""></span><span class="token keyword">import</span><span class=""> tornado</span><span class="token punctuation">.</span><span class="">gen
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">13</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class="">PORT </span><span class="token operator">=</span><span class=""> </span><span class="token number">8000</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">15</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">16</span><span class="">NUM_RACCOONS </span><span class="token operator">=</span><span class=""> </span><span class="token number">8</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">17</span><span class="">FINISH_LINE </span><span class="token operator">=</span><span class=""> </span><span class="token number">1000</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">18</span><span class="">TARGET_BET </span><span class="token operator">=</span><span class=""> </span><span class="token number">1000</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">19</span><span class="">STEP_TIME </span><span class="token operator">=</span><span class=""> </span><span class="token number">0.25</span><span class=""> </span><span class="token comment"># in seconds</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">20</span><span class="">BETTING_TIME </span><span class="token operator">=</span><span class=""> </span><span class="token number">15</span><span class=""> </span><span class="token comment"># in seconds</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">21</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">22</span><span class="">FLAG </span><span class="token operator">=</span><span class=""> os</span><span class="token punctuation">.</span><span class="">environ</span><span class="token punctuation">[</span><span class="token string">&quot;GZCTF_FLAG&quot;</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">23</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">24</span><span class="">active_betters </span><span class="token operator">=</span><span class=""> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">25</span><span class="">connections </span><span class="token operator">=</span><span class=""> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">26</span><span class="">connection_count </span><span class="token operator">=</span><span class=""> </span><span class="token number">0</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">27</span><span class="">game </span><span class="token operator">=</span><span class=""> </span><span class="token boolean">None</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">28</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">29</span><span class=""></span><span class="token keyword">class</span><span class=""> </span><span class="token class-name">RaccoonRun</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">30</span><span class="">    </span><span class="token keyword">def</span><span class=""> </span><span class="token function">__init__</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">31</span><span class="">        self</span><span class="token punctuation">.</span><span class="">raccoons </span><span class="token operator">=</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">*</span><span class=""> </span><span class="token number">8</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">32</span><span class="">        self</span><span class="token punctuation">.</span><span class="">finishers </span><span class="token operator">=</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">33</span><span class="">        self</span><span class="token punctuation">.</span><span class="">can_bet </span><span class="token operator">=</span><span class=""> </span><span class="token boolean">True</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">34</span><span class="">        self</span><span class="token punctuation">.</span><span class="">bet_end </span><span class="token operator">=</span><span class=""> </span><span class="token number">0</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">35</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">36</span><span class="">    </span><span class="token keyword">def</span><span class=""> </span><span class="token function">step</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">37</span><span class="">        self</span><span class="token punctuation">.</span><span class="">can_bet </span><span class="token operator">=</span><span class=""> </span><span class="token boolean">False</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">38</span><span class="">        random_int </span><span class="token operator">=</span><span class=""> random</span><span class="token punctuation">.</span><span class="">getrandbits</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">39</span><span class="">        </span><span class="token keyword">for</span><span class=""> i </span><span class="token keyword">in</span><span class=""> </span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="">NUM_RACCOONS</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">40</span><span class="">            self</span><span class="token punctuation">.</span><span class="">raccoons</span><span class="token punctuation">[</span><span class="">i</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">+=</span><span class=""> </span><span class="token punctuation">(</span><span class="">random_int </span><span class="token operator">&gt;&gt;</span><span class=""> </span><span class="token punctuation">(</span><span class="">i </span><span class="token operator">*</span><span class=""> </span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">%</span><span class=""> </span><span class="token number">16</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">41</span><span class="">        </span><span class="token keyword">for</span><span class=""> </span><span class="token punctuation">(</span><span class="">i</span><span class="token punctuation">,</span><span class=""> x</span><span class="token punctuation">)</span><span class=""> </span><span class="token keyword">in</span><span class=""> </span><span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">.</span><span class="">raccoons</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">42</span><span class="">            </span><span class="token keyword">if</span><span class=""> x </span><span class="token operator">&gt;=</span><span class=""> FINISH_LINE </span><span class="token keyword">and</span><span class=""> i </span><span class="token keyword">not</span><span class=""> </span><span class="token keyword">in</span><span class=""> self</span><span class="token punctuation">.</span><span class="">finishers</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">43</span><span class="">                self</span><span class="token punctuation">.</span><span class="">finishers</span><span class="token punctuation">.</span><span class="">append</span><span class="token punctuation">(</span><span class="">i</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">44</span><span class="">        </span><span class="token keyword">return</span><span class=""> </span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">.</span><span class="">raccoons</span><span class="token punctuation">,</span><span class=""> self</span><span class="token punctuation">.</span><span class="">finishers</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">45</span>    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">46</span><span class="">    </span><span class="token keyword">def</span><span class=""> </span><span class="token function">game_over</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">47</span><span class="">        </span><span class="token keyword">return</span><span class=""> </span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">.</span><span class="">finishers</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">&gt;=</span><span class=""> NUM_RACCOONS
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">48</span>    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">49</span><span class=""></span><span class="token keyword">class</span><span class=""> </span><span class="token class-name">Gambler</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">50</span><span class="">    </span><span class="token keyword">def</span><span class=""> </span><span class="token function">__init__</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">,</span><span class=""> account</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">51</span><span class="">        self</span><span class="token punctuation">.</span><span class="">account </span><span class="token operator">=</span><span class=""> account
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">52</span><span class="">        self</span><span class="token punctuation">.</span><span class="">guess </span><span class="token operator">=</span><span class=""> </span><span class="token boolean">None</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">53</span><span class="">        self</span><span class="token punctuation">.</span><span class="">bet_amount </span><span class="token operator">=</span><span class=""> </span><span class="token number">0</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">54</span>    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">55</span><span class="">    </span><span class="token keyword">def</span><span class=""> </span><span class="token function">bet</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">,</span><span class=""> guess</span><span class="token punctuation">,</span><span class=""> bet_amount</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">56</span><span class="">        </span><span class="token keyword">if</span><span class=""> self</span><span class="token punctuation">.</span><span class="">validate_bet</span><span class="token punctuation">(</span><span class="">guess</span><span class="token punctuation">,</span><span class=""> bet_amount</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">57</span><span class="">            self</span><span class="token punctuation">.</span><span class="">guess </span><span class="token operator">=</span><span class=""> guess
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">58</span><span class="">            self</span><span class="token punctuation">.</span><span class="">bet_amount </span><span class="token operator">=</span><span class=""> bet_amount
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">59</span><span class="">            </span><span class="token keyword">return</span><span class=""> </span><span class="token boolean">True</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">60</span><span class="">        </span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">61</span><span class="">            </span><span class="token keyword">return</span><span class=""> </span><span class="token boolean">False</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">62</span>    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">63</span><span class="">    </span><span class="token keyword">def</span><span class=""> </span><span class="token function">validate_bet</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">,</span><span class=""> guess</span><span class="token punctuation">,</span><span class=""> bet_amount</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">64</span><span class="">        </span><span class="token keyword">if</span><span class=""> </span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="">guess</span><span class="token punctuation">)</span><span class=""> </span><span class="token keyword">is</span><span class=""> </span><span class="token keyword">not</span><span class=""> </span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">65</span><span class="">            </span><span class="token keyword">return</span><span class=""> </span><span class="token boolean">False</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">66</span><span class="">        </span><span class="token keyword">if</span><span class=""> </span><span class="token keyword">not</span><span class=""> </span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="">x</span><span class="token punctuation">)</span><span class=""> </span><span class="token keyword">is</span><span class=""> </span><span class="token builtin">int</span><span class=""> </span><span class="token keyword">for</span><span class=""> x </span><span class="token keyword">in</span><span class=""> guess</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">67</span><span class="">            </span><span class="token keyword">return</span><span class=""> </span><span class="token boolean">False</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">68</span><span class="">        </span><span class="token keyword">if</span><span class=""> </span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="">guess</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> NUM_RACCOONS</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">69</span><span class="">            </span><span class="token keyword">return</span><span class=""> </span><span class="token boolean">False</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">70</span><span class="">        </span><span class="token keyword">if</span><span class=""> </span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="">bet_amount</span><span class="token punctuation">)</span><span class=""> </span><span class="token keyword">is</span><span class=""> </span><span class="token keyword">not</span><span class=""> </span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">71</span><span class="">            </span><span class="token keyword">return</span><span class=""> </span><span class="token boolean">False</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">72</span><span class="">        </span><span class="token keyword">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">bet_amount </span><span class="token operator">&lt;</span><span class=""> </span><span class="token number">0</span><span class=""> </span><span class="token keyword">or</span><span class=""> bet_amount </span><span class="token operator">&gt;</span><span class=""> self</span><span class="token punctuation">.</span><span class="">account</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">73</span><span class="">            </span><span class="token keyword">return</span><span class=""> </span><span class="token boolean">False</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">74</span><span class="">        </span><span class="token keyword">return</span><span class=""> </span><span class="token boolean">True</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">75</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">76</span><span class="">    </span><span class="token comment"># updates amount of money in account after game is over and bet comes through</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">77</span><span class="">    </span><span class="token comment"># and then return an boolean indicating whether you won/lost</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">78</span><span class="">    </span><span class="token keyword">def</span><span class=""> </span><span class="token function">check_bet</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">,</span><span class=""> game_instance</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">79</span><span class="">        </span><span class="token keyword">if</span><span class=""> game_instance</span><span class="token punctuation">.</span><span class="">finishers </span><span class="token operator">==</span><span class=""> self</span><span class="token punctuation">.</span><span class="">guess</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">80</span><span class="">            self</span><span class="token punctuation">.</span><span class="">account </span><span class="token operator">+=</span><span class=""> self</span><span class="token punctuation">.</span><span class="">bet_amount
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">81</span><span class="">            </span><span class="token keyword">return</span><span class=""> </span><span class="token boolean">True</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">82</span><span class="">        </span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">83</span><span class="">            self</span><span class="token punctuation">.</span><span class="">account </span><span class="token operator">-=</span><span class=""> self</span><span class="token punctuation">.</span><span class="">bet_amount
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">84</span><span class="">            </span><span class="token keyword">return</span><span class=""> </span><span class="token boolean">False</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">85</span>    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">86</span><span class="">    </span><span class="token keyword">def</span><span class=""> </span><span class="token function">reset_bet</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">87</span><span class="">        self</span><span class="token punctuation">.</span><span class="">guess </span><span class="token operator">=</span><span class=""> </span><span class="token boolean">None</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">88</span><span class="">        self</span><span class="token punctuation">.</span><span class="">bet_amount </span><span class="token operator">=</span><span class=""> </span><span class="token number">0</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">89</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">90</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">get_race_information</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">91</span><span class="">    </span><span class="token keyword">return</span><span class=""> json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;can_bet&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;true&quot;</span><span class=""> </span><span class="token keyword">if</span><span class=""> game</span><span class="token punctuation">.</span><span class="">can_bet </span><span class="token keyword">else</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;raccoons&quot;</span><span class="token punctuation">:</span><span class=""> game</span><span class="token punctuation">.</span><span class="">raccoons</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;finishers&quot;</span><span class="token punctuation">:</span><span class=""> game</span><span class="token punctuation">.</span><span class="">finishers</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;account&quot;</span><span class="token punctuation">:</span><span class=""> active_betters</span><span class="token punctuation">[</span><span class="token builtin">id</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="">account</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">92</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">93</span><span class=""></span><span class="token keyword">class</span><span class=""> </span><span class="token class-name">RRWebSocketHandler</span><span class="token punctuation">(</span><span class="">tornado</span><span class="token punctuation">.</span><span class="">websocket</span><span class="token punctuation">.</span><span class="">WebSocketHandler</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">94</span><span class="">    </span><span class="token keyword">def</span><span class=""> </span><span class="token function">open</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">95</span><span class="">        </span><span class="token keyword">global</span><span class=""> game
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">96</span><span class="">        </span><span class="token keyword">global</span><span class=""> active_betters
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">97</span><span class="">        </span><span class="token keyword">global</span><span class=""> connections
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">98</span><span class="">        </span><span class="token keyword">global</span><span class=""> connection_count
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">99</span>        
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">100</span><span class="">        self</span><span class="token punctuation">.</span><span class="">better_id </span><span class="token operator">=</span><span class=""> connection_count
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">101</span><span class="">        active_betters</span><span class="token punctuation">[</span><span class="">self</span><span class="token punctuation">.</span><span class="">better_id</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">=</span><span class=""> Gambler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">102</span><span class="">        connections</span><span class="token punctuation">[</span><span class="">self</span><span class="token punctuation">.</span><span class="">better_id</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">=</span><span class=""> self
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">103</span><span class="">        connection_count </span><span class="token operator">+=</span><span class=""> </span><span class="token number">1</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">104</span><span class="">        self</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">get_race_information</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">.</span><span class="">better_id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">105</span><span class="">        </span><span class="token keyword">if</span><span class=""> game</span><span class="token punctuation">.</span><span class="">can_bet</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">106</span><span class="">            self</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;betting-starts&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;until&quot;</span><span class="token punctuation">:</span><span class="">game</span><span class="token punctuation">.</span><span class="">bet_end</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">107</span>    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">108</span><span class="">    </span><span class="token keyword">def</span><span class=""> </span><span class="token function">on_message</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">,</span><span class=""> message</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">109</span><span class="">        </span><span class="token keyword">try</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">110</span><span class="">            data </span><span class="token operator">=</span><span class=""> json</span><span class="token punctuation">.</span><span class="">loads</span><span class="token punctuation">(</span><span class="">message</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">111</span><span class="">            </span><span class="token keyword">if</span><span class=""> </span><span class="token string">&quot;type&quot;</span><span class=""> </span><span class="token keyword">not</span><span class=""> </span><span class="token keyword">in</span><span class=""> data</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">112</span><span class="">                self</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;response&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;invalid WebSockets message&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">113</span><span class="">            </span><span class="token keyword">elif</span><span class=""> </span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">[</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">==</span><span class=""> </span><span class="token string">&quot;bet&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">114</span><span class="">                </span><span class="token keyword">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">game</span><span class="token punctuation">.</span><span class="">can_bet</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">115</span><span class="">                    </span><span class="token keyword">if</span><span class=""> active_betters</span><span class="token punctuation">[</span><span class="">self</span><span class="token punctuation">.</span><span class="">better_id</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="">bet</span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">[</span><span class="token string">&quot;order&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class=""> data</span><span class="token punctuation">[</span><span class="token string">&quot;amount&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">116</span><span class="">                        self</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;response&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;bet successfully placed!&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">117</span><span class="">                    </span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">118</span><span class="">                        self</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;response&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;bet is invalid, failed to be placed&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">119</span><span class="">                </span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">120</span><span class="">                    self</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;response&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;bet cannot be placed after the race starts, failed to be placed&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">121</span><span class="">            </span><span class="token keyword">elif</span><span class=""> </span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">[</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">==</span><span class=""> </span><span class="token string">&quot;buy_flag&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">122</span><span class="">                </span><span class="token keyword">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">active_betters</span><span class="token punctuation">[</span><span class="">self</span><span class="token punctuation">.</span><span class="">better_id</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="">account </span><span class="token operator">&gt;</span><span class=""> TARGET_BET</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">123</span><span class="">                    self</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;flag&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class=""> FLAG</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">124</span><span class="">            </span><span class="token keyword">elif</span><span class=""> </span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">[</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">==</span><span class=""> </span><span class="token string">&quot;state&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">125</span><span class="">                self</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;response&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;bet&quot;</span><span class=""> </span><span class="token keyword">if</span><span class=""> game</span><span class="token punctuation">.</span><span class="">can_bet </span><span class="token keyword">else</span><span class=""> </span><span class="token string">&quot;race&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">126</span><span class="">            </span><span class="token keyword">elif</span><span class=""> </span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">[</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">==</span><span class=""> </span><span class="token string">&quot;account&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">127</span><span class="">                self</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;response&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class=""> active_betters</span><span class="token punctuation">[</span><span class="">self</span><span class="token punctuation">.</span><span class="">better_id</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="">account</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">128</span><span class="">            </span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">129</span><span class="">                self</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;response&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;invalid WebSockets message&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">130</span><span class="">        </span><span class="token keyword">except</span><span class=""> json</span><span class="token punctuation">.</span><span class="">JSONDecodeError</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">131</span><span class="">            self</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;response&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;invalid WebSockets message&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">132</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">133</span><span class="">    </span><span class="token keyword">def</span><span class=""> </span><span class="token function">on_close</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">134</span><span class="">        </span><span class="token keyword">del</span><span class=""> active_betters</span><span class="token punctuation">[</span><span class="">self</span><span class="token punctuation">.</span><span class="">better_id</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">135</span><span class="">        </span><span class="token keyword">del</span><span class=""> connections</span><span class="token punctuation">[</span><span class="">self</span><span class="token punctuation">.</span><span class="">better_id</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">136</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">137</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">game_loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">138</span><span class="">    </span><span class="token keyword">global</span><span class=""> game
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">139</span><span class="">    </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Raccoons&quot;</span><span class="token punctuation">,</span><span class=""> game</span><span class="token punctuation">.</span><span class="">raccoons</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">140</span><span class="">    </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Finishers&quot;</span><span class="token punctuation">,</span><span class=""> game</span><span class="token punctuation">.</span><span class="">finishers</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">141</span><span class="">    </span><span class="token keyword">for</span><span class=""> </span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span><span class=""> connection</span><span class="token punctuation">)</span><span class=""> </span><span class="token keyword">in</span><span class=""> connections</span><span class="token punctuation">.</span><span class="">items</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">142</span><span class="">        connection</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">get_race_information</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">143</span><span class="">    game</span><span class="token punctuation">.</span><span class="">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">144</span><span class="">    </span><span class="token keyword">if</span><span class=""> game</span><span class="token punctuation">.</span><span class="">game_over</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">145</span><span class="">        </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Raccoons&quot;</span><span class="token punctuation">,</span><span class=""> game</span><span class="token punctuation">.</span><span class="">raccoons</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">146</span><span class="">        </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Finishers&quot;</span><span class="token punctuation">,</span><span class=""> game</span><span class="token punctuation">.</span><span class="">finishers</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">147</span><span class="">        </span><span class="token keyword">for</span><span class=""> </span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span><span class=""> connection</span><span class="token punctuation">)</span><span class=""> </span><span class="token keyword">in</span><span class=""> connections</span><span class="token punctuation">.</span><span class="">items</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">148</span><span class="">            connection</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">get_race_information</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">149</span><span class="">            connection</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class=""> game</span><span class="token punctuation">.</span><span class="">finishers</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">150</span><span class="">        </span><span class="token keyword">for</span><span class=""> </span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span><span class=""> x</span><span class="token punctuation">)</span><span class=""> </span><span class="token keyword">in</span><span class=""> active_betters</span><span class="token punctuation">.</span><span class="">items</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">151</span><span class="">            </span><span class="token keyword">if</span><span class=""> x</span><span class="token punctuation">.</span><span class="">guess </span><span class="token operator">!=</span><span class=""> </span><span class="token boolean">None</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">152</span><span class="">                win </span><span class="token operator">=</span><span class=""> x</span><span class="token punctuation">.</span><span class="">check_bet</span><span class="token punctuation">(</span><span class="">game</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">153</span><span class="">                connections</span><span class="token punctuation">[</span><span class="token builtin">id</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;bet_status&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string-interpolation string">f&quot;you </span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation string">&#x27;won&#x27;</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword">if</span><span class="token string-interpolation interpolation"> win </span><span class="token string-interpolation interpolation keyword">else</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation string">&#x27;lost&#x27;</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string"> the bet, your account now has $</span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation">.</span><span class="token string-interpolation interpolation">account</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">154</span><span class="">                x</span><span class="token punctuation">.</span><span class="">reset_bet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">155</span><span class="">            </span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">156</span><span class="">                connections</span><span class="token punctuation">[</span><span class="token builtin">id</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;bet_status&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string-interpolation string">f&quot;you didn&#x27;t place a bet, your account now has $</span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation">.</span><span class="token string-interpolation interpolation">account</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">157</span><span class="">        </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Every raccoon has finished the race.&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">158</span><span class="">        </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation string">f&quot;Starting new game! Leaving </span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">BETTING_TIME</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string"> seconds for bets...&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">159</span><span class="">        game </span><span class="token operator">=</span><span class=""> RaccoonRun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">160</span><span class="">        game</span><span class="token punctuation">.</span><span class="">bet_end </span><span class="token operator">=</span><span class=""> time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">+</span><span class=""> BETTING_TIME
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">161</span><span class="">        </span><span class="token keyword">for</span><span class=""> </span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span><span class=""> connection</span><span class="token punctuation">)</span><span class=""> </span><span class="token keyword">in</span><span class=""> connections</span><span class="token punctuation">.</span><span class="">items</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">162</span><span class="">            connection</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">get_race_information</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">163</span><span class="">            connection</span><span class="token punctuation">.</span><span class="">write_message</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;betting-starts&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;until&quot;</span><span class="token punctuation">:</span><span class="">game</span><span class="token punctuation">.</span><span class="">bet_end</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">164</span><span class="">        tornado</span><span class="token punctuation">.</span><span class="">ioloop</span><span class="token punctuation">.</span><span class="">IOLoop</span><span class="token punctuation">.</span><span class="">current</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">add_timeout</span><span class="token punctuation">(</span><span class="">timedelta</span><span class="token punctuation">(</span><span class="">seconds</span><span class="token operator">=</span><span class="">BETTING_TIME</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class=""> game_loop</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">165</span><span class="">    </span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">166</span><span class="">        tornado</span><span class="token punctuation">.</span><span class="">ioloop</span><span class="token punctuation">.</span><span class="">IOLoop</span><span class="token punctuation">.</span><span class="">current</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">add_timeout</span><span class="token punctuation">(</span><span class="">timedelta</span><span class="token punctuation">(</span><span class="">seconds</span><span class="token operator">=</span><span class="">STEP_TIME</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class=""> game_loop</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">167</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">168</span><span class=""></span><span class="token keyword">if</span><span class=""> __name__ </span><span class="token operator">==</span><span class=""> </span><span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">169</span><span class="">    tornado</span><span class="token punctuation">.</span><span class="">ioloop</span><span class="token punctuation">.</span><span class="">IOLoop</span><span class="token punctuation">.</span><span class="">configure</span><span class="token punctuation">(</span><span class="token string">&quot;tornado.platform.asyncio.AsyncIOLoop&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">170</span><span class="">    io_loop </span><span class="token operator">=</span><span class=""> tornado</span><span class="token punctuation">.</span><span class="">ioloop</span><span class="token punctuation">.</span><span class="">IOLoop</span><span class="token punctuation">.</span><span class="">current</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">171</span><span class="">    asyncio</span><span class="token punctuation">.</span><span class="">set_event_loop</span><span class="token punctuation">(</span><span class="">io_loop</span><span class="token punctuation">.</span><span class="">asyncio_loop</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">172</span><span class="">    game </span><span class="token operator">=</span><span class=""> RaccoonRun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">173</span><span class="">    </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation string">f&quot;Starting new game! Leaving </span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">BETTING_TIME</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string"> seconds for bets...&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">174</span><span class="">    game</span><span class="token punctuation">.</span><span class="">bet_end </span><span class="token operator">=</span><span class=""> time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">+</span><span class=""> BETTING_TIME
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">175</span><span class="">    tornado</span><span class="token punctuation">.</span><span class="">ioloop</span><span class="token punctuation">.</span><span class="">IOLoop</span><span class="token punctuation">.</span><span class="">current</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">add_timeout</span><span class="token punctuation">(</span><span class="">timedelta</span><span class="token punctuation">(</span><span class="">seconds</span><span class="token operator">=</span><span class="">BETTING_TIME</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class=""> game_loop</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">176</span><span class="">    application </span><span class="token operator">=</span><span class=""> tornado</span><span class="token punctuation">.</span><span class="">web</span><span class="token punctuation">.</span><span class="">Application</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">177</span><span class="">        </span><span class="token punctuation">(</span><span class="token string">r&quot;/ws&quot;</span><span class="token punctuation">,</span><span class=""> RRWebSocketHandler</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">178</span><span class="">        </span><span class="token punctuation">(</span><span class="token string">r&quot;/(.*)&quot;</span><span class="token punctuation">,</span><span class=""> tornado</span><span class="token punctuation">.</span><span class="">web</span><span class="token punctuation">.</span><span class="">StaticFileHandler</span><span class="token punctuation">,</span><span class=""> </span><span class="token punctuation">{</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;./static&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;default_filename&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;index.html&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">179</span><span class="">    </span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">180</span><span class="">    application</span><span class="token punctuation">.</span><span class="">listen</span><span class="token punctuation">(</span><span class="">PORT</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">181</span><span class="">    io_loop</span><span class="token punctuation">.</span><span class="">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div></div>
<p>At each step of the race, 4-bit chunks of a random 32-bit int are added to each raccoons position, continuing until all 8 raccoons cross the finish line (&gt; 1000). While we can bet on the order of the raccoons to finish the race, we only win if our guess is exactly correct.</p>
<p>The main idea with this challenge is that because we&#x27;re given the positions of the raccoons at each step, we can reconstruct the exact 32-bit integer used to reach that step. Feeding that integer into an RNG cracker, we can reverse engineer the RNG being used by the server to run the races, then simulate each race ahead of time to bet flawlessly and buy the flag.</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"></path></svg> <!-- -->py<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">import</span><span class=""> numpy </span><span class="token keyword">as</span><span class=""> np
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token keyword">import</span><span class=""> websocket
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token keyword">import</span><span class=""> json
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token keyword">from</span><span class=""> randcrack </span><span class="token keyword">import</span><span class=""> RandCrack
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">5</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">6</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">WS_URL </span><span class="token operator">=</span><span class=""> </span><span class="token string">&quot;ws://127.0.0.1:64045/ws&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="">TARGET_BET </span><span class="token operator">=</span><span class=""> </span><span class="token number">1000</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">9</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="">rc </span><span class="token operator">=</span><span class=""> RandCrack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class="">raccoons </span><span class="token operator">=</span><span class=""> np</span><span class="token punctuation">.</span><span class="">zeros</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class=""> dtype</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class="">balance </span><span class="token operator">=</span><span class=""> </span><span class="token number">10</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">13</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class="">start_processing </span><span class="token operator">=</span><span class=""> </span><span class="token boolean">False</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class="">stop_processing </span><span class="token operator">=</span><span class=""> </span><span class="token boolean">False</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">16</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">17</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">18</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">on_message</span><span class="token punctuation">(</span><span class="">ws</span><span class="token punctuation">,</span><span class=""> message</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">19</span><span class="">    </span><span class="token keyword">global</span><span class=""> start_processing</span><span class="token punctuation">,</span><span class=""> stop_processing</span><span class="token punctuation">,</span><span class=""> balance</span><span class="token punctuation">,</span><span class=""> raccoons
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">20</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">21</span><span class="">    </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#x27;Received message:&#x27;</span><span class="token punctuation">,</span><span class=""> message</span><span class="token punctuation">,</span><span class=""> flush</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">22</span><span class="">    data </span><span class="token operator">=</span><span class=""> json</span><span class="token punctuation">.</span><span class="">loads</span><span class="token punctuation">(</span><span class="">message</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">23</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">24</span><span class="">    </span><span class="token keyword">match</span><span class=""> data</span><span class="token punctuation">[</span><span class="token string">&#x27;type&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">25</span><span class="">        </span><span class="token comment"># Reset race data</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">26</span><span class="">        </span><span class="token keyword">case</span><span class=""> </span><span class="token string">&#x27;bet_status&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">27</span><span class="">            raccoons </span><span class="token operator">=</span><span class=""> np</span><span class="token punctuation">.</span><span class="">zeros</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class=""> dtype</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">28</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">29</span><span class="">        </span><span class="token keyword">case</span><span class=""> </span><span class="token string">&#x27;betting-starts&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">30</span><span class="">            start_processing </span><span class="token operator">=</span><span class=""> </span><span class="token boolean">True</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">31</span><span class="">            </span><span class="token keyword">if</span><span class=""> </span><span class="token keyword">not</span><span class=""> rc</span><span class="token punctuation">.</span><span class="">state</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">32</span><span class="">                </span><span class="token keyword">return</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">33</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">34</span><span class="">            </span><span class="token comment"># If `rc.state` is populated, stop sampling random output</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">35</span><span class="">            stop_processing </span><span class="token operator">=</span><span class=""> </span><span class="token boolean">True</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">36</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">37</span><span class="">            </span><span class="token comment"># If we have enough to buy the flag, do so</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">38</span><span class="">            </span><span class="token keyword">if</span><span class=""> balance </span><span class="token operator">&gt;</span><span class=""> TARGET_BET</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">39</span><span class="">                ws</span><span class="token punctuation">.</span><span class="">send</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">40</span><span class="">                    </span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;buy_flag&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">41</span><span class="">                </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">42</span><span class="">                </span><span class="token keyword">return</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">43</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">44</span><span class="">            </span><span class="token comment"># Otherwise, predict the winners and place a bet</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">45</span><span class="">            r_state </span><span class="token operator">=</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">*</span><span class=""> </span><span class="token number">8</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">46</span><span class="">            finishers </span><span class="token operator">=</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">47</span><span class="">            </span><span class="token keyword">while</span><span class=""> </span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="">finishers</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token number">8</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">48</span><span class="">                random_int </span><span class="token operator">=</span><span class=""> rc</span><span class="token punctuation">.</span><span class="">predict_getrandbits</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">49</span><span class="">                </span><span class="token keyword">for</span><span class=""> i </span><span class="token keyword">in</span><span class=""> </span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">50</span><span class="">                    r_state</span><span class="token punctuation">[</span><span class="">i</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">+=</span><span class=""> </span><span class="token punctuation">(</span><span class="">random_int </span><span class="token operator">&gt;&gt;</span><span class=""> </span><span class="token punctuation">(</span><span class="">i </span><span class="token operator">*</span><span class=""> </span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">%</span><span class=""> </span><span class="token number">16</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">51</span><span class="">                    </span><span class="token keyword">if</span><span class=""> r_state</span><span class="token punctuation">[</span><span class="">i</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">&gt;=</span><span class=""> </span><span class="token number">1000</span><span class=""> </span><span class="token keyword">and</span><span class=""> i </span><span class="token keyword">not</span><span class=""> </span><span class="token keyword">in</span><span class=""> finishers</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">52</span><span class="">                        finishers</span><span class="token punctuation">.</span><span class="">append</span><span class="token punctuation">(</span><span class="">i</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">53</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">54</span><span class="">            </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation string">f&quot;The bet is: </span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">finishers</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">55</span><span class="">            ws</span><span class="token punctuation">.</span><span class="">send</span><span class="token punctuation">(</span><span class="">json</span><span class="token punctuation">.</span><span class="">dumps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">56</span><span class="">                </span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class=""> </span><span class="token string">&quot;bet&quot;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">57</span><span class="">                </span><span class="token string">&quot;order&quot;</span><span class="token punctuation">:</span><span class=""> finishers</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">58</span><span class="">                </span><span class="token string">&quot;amount&quot;</span><span class="token punctuation">:</span><span class=""> balance
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">59</span><span class="">            </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">60</span><span class="">            balance </span><span class="token operator">*=</span><span class=""> </span><span class="token number">2</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">61</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">62</span><span class="">        </span><span class="token keyword">case</span><span class=""> </span><span class="token string">&#x27;race_information&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">63</span><span class="">            </span><span class="token comment"># Ignore data if we&#x27;ve started the script in the middle of a race, or after we&#x27;ve reached a betting</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">64</span><span class="">            </span><span class="token comment"># phase with populated `rc.state`.</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">65</span><span class="">            </span><span class="token keyword">if</span><span class=""> </span><span class="token keyword">not</span><span class=""> start_processing </span><span class="token keyword">or</span><span class=""> stop_processing</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">66</span><span class="">                </span><span class="token keyword">return</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">67</span><span class="">            </span><span class="token keyword">if</span><span class=""> data</span><span class="token punctuation">[</span><span class="token string">&#x27;can_bet&#x27;</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">==</span><span class=""> </span><span class="token string">&quot;true&quot;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">68</span><span class="">                </span><span class="token keyword">return</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">69</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">70</span><span class="">            </span><span class="token comment"># If we&#x27;ve populated `rc.state` before the end of a race, keep advancing the RNG.</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">71</span><span class="">            </span><span class="token keyword">if</span><span class=""> rc</span><span class="token punctuation">.</span><span class="">state</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">72</span><span class="">                rc</span><span class="token punctuation">.</span><span class="">predict_getrandbits</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">73</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">74</span><span class="">            new_states </span><span class="token operator">=</span><span class=""> np</span><span class="token punctuation">.</span><span class="">array</span><span class="token punctuation">(</span><span class="">data</span><span class="token punctuation">[</span><span class="token string">&#x27;raccoons&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">75</span><span class="">            diffs </span><span class="token operator">=</span><span class=""> new_states </span><span class="token operator">-</span><span class=""> raccoons
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">76</span><span class="">            raccoons </span><span class="token operator">=</span><span class=""> new_states
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">77</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">78</span><span class="">            </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">diffs</span><span class="token punctuation">,</span><span class=""> flush</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">79</span><span class="">            </span><span class="token comment"># print(&#x27;&#x27;.join(reversed(list(map(lambda d: bin(d)[2:].zfill(4), diffs)))))</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">80</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">81</span><span class="">            </span><span class="token comment"># Reverse random integer:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">82</span><span class="">            </span><span class="token comment"># self.raccoons[i] += (random_int &gt;&gt; (i * 4)) % 16</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">83</span><span class="">            reconstructed </span><span class="token operator">=</span><span class=""> </span><span class="token number">0</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">84</span><span class="">            </span><span class="token keyword">for</span><span class=""> i</span><span class="token punctuation">,</span><span class=""> num </span><span class="token keyword">in</span><span class=""> </span><span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="">diffs</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">85</span><span class="">                reconstructed </span><span class="token operator">+=</span><span class=""> num </span><span class="token operator">&lt;&lt;</span><span class=""> </span><span class="token punctuation">(</span><span class="">i </span><span class="token operator">*</span><span class=""> </span><span class="token number">4</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">86</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">87</span><span class="">            </span><span class="token comment"># Mask signed integer back to unsigned for randcrack</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">88</span><span class="">            reconstructed </span><span class="token operator">&amp;</span><span class="token operator">=</span><span class=""> </span><span class="token number">0xffffffff</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">89</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">90</span><span class="">            rc</span><span class="token punctuation">.</span><span class="">submit</span><span class="token punctuation">(</span><span class="">reconstructed</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">91</span><span class="">            </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation string">f&#x27;</span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">rc</span><span class="token string-interpolation interpolation punctuation">.</span><span class="token string-interpolation interpolation">counter</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">: </span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">reconstructed</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">&#x27;</span><span class="token punctuation">,</span><span class=""> flush</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">92</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">93</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">94</span><span class=""></span><span class="token keyword">if</span><span class=""> __name__ </span><span class="token operator">==</span><span class=""> </span><span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">95</span><span class="">    ws </span><span class="token operator">=</span><span class=""> websocket</span><span class="token punctuation">.</span><span class="">WebSocketApp</span><span class="token punctuation">(</span><span class="">WS_URL</span><span class="token punctuation">,</span><span class=""> on_message</span><span class="token operator">=</span><span class="">on_message</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">96</span><span class="">    ws</span><span class="token punctuation">.</span><span class="">run_forever</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div></div>
<p>After about ~5 games of sampling the RNG and 7 games of betting, we can purchase the flag:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M21.038,4.9l-7.577-4.498C13.009,0.134,12.505,0,12,0c-0.505,0-1.009,0.134-1.462,0.403L2.961,4.9 C2.057,5.437,1.5,6.429,1.5,7.503v8.995c0,1.073,0.557,2.066,1.462,2.603l7.577,4.497C10.991,23.866,11.495,24,12,24 c0.505,0,1.009-0.134,1.461-0.402l7.577-4.497c0.904-0.537,1.462-1.529,1.462-2.603V7.503C22.5,6.429,21.943,5.437,21.038,4.9z M15.17,18.946l0.013,0.646c0.001,0.078-0.05,0.167-0.111,0.198l-0.383,0.22c-0.061,0.031-0.111-0.007-0.112-0.085L14.57,19.29 c-0.328,0.136-0.66,0.169-0.872,0.084c-0.04-0.016-0.057-0.075-0.041-0.142l0.139-0.584c0.011-0.046,0.036-0.092,0.069-0.121 c0.012-0.011,0.024-0.02,0.036-0.026c0.022-0.011,0.043-0.014,0.062-0.006c0.229,0.077,0.521,0.041,0.802-0.101 c0.357-0.181,0.596-0.545,0.592-0.907c-0.003-0.328-0.181-0.465-0.613-0.468c-0.55,0.001-1.064-0.107-1.072-0.917 c-0.007-0.667,0.34-1.361,0.889-1.8l-0.007-0.652c-0.001-0.08,0.048-0.168,0.111-0.2l0.37-0.236 c0.061-0.031,0.111,0.007,0.112,0.087l0.006,0.653c0.273-0.109,0.511-0.138,0.726-0.088c0.047,0.012,0.067,0.076,0.048,0.151 l-0.144,0.578c-0.011,0.044-0.036,0.088-0.065,0.116c-0.012,0.012-0.025,0.021-0.038,0.028c-0.019,0.01-0.038,0.013-0.057,0.009 c-0.098-0.022-0.332-0.073-0.699,0.113c-0.385,0.195-0.52,0.53-0.517,0.778c0.003,0.297,0.155,0.387,0.681,0.396 c0.7,0.012,1.003,0.318,1.01,1.023C16.105,17.747,15.736,18.491,15.17,18.946z M19.143,17.859c0,0.06-0.008,0.116-0.058,0.145 l-1.916,1.164c-0.05,0.029-0.09,0.004-0.09-0.056v-0.494c0-0.06,0.037-0.093,0.087-0.122l1.887-1.129 c0.05-0.029,0.09-0.004,0.09,0.056V17.859z M20.459,6.797l-7.168,4.427c-0.894,0.523-1.553,1.109-1.553,2.187v8.833 c0,0.645,0.26,1.063,0.66,1.184c-0.131,0.023-0.264,0.039-0.398,0.039c-0.42,0-0.833-0.114-1.197-0.33L3.226,18.64 c-0.741-0.44-1.201-1.261-1.201-2.142V7.503c0-0.881,0.46-1.702,1.201-2.142l7.577-4.498c0.363-0.216,0.777-0.33,1.197-0.33 c0.419,0,0.833,0.114,1.197,0.33l7.577,4.498c0.624,0.371,1.046,1.013,1.164,1.732C21.686,6.557,21.12,6.411,20.459,6.797z"></path></svg> <!-- -->bash<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">PS C:</span><span class="token punctuation">\</span><span class="">Users</span><span class="token punctuation">\</span><span class="">kevin</span><span class="token punctuation">\</span><span class="">Downloads</span><span class="token operator">&gt;</span><span class=""> python3 .</span><span class="token punctuation">\</span><span class="">solve.py
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;true&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;betting-starts&quot;</span><span class="">, </span><span class="token string">&quot;until&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">1715572315.2874234</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;true&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">9</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">5</span><span class="">, </span><span class="token number">15</span><span class="">, </span><span class="token number">12</span><span class="">, </span><span class="token number">2</span><span class="">, </span><span class="token number">11</span><span class="">, </span><span class="token number">7</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class=""></span><span class="token punctuation">[</span><span class=""> </span><span class="token number">9</span><span class="">  </span><span class="token number">0</span><span class="">  </span><span class="token number">5</span><span class=""> </span><span class="token number">15</span><span class=""> </span><span class="token number">12</span><span class="">  </span><span class="token number">2</span><span class=""> </span><span class="token number">11</span><span class="">  </span><span class="token number">7</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class=""></span><span class="token number">1</span><span class="">: </span><span class="token number">2066543881</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">21</span><span class="">, </span><span class="token number">14</span><span class="">, </span><span class="token number">8</span><span class="">, </span><span class="token number">18</span><span class="">, </span><span class="token number">25</span><span class="">, </span><span class="token number">14</span><span class="">, </span><span class="token number">25</span><span class="">, </span><span class="token number">10</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class=""></span><span class="token punctuation">[</span><span class="token number">12</span><span class=""> </span><span class="token number">14</span><span class="">  </span><span class="token number">3</span><span class="">  </span><span class="token number">3</span><span class=""> </span><span class="token number">13</span><span class=""> </span><span class="token number">12</span><span class=""> </span><span class="token number">14</span><span class="">  </span><span class="token number">3</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class=""></span><span class="token number">2</span><span class="">: </span><span class="token number">1053635564</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">21</span><span class="">, </span><span class="token number">15</span><span class="">, </span><span class="token number">23</span><span class="">, </span><span class="token number">31</span><span class="">, </span><span class="token number">35</span><span class="">, </span><span class="token number">24</span><span class="">, </span><span class="token number">32</span><span class="">, </span><span class="token number">25</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class=""></span><span class="token punctuation">[</span><span class=""> </span><span class="token number">0</span><span class="">  </span><span class="token number">1</span><span class=""> </span><span class="token number">15</span><span class=""> </span><span class="token number">13</span><span class=""> </span><span class="token number">10</span><span class=""> </span><span class="token number">10</span><span class="">  </span><span class="token number">7</span><span class=""> </span><span class="token number">15</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class=""></span><span class="token number">3</span><span class="">: </span><span class="token number">4155170576</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">22</span><span class="">, </span><span class="token number">22</span><span class="">, </span><span class="token number">23</span><span class="">, </span><span class="token number">46</span><span class="">, </span><span class="token number">38</span><span class="">, </span><span class="token number">30</span><span class="">, </span><span class="token number">47</span><span class="">, </span><span class="token number">25</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class=""></span><span class="token punctuation">[</span><span class=""> </span><span class="token number">1</span><span class="">  </span><span class="token number">7</span><span class="">  </span><span class="token number">0</span><span class=""> </span><span class="token number">15</span><span class="">  </span><span class="token number">3</span><span class="">  </span><span class="token number">6</span><span class=""> </span><span class="token number">15</span><span class="">  </span><span class="token number">0</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">16</span><span class=""></span><span class="token number">4</span><span class="">: </span><span class="token number">258207857</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">17</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">37</span><span class="">, </span><span class="token number">23</span><span class="">, </span><span class="token number">23</span><span class="">, </span><span class="token number">56</span><span class="">, </span><span class="token number">42</span><span class="">, </span><span class="token number">39</span><span class="">, </span><span class="token number">50</span><span class="">, </span><span class="token number">33</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">18</span><span class=""></span><span class="token punctuation">[</span><span class="token number">15</span><span class="">  </span><span class="token number">1</span><span class="">  </span><span class="token number">0</span><span class=""> </span><span class="token number">10</span><span class="">  </span><span class="token number">4</span><span class="">  </span><span class="token number">9</span><span class="">  </span><span class="token number">3</span><span class="">  </span><span class="token number">8</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">19</span><span class=""></span><span class="token number">5</span><span class="">: </span><span class="token number">2207555615</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">20</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">50</span><span class="">, </span><span class="token number">32</span><span class="">, </span><span class="token number">30</span><span class="">, </span><span class="token number">57</span><span class="">, </span><span class="token number">53</span><span class="">, </span><span class="token number">54</span><span class="">, </span><span class="token number">53</span><span class="">, </span><span class="token number">38</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">21</span><span class=""></span><span class="token punctuation">[</span><span class="token number">13</span><span class="">  </span><span class="token number">9</span><span class="">  </span><span class="token number">7</span><span class="">  </span><span class="token number">1</span><span class=""> </span><span class="token number">11</span><span class=""> </span><span class="token number">15</span><span class="">  </span><span class="token number">3</span><span class="">  </span><span class="token number">5</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">22</span><span class=""></span><span class="token number">6</span><span class="">: </span><span class="token number">1408964509</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">23</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">51</span><span class="">, </span><span class="token number">33</span><span class="">, </span><span class="token number">31</span><span class="">, </span><span class="token number">71</span><span class="">, </span><span class="token number">60</span><span class="">, </span><span class="token number">58</span><span class="">, </span><span class="token number">67</span><span class="">, </span><span class="token number">38</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">24</span><span class=""></span><span class="token punctuation">[</span><span class=""> </span><span class="token number">1</span><span class="">  </span><span class="token number">1</span><span class="">  </span><span class="token number">1</span><span class=""> </span><span class="token number">14</span><span class="">  </span><span class="token number">7</span><span class="">  </span><span class="token number">4</span><span class=""> </span><span class="token number">14</span><span class="">  </span><span class="token number">0</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">25</span><span class=""></span><span class="token number">7</span><span class="">: </span><span class="token number">239591697</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">26</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">57</span><span class="">, </span><span class="token number">35</span><span class="">, </span><span class="token number">44</span><span class="">, </span><span class="token number">84</span><span class="">, </span><span class="token number">63</span><span class="">, </span><span class="token number">72</span><span class="">, </span><span class="token number">81</span><span class="">, </span><span class="token number">45</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">27</span><span class=""></span><span class="token punctuation">[</span><span class=""> </span><span class="token number">6</span><span class="">  </span><span class="token number">2</span><span class=""> </span><span class="token number">13</span><span class=""> </span><span class="token number">13</span><span class="">  </span><span class="token number">3</span><span class=""> </span><span class="token number">14</span><span class=""> </span><span class="token number">14</span><span class="">  </span><span class="token number">7</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">28</span><span class=""></span><span class="token number">8</span><span class="">: </span><span class="token number">2128862502</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">29</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">71</span><span class="">, </span><span class="token number">37</span><span class="">, </span><span class="token number">48</span><span class="">, </span><span class="token number">85</span><span class="">, </span><span class="token number">77</span><span class="">, </span><span class="token number">72</span><span class="">, </span><span class="token number">81</span><span class="">, </span><span class="token number">55</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">30</span><span class=""></span><span class="token punctuation">[</span><span class="token number">14</span><span class="">  </span><span class="token number">2</span><span class="">  </span><span class="token number">4</span><span class="">  </span><span class="token number">1</span><span class=""> </span><span class="token number">14</span><span class="">  </span><span class="token number">0</span><span class="">  </span><span class="token number">0</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">31</span><span class=""></span><span class="token number">9</span><span class="">: </span><span class="token number">2685277230</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">32</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">75</span><span class="">, </span><span class="token number">47</span><span class="">, </span><span class="token number">63</span><span class="">, </span><span class="token number">94</span><span class="">, </span><span class="token number">87</span><span class="">, </span><span class="token number">82</span><span class="">, </span><span class="token number">87</span><span class="">, </span><span class="token number">63</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">33</span><span class=""></span><span class="token punctuation">[</span><span class=""> </span><span class="token number">4</span><span class=""> </span><span class="token number">10</span><span class=""> </span><span class="token number">15</span><span class="">  </span><span class="token number">9</span><span class=""> </span><span class="token number">10</span><span class=""> </span><span class="token number">10</span><span class="">  </span><span class="token number">6</span><span class="">  </span><span class="token number">8</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">34</span><span class=""></span><span class="token number">10</span><span class="">: </span><span class="token number">2259328932</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">35</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">84</span><span class="">, </span><span class="token number">57</span><span class="">, </span><span class="token number">64</span><span class="">, </span><span class="token number">108</span><span class="">, </span><span class="token number">102</span><span class="">, </span><span class="token number">94</span><span class="">, </span><span class="token number">93</span><span class="">, </span><span class="token number">66</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">36</span><span class=""></span><span class="token punctuation">[</span><span class=""> </span><span class="token number">9</span><span class=""> </span><span class="token number">10</span><span class="">  </span><span class="token number">1</span><span class=""> </span><span class="token number">14</span><span class=""> </span><span class="token number">15</span><span class=""> </span><span class="token number">12</span><span class="">  </span><span class="token number">6</span><span class="">  </span><span class="token number">3</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">37</span><span class=""></span><span class="token number">11</span><span class="">: </span><span class="token number">919593385</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">38</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">91</span><span class="">, </span><span class="token number">64</span><span class="">, </span><span class="token number">67</span><span class="">, </span><span class="token number">116</span><span class="">, </span><span class="token number">106</span><span class="">, </span><span class="token number">96</span><span class="">, </span><span class="token number">106</span><span class="">, </span><span class="token number">69</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">39</span><span class=""></span><span class="token punctuation">[</span><span class=""> </span><span class="token number">7</span><span class="">  </span><span class="token number">7</span><span class="">  </span><span class="token number">3</span><span class="">  </span><span class="token number">8</span><span class="">  </span><span class="token number">4</span><span class="">  </span><span class="token number">2</span><span class=""> </span><span class="token number">13</span><span class="">  </span><span class="token number">3</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">40</span><span class=""></span><span class="token number">12</span><span class="">: </span><span class="token number">1025803127</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">41</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">102</span><span class="">, </span><span class="token number">71</span><span class="">, </span><span class="token number">68</span><span class="">, </span><span class="token number">129</span><span class="">, </span><span class="token number">115</span><span class="">, </span><span class="token number">101</span><span class="">, </span><span class="token number">119</span><span class="">, </span><span class="token number">76</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">42</span><span class=""></span><span class="token punctuation">[</span><span class="token number">11</span><span class="">  </span><span class="token number">7</span><span class="">  </span><span class="token number">1</span><span class=""> </span><span class="token number">13</span><span class="">  </span><span class="token number">9</span><span class="">  </span><span class="token number">5</span><span class=""> </span><span class="token number">13</span><span class="">  </span><span class="token number">7</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">43</span><span class=""></span><span class="token number">13</span><span class="">: </span><span class="token number">2103038331</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">44</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">111</span><span class="">, </span><span class="token number">73</span><span class="">, </span><span class="token number">80</span><span class="">, </span><span class="token number">135</span><span class="">, </span><span class="token number">123</span><span class="">, </span><span class="token number">114</span><span class="">, </span><span class="token number">130</span><span class="">, </span><span class="token number">91</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">45</span><span class=""></span><span class="token punctuation">[</span><span class=""> </span><span class="token number">9</span><span class="">  </span><span class="token number">2</span><span class=""> </span><span class="token number">12</span><span class="">  </span><span class="token number">6</span><span class="">  </span><span class="token number">8</span><span class=""> </span><span class="token number">13</span><span class=""> </span><span class="token number">11</span><span class=""> </span><span class="token number">15</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">46</span><span class=""></span><span class="token number">14</span><span class="">: </span><span class="token number">4225264681</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">47</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">119</span><span class="">, </span><span class="token number">84</span><span class="">, </span><span class="token number">95</span><span class="">, </span><span class="token number">143</span><span class="">, </span><span class="token number">131</span><span class="">, </span><span class="token number">119</span><span class="">, </span><span class="token number">137</span><span class="">, </span><span class="token number">104</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">10</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">48</span><span class=""></span><span class="token punctuation">[</span><span class=""> </span><span class="token number">8</span><span class=""> </span><span class="token number">11</span><span class=""> </span><span class="token number">15</span><span class="">  </span><span class="token number">8</span><span class="">  </span><span class="token number">8</span><span class="">  </span><span class="token number">5</span><span class="">  </span><span class="token number">7</span><span class=""> </span><span class="token number">13</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">49</span><span class=""></span><span class="token number">15</span><span class="">: </span><span class="token number">3612905400</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">50</span><span class=""></span><span class="token punctuation">..</span><span class="">.
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">51</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">1036</span><span class="">, </span><span class="token number">1052</span><span class="">, </span><span class="token number">1078</span><span class="">, </span><span class="token number">1060</span><span class="">, </span><span class="token number">1042</span><span class="">, </span><span class="token number">975</span><span class="">, </span><span class="token number">931</span><span class="">, </span><span class="token number">1044</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">3</span><span class="">, </span><span class="token number">2</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">1</span><span class="">, </span><span class="token number">4</span><span class="">, </span><span class="token number">7</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">640</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">52</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">1048</span><span class="">, </span><span class="token number">1057</span><span class="">, </span><span class="token number">1082</span><span class="">, </span><span class="token number">1070</span><span class="">, </span><span class="token number">1043</span><span class="">, </span><span class="token number">981</span><span class="">, </span><span class="token number">944</span><span class="">, </span><span class="token number">1045</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">3</span><span class="">, </span><span class="token number">2</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">1</span><span class="">, </span><span class="token number">4</span><span class="">, </span><span class="token number">7</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">640</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">53</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">1055</span><span class="">, </span><span class="token number">1066</span><span class="">, </span><span class="token number">1095</span><span class="">, </span><span class="token number">1080</span><span class="">, </span><span class="token number">1056</span><span class="">, </span><span class="token number">984</span><span class="">, </span><span class="token number">954</span><span class="">, </span><span class="token number">1057</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">3</span><span class="">, </span><span class="token number">2</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">1</span><span class="">, </span><span class="token number">4</span><span class="">, </span><span class="token number">7</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">640</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">54</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">1057</span><span class="">, </span><span class="token number">1071</span><span class="">, </span><span class="token number">1103</span><span class="">, </span><span class="token number">1080</span><span class="">, </span><span class="token number">1059</span><span class="">, </span><span class="token number">984</span><span class="">, </span><span class="token number">955</span><span class="">, </span><span class="token number">1060</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">3</span><span class="">, </span><span class="token number">2</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">1</span><span class="">, </span><span class="token number">4</span><span class="">, </span><span class="token number">7</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">640</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">55</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">1063</span><span class="">, </span><span class="token number">1073</span><span class="">, </span><span class="token number">1111</span><span class="">, </span><span class="token number">1094</span><span class="">, </span><span class="token number">1061</span><span class="">, </span><span class="token number">999</span><span class="">, </span><span class="token number">955</span><span class="">, </span><span class="token number">1061</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">3</span><span class="">, </span><span class="token number">2</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">1</span><span class="">, </span><span class="token number">4</span><span class="">, </span><span class="token number">7</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">640</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">56</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">1075</span><span class="">, </span><span class="token number">1078</span><span class="">, </span><span class="token number">1120</span><span class="">, </span><span class="token number">1095</span><span class="">, </span><span class="token number">1070</span><span class="">, </span><span class="token number">1003</span><span class="">, </span><span class="token number">967</span><span class="">, </span><span class="token number">1066</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">3</span><span class="">, </span><span class="token number">2</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">1</span><span class="">, </span><span class="token number">4</span><span class="">, </span><span class="token number">7</span><span class="">, </span><span class="token number">5</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">640</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">57</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">1087</span><span class="">, </span><span class="token number">1087</span><span class="">, </span><span class="token number">1121</span><span class="">, </span><span class="token number">1098</span><span class="">, </span><span class="token number">1083</span><span class="">, </span><span class="token number">1003</span><span class="">, </span><span class="token number">967</span><span class="">, </span><span class="token number">1077</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">3</span><span class="">, </span><span class="token number">2</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">1</span><span class="">, </span><span class="token number">4</span><span class="">, </span><span class="token number">7</span><span class="">, </span><span class="token number">5</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">640</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">58</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">1098</span><span class="">, </span><span class="token number">1092</span><span class="">, </span><span class="token number">1136</span><span class="">, </span><span class="token number">1111</span><span class="">, </span><span class="token number">1091</span><span class="">, </span><span class="token number">1006</span><span class="">, </span><span class="token number">973</span><span class="">, </span><span class="token number">1091</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">3</span><span class="">, </span><span class="token number">2</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">1</span><span class="">, </span><span class="token number">4</span><span class="">, </span><span class="token number">7</span><span class="">, </span><span class="token number">5</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">640</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">59</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">1111</span><span class="">, </span><span class="token number">1101</span><span class="">, </span><span class="token number">1140</span><span class="">, </span><span class="token number">1122</span><span class="">, </span><span class="token number">1104</span><span class="">, </span><span class="token number">1014</span><span class="">, </span><span class="token number">983</span><span class="">, </span><span class="token number">1102</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">3</span><span class="">, </span><span class="token number">2</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">1</span><span class="">, </span><span class="token number">4</span><span class="">, </span><span class="token number">7</span><span class="">, </span><span class="token number">5</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">640</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">60</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">1115</span><span class="">, </span><span class="token number">1116</span><span class="">, </span><span class="token number">1152</span><span class="">, </span><span class="token number">1136</span><span class="">, </span><span class="token number">1117</span><span class="">, </span><span class="token number">1026</span><span class="">, </span><span class="token number">993</span><span class="">, </span><span class="token number">1107</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">3</span><span class="">, </span><span class="token number">2</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">1</span><span class="">, </span><span class="token number">4</span><span class="">, </span><span class="token number">7</span><span class="">, </span><span class="token number">5</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">640</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">61</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;false&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">1129</span><span class="">, </span><span class="token number">1117</span><span class="">, </span><span class="token number">1163</span><span class="">, </span><span class="token number">1143</span><span class="">, </span><span class="token number">1117</span><span class="">, </span><span class="token number">1029</span><span class="">, </span><span class="token number">1005</span><span class="">, </span><span class="token number">1108</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">3</span><span class="">, </span><span class="token number">2</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">1</span><span class="">, </span><span class="token number">4</span><span class="">, </span><span class="token number">7</span><span class="">, </span><span class="token number">5</span><span class="">, </span><span class="token number">6</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">640</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">62</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;result&quot;</span><span class="">, </span><span class="token string">&quot;value&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">3</span><span class="">, </span><span class="token number">2</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">1</span><span class="">, </span><span class="token number">4</span><span class="">, </span><span class="token number">7</span><span class="">, </span><span class="token number">5</span><span class="">, </span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">63</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;bet_status&quot;</span><span class="">, </span><span class="token string">&quot;value&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;you won the bet, your account now has </span><span class="token string variable">$1280</span><span class="token string">&quot;</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">64</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;race_information&quot;</span><span class="">, </span><span class="token string">&quot;can_bet&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;true&quot;</span><span class="">, </span><span class="token string">&quot;raccoons&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="">, </span><span class="token number">0</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;finishers&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="">, </span><span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">1280</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">65</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;betting-starts&quot;</span><span class="">, </span><span class="token string">&quot;until&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token number">1715572927.6933398</span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">66</span><span class="">Received message: </span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;flag&quot;</span><span class="">, </span><span class="token string">&quot;value&quot;</span><span class="token builtin class-name">:</span><span class=""> </span><span class="token string">&quot;SDCTF{m3rs3nn3_tw15t3r_15_5cuff3d_b300818768b0}&quot;</span><span class="token punctuation">}</span></code></pre></div></div></main></div><!--$--><!--/$--></main><script src="/_next/static/chunks/webpack-d11e0b30904b49ad.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[87555,[],\"\"]\n3:I[31295,[],\"\"]\n4:I[6874,[\"874\",\"static/chunks/874-3e820bd666038662.js\",\"633\",\"static/chunks/app/writeups/%5Bid%5D/layout-2577bd3482649595.js\"],\"\"]\n6:I[59665,[],\"OutletBoundary\"]\n8:I[74911,[],\"AsyncMetadataOutlet\"]\na:I[59665,[],\"ViewportBoundary\"]\nc:I[59665,[],\"MetadataBoundary\"]\nd:\"$Sreact.suspense\"\nf:I[28393,[],\"\"]\n:HL[\"/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/5137b7a074c35308.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"nDyrqgKsYWBjc5CSiVf1q\",\"p\":\"\",\"c\":[\"\",\"writeups\",\"e9d0957313af0d38811e6e845dab7a41\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"writeups\",{\"children\":[[\"id\",\"e9d0957313af0d38811e6e845dab7a41\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/5137b7a074c35308.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"className\":\"dark scroll-smooth\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}]}],[\"$\",\"body\",null,{\"className\":\"text-dark dark:text-white dark:bg-midnight\",\"style\":{\"fontFamily\":\"'Inter', 'Inter Fallback'\",\"fontStyle\":\"normal\"},\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"h-screen flex items-center justify-center\",\"children\":[\"$\",\"main\",null,{\"className\":\"relative pl-14\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"absolute left-0 top-2 text-5xl text-grapefruit\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],[\"$\",\"h1\",null,{\"className\":\"font-bold text-7xl underline decoration-grapefruit mb-5\",\"children\":\"404.\"}],[\"$\",\"p\",null,{\"children\":\"Your requested page was not found.\"}],[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"font-medium text-inherit\",\"children\":\"Return to home →\"}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"writeups\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"main\",null,{\"className\":\"container pt-20 pb-24\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}],{\"children\":[[\"id\",\"e9d0957313af0d38811e6e845dab7a41\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[[\"$\",\"$L4\",null,{\"href\":\"/writeups\",\"className\":\"text-secondary text-sm mb-10 -ml-5 block w-max\",\"children\":\"← Back to writeups\"}],[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$L7\",[\"$\",\"$L8\",null,{\"promise\":\"$@9\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$La\",null,{\"children\":\"$Lb\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$Lc\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$d\",null,{\"fallback\":null,\"children\":\"$Le\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n7:null\n"])</script><script>self.__next_f.push([1,"10:I[50674,[\"263\",\"static/chunks/bc9c3264-6371ca03223855d4.js\",\"810\",\"static/chunks/48507feb-8452885980bba250.js\",\"330\",\"static/chunks/08ffe114-f47006c90e36a3eb.js\",\"800\",\"static/chunks/800-bd0deb6e7b7e903a.js\",\"134\",\"static/chunks/app/writeups/%5Bid%5D/page-54fe20cc7a9d3224.js\"],\"default\"]\n11:T1c0b,"])</script><script>self.__next_f.push([1,"import json\nfrom time import time\nimport tornado\nimport tornado.websocket\nimport tornado.ioloop\nimport random\nimport asyncio\nimport os\nfrom datetime import timedelta\n\nimport tornado.web\nimport tornado.gen\n\nPORT = 8000\n\nNUM_RACCOONS = 8\nFINISH_LINE = 1000\nTARGET_BET = 1000\nSTEP_TIME = 0.25 # in seconds\nBETTING_TIME = 15 # in seconds\n\nFLAG = os.environ[\"GZCTF_FLAG\"]\n\nactive_betters = {}\nconnections = {}\nconnection_count = 0\ngame = None\n\nclass RaccoonRun:\n    def __init__(self):\n        self.raccoons = [0] * 8\n        self.finishers = []\n        self.can_bet = True\n        self.bet_end = 0\n\n    def step(self):\n        self.can_bet = False\n        random_int = random.getrandbits(32)\n        for i in range(NUM_RACCOONS):\n            self.raccoons[i] += (random_int \u003e\u003e (i * 4)) % 16\n        for (i, x) in enumerate(self.raccoons):\n            if x \u003e= FINISH_LINE and i not in self.finishers:\n                self.finishers.append(i)\n        return (self.raccoons, self.finishers)\n    \n    def game_over(self):\n        return len(self.finishers) \u003e= NUM_RACCOONS\n    \nclass Gambler:\n    def __init__(self, account=10):\n        self.account = account\n        self.guess = None\n        self.bet_amount = 0\n    \n    def bet(self, guess, bet_amount):\n        if self.validate_bet(guess, bet_amount):\n            self.guess = guess\n            self.bet_amount = bet_amount\n            return True\n        else:\n            return False\n    \n    def validate_bet(self, guess, bet_amount):\n        if (type(guess) is not list):\n            return False\n        if not all(type(x) is int for x in guess):\n            return False\n        if len(guess) != NUM_RACCOONS:\n            return False\n        if (type(bet_amount) is not int):\n            return False\n        if (bet_amount \u003c 0 or bet_amount \u003e self.account):\n            return False\n        return True\n\n    # updates amount of money in account after game is over and bet comes through\n    # and then return an boolean indicating whether you won/lost\n    def check_bet(self, game_instance):\n        if game_instance.finishers == self.guess:\n            self.account += self.bet_amount\n            return True\n        else:\n            self.account -= self.bet_amount\n            return False\n    \n    def reset_bet(self):\n        self.guess = None\n        self.bet_amount = 0\n\ndef get_race_information(id):\n    return json.dumps({\"type\": \"race_information\", \"can_bet\": \"true\" if game.can_bet else \"false\", \"raccoons\": game.raccoons, \"finishers\": game.finishers, \"account\": active_betters[id].account})\n\nclass RRWebSocketHandler(tornado.websocket.WebSocketHandler):\n    def open(self):\n        global game\n        global active_betters\n        global connections\n        global connection_count\n        \n        self.better_id = connection_count\n        active_betters[self.better_id] = Gambler()\n        connections[self.better_id] = self\n        connection_count += 1\n        self.write_message(get_race_information(self.better_id))\n        if game.can_bet:\n            self.write_message(json.dumps({\"type\":\"betting-starts\",\"until\":game.bet_end}))\n    \n    def on_message(self, message):\n        try:\n            data = json.loads(message)\n            if \"type\" not in data:\n                self.write_message(json.dumps({\"type\": \"response\", \"value\": \"invalid WebSockets message\"}))\n            elif (data[\"type\"] == \"bet\"):\n                if (game.can_bet):\n                    if active_betters[self.better_id].bet(data[\"order\"], data[\"amount\"]):\n                        self.write_message(json.dumps({\"type\": \"response\", \"value\": \"bet successfully placed!\"}))\n                    else:\n                        self.write_message(json.dumps({\"type\": \"response\", \"value\": \"bet is invalid, failed to be placed\"}))\n                else:\n                    self.write_message(json.dumps({\"type\": \"response\", \"value\": \"bet cannot be placed after the race starts, failed to be placed\"}))\n            elif (data[\"type\"] == \"buy_flag\"):\n                if (active_betters[self.better_id].account \u003e TARGET_BET):\n                    self.write_message(json.dumps({\"type\": \"flag\", \"value\": FLAG}))\n            elif (data[\"type\"] == \"state\"):\n                self.write_message(json.dumps({\"type\": \"response\", \"value\": \"bet\" if game.can_bet else \"race\"}))\n            elif (data[\"type\"] == \"account\"):\n                self.write_message(json.dumps({\"type\": \"response\", \"value\": active_betters[self.better_id].account}))\n            else:\n                self.write_message(json.dumps({\"type\": \"response\", \"value\": \"invalid WebSockets message\"}))\n        except json.JSONDecodeError:\n            self.write_message(json.dumps({\"type\": \"response\", \"value\": \"invalid WebSockets message\"}))\n\n    def on_close(self):\n        del active_betters[self.better_id]\n        del connections[self.better_id]\n\ndef game_loop():\n    global game\n    print(\"Raccoons\", game.raccoons)\n    print(\"Finishers\", game.finishers)\n    for (id, connection) in connections.items():\n        connection.write_message(get_race_information(id))\n    game.step()\n    if game.game_over():\n        print(\"Raccoons\", game.raccoons)\n        print(\"Finishers\", game.finishers)\n        for (id, connection) in connections.items():\n            connection.write_message(get_race_information(id))\n            connection.write_message(json.dumps({\"type\":\"result\", \"value\": game.finishers}))\n        for (id, x) in active_betters.items():\n            if x.guess != None:\n                win = x.check_bet(game)\n                connections[id].write_message(json.dumps({\"type\": \"bet_status\", \"value\": f\"you {'won' if win else 'lost'} the bet, your account now has ${x.account}\"}))\n                x.reset_bet()\n            else:\n                connections[id].write_message(json.dumps({\"type\": \"bet_status\", \"value\": f\"you didn't place a bet, your account now has ${x.account}\"}))\n        print(\"Every raccoon has finished the race.\")\n        print(f\"Starting new game! Leaving {BETTING_TIME} seconds for bets...\")\n        game = RaccoonRun()\n        game.bet_end = time() + BETTING_TIME\n        for (id, connection) in connections.items():\n            connection.write_message(get_race_information(id))\n            connection.write_message(json.dumps({\"type\":\"betting-starts\",\"until\":game.bet_end}))\n        tornado.ioloop.IOLoop.current().add_timeout(timedelta(seconds=BETTING_TIME), game_loop)\n    else:\n        tornado.ioloop.IOLoop.current().add_timeout(timedelta(seconds=STEP_TIME), game_loop)\n\nif __name__ == \"__main__\":\n    tornado.ioloop.IOLoop.configure(\"tornado.platform.asyncio.AsyncIOLoop\")\n    io_loop = tornado.ioloop.IOLoop.current()\n    asyncio.set_event_loop(io_loop.asyncio_loop)\n    game = RaccoonRun()\n    print(f\"Starting new game! Leaving {BETTING_TIME} seconds for bets...\")\n    game.bet_end = time() + BETTING_TIME\n    tornado.ioloop.IOLoop.current().add_timeout(timedelta(seconds=BETTING_TIME), game_loop)\n    application = tornado.web.Application([\n        (r\"/ws\", RRWebSocketHandler),\n        (r\"/(.*)\", tornado.web.StaticFileHandler, {\"path\": \"./static\", \"default_filename\": \"index.html\"})\n    ])\n    application.listen(PORT)\n    io_loop.start()"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"children\":[\"$\",\"main\",null,{\"className\":\"text-pretty max-w-5xl mx-auto text-sm [\u0026_h1]:text-5xl [\u0026_h1]:font-semibold [\u0026_h1]:mb-8 [\u0026_blockquote]:text-secondary [\u0026_blockquote]:space-y-3 [\u0026_blockquote]:border-l-4 [\u0026_blockquote]:border-secondary [\u0026_blockquote]:pl-5 [\u0026_blockquote]:mb-5 [\u0026\u003e_p]:my-4 [\u0026_img]:my-5 [\u0026_ul]:list-disc [\u0026_ul]:pl-6 [\u0026_ol]:list-decimal [\u0026_ol]:pl-6 [\u0026_img]:rounded [\u0026_li]:my-2\",\"children\":[[\"$\",\"h1\",\"h1-0\",{\"children\":\"San Diego CTF 2024 — Raccoon Run\"}],\"\\n\",[\"$\",\"blockquote\",\"blockquote-0\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"The annual UC San Diego Raccoon Run is happening right now!! Apparently there's an underground gambling ring going on there. Maybe you can make it big?\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"We're given a Python server that looks like this:\"}],\"\\n\",[\"$\",\"$L10\",\"pre-0\",{\"className\":\"my-2\",\"children\":\"$11\",\"language\":\"py\"}],\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\"]}]}]\n"])</script><script>self.__next_f.push([1,"12:[\"$\",\"p\",\"p-1\",{\"children\":\"At each step of the race, 4-bit chunks of a random 32-bit int are added to each raccoons position, continuing until all 8 raccoons cross the finish line (\u003e 1000). While we can bet on the order of the raccoons to finish the race, we only win if our guess is exactly correct.\"}]\n13:[\"$\",\"p\",\"p-2\",{\"children\":\"The main idea with this challenge is that because we're given the positions of the raccoons at each step, we can reconstruct the exact 32-bit integer used to reach that step. Feeding that integer into an RNG cracker, we can reverse engineer the RNG being used by the server to run the races, then simulate each race ahead of time to bet flawlessly and buy the flag.\"}]\n17:Tb76,"])</script><script>self.__next_f.push([1,"import numpy as np\nimport websocket\nimport json\nfrom randcrack import RandCrack\n\n\nWS_URL = \"ws://127.0.0.1:64045/ws\"\nTARGET_BET = 1000\n\nrc = RandCrack()\nraccoons = np.zeros(8, dtype=int)\nbalance = 10\n\nstart_processing = False\nstop_processing = False\n\n\ndef on_message(ws, message):\n    global start_processing, stop_processing, balance, raccoons\n\n    print('Received message:', message, flush=True)\n    data = json.loads(message)\n\n    match data['type']:\n        # Reset race data\n        case 'bet_status':\n            raccoons = np.zeros(8, dtype=int)\n\n        case 'betting-starts':\n            start_processing = True\n            if not rc.state:\n                return\n\n            # If `rc.state` is populated, stop sampling random output\n            stop_processing = True\n\n            # If we have enough to buy the flag, do so\n            if balance \u003e TARGET_BET:\n                ws.send(json.dumps({\n                    \"type\": \"buy_flag\"\n                }))\n                return\n\n            # Otherwise, predict the winners and place a bet\n            r_state = [0] * 8\n            finishers = []\n            while len(finishers) != 8:\n                random_int = rc.predict_getrandbits(32)\n                for i in range(8):\n                    r_state[i] += (random_int \u003e\u003e (i * 4)) % 16\n                    if r_state[i] \u003e= 1000 and i not in finishers:\n                        finishers.append(i)\n\n            print(f\"The bet is: {finishers}\")\n            ws.send(json.dumps({\n                \"type\": \"bet\",\n                \"order\": finishers,\n                \"amount\": balance\n            }))\n            balance *= 2\n\n        case 'race_information':\n            # Ignore data if we've started the script in the middle of a race, or after we've reached a betting\n            # phase with populated `rc.state`.\n            if not start_processing or stop_processing:\n                return\n            if data['can_bet'] == \"true\":\n                return\n\n            # If we've populated `rc.state` before the end of a race, keep advancing the RNG.\n            if rc.state:\n                rc.predict_getrandbits(32)\n\n            new_states = np.array(data['raccoons'])\n            diffs = new_states - raccoons\n            raccoons = new_states\n\n            print(diffs, flush=True)\n            # print(''.join(reversed(list(map(lambda d: bin(d)[2:].zfill(4), diffs)))))\n\n            # Reverse random integer:\n            # self.raccoons[i] += (random_int \u003e\u003e (i * 4)) % 16\n            reconstructed = 0\n            for i, num in enumerate(diffs):\n                reconstructed += num \u003c\u003c (i * 4)\n\n            # Mask signed integer back to unsigned for randcrack\n            reconstructed \u0026= 0xffffffff\n\n            rc.submit(reconstructed)\n            print(f'{rc.counter}: {reconstructed}', flush=True)\n\n\nif __name__ == \"__main__\":\n    ws = websocket.WebSocketApp(WS_URL, on_message=on_message)\n    ws.run_forever()"])</script><script>self.__next_f.push([1,"14:[\"$\",\"$L10\",\"pre-1\",{\"className\":\"my-2\",\"children\":\"$17\",\"language\":\"py\"}]\n15:[\"$\",\"p\",\"p-3\",{\"children\":\"After about ~5 games of sampling the RNG and 7 games of betting, we can purchase the flag:\"}]\n18:T15fe,"])</script><script>self.__next_f.push([1,"PS C:\\Users\\kevin\\Downloads\u003e python3 .\\solve.py\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"true\", \"raccoons\": [0, 0, 0, 0, 0, 0, 0, 0], \"finishers\": [], \"account\": 10}\nReceived message: {\"type\": \"betting-starts\", \"until\": 1715572315.2874234}\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"true\", \"raccoons\": [0, 0, 0, 0, 0, 0, 0, 0], \"finishers\": [], \"account\": 10}\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [9, 0, 5, 15, 12, 2, 11, 7], \"finishers\": [], \"account\": 10}\n[ 9  0  5 15 12  2 11  7]\n1: 2066543881\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [21, 14, 8, 18, 25, 14, 25, 10], \"finishers\": [], \"account\": 10}\n[12 14  3  3 13 12 14  3]\n2: 1053635564\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [21, 15, 23, 31, 35, 24, 32, 25], \"finishers\": [], \"account\": 10}\n[ 0  1 15 13 10 10  7 15]\n3: 4155170576\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [22, 22, 23, 46, 38, 30, 47, 25], \"finishers\": [], \"account\": 10}\n[ 1  7  0 15  3  6 15  0]\n4: 258207857\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [37, 23, 23, 56, 42, 39, 50, 33], \"finishers\": [], \"account\": 10}\n[15  1  0 10  4  9  3  8]\n5: 2207555615\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [50, 32, 30, 57, 53, 54, 53, 38], \"finishers\": [], \"account\": 10}\n[13  9  7  1 11 15  3  5]\n6: 1408964509\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [51, 33, 31, 71, 60, 58, 67, 38], \"finishers\": [], \"account\": 10}\n[ 1  1  1 14  7  4 14  0]\n7: 239591697\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [57, 35, 44, 84, 63, 72, 81, 45], \"finishers\": [], \"account\": 10}\n[ 6  2 13 13  3 14 14  7]\n8: 2128862502\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [71, 37, 48, 85, 77, 72, 81, 55], \"finishers\": [], \"account\": 10}\n[14  2  4  1 14  0  0 10]\n9: 2685277230\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [75, 47, 63, 94, 87, 82, 87, 63], \"finishers\": [], \"account\": 10}\n[ 4 10 15  9 10 10  6  8]\n10: 2259328932\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [84, 57, 64, 108, 102, 94, 93, 66], \"finishers\": [], \"account\": 10}\n[ 9 10  1 14 15 12  6  3]\n11: 919593385\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [91, 64, 67, 116, 106, 96, 106, 69], \"finishers\": [], \"account\": 10}\n[ 7  7  3  8  4  2 13  3]\n12: 1025803127\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [102, 71, 68, 129, 115, 101, 119, 76], \"finishers\": [], \"account\": 10}\n[11  7  1 13  9  5 13  7]\n13: 2103038331\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [111, 73, 80, 135, 123, 114, 130, 91], \"finishers\": [], \"account\": 10}\n[ 9  2 12  6  8 13 11 15]\n14: 4225264681\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [119, 84, 95, 143, 131, 119, 137, 104], \"finishers\": [], \"account\": 10}\n[ 8 11 15  8  8  5  7 13]\n15: 3612905400\n...\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [1036, 1052, 1078, 1060, 1042, 975, 931, 1044], \"finishers\": [3, 2, 0, 1, 4, 7], \"account\": 640}\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [1048, 1057, 1082, 1070, 1043, 981, 944, 1045], \"finishers\": [3, 2, 0, 1, 4, 7], \"account\": 640}\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [1055, 1066, 1095, 1080, 1056, 984, 954, 1057], \"finishers\": [3, 2, 0, 1, 4, 7], \"account\": 640}\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [1057, 1071, 1103, 1080, 1059, 984, 955, 1060], \"finishers\": [3, 2, 0, 1, 4, 7], \"account\": 640}\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [1063, 1073, 1111, 1094, 1061, 999, 955, 1061], \"finishers\": [3, 2, 0, 1, 4, 7], \"account\": 640}\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [1075, 1078, 1120, 1095, 1070, 1003, 967, 1066], \"finishers\": [3, 2, 0, 1, 4, 7, 5], \"account\": 640}\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [1087, 1087, 1121, 1098, 1083, 1003, 967, 1077], \"finishers\": [3, 2, 0, 1, 4, 7, 5], \"account\": 640}\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [1098, 1092, 1136, 1111, 1091, 1006, 973, 1091], \"finishers\": [3, 2, 0, 1, 4, 7, 5], \"account\": 640}\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [1111, 1101, 1140, 1122, 1104, 1014, 983, 1102], \"finishers\": [3, 2, 0, 1, 4, 7, 5], \"account\": 640}\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [1115, 1116, 1152, 1136, 1117, 1026, 993, 1107], \"finishers\": [3, 2, 0, 1, 4, 7, 5], \"account\": 640}\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"false\", \"raccoons\": [1129, 1117, 1163, 1143, 1117, 1029, 1005, 1108], \"finishers\": [3, 2, 0, 1, 4, 7, 5, 6], \"account\": 640}\nReceived message: {\"type\": \"result\", \"value\": [3, 2, 0, 1, 4, 7, 5, 6]}\nReceived message: {\"type\": \"bet_status\", \"value\": \"you won the bet, your account now has $1280\"}\nReceived message: {\"type\": \"race_information\", \"can_bet\": \"true\", \"raccoons\": [0, 0, 0, 0, 0, 0, 0, 0], \"finishers\": [], \"account\": 1280}\nReceived message: {\"type\": \"betting-starts\", \"until\": 1715572927.6933398}\nReceived message: {\"type\": \"flag\", \"value\": \"SDCTF{m3rs3nn3_tw15t3r_15_5cuff3d_b300818768b0}\"}"])</script><script>self.__next_f.push([1,"16:[\"$\",\"$L10\",\"pre-2\",{\"className\":\"my-2\",\"children\":\"$18\",\"language\":\"bash\"}]\n"])</script><script>self.__next_f.push([1,"9:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"San Diego CTF 2024 — Raccoon Run | kevin.fish\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"The annual UC San Diego Raccoon Run is happening right now!! Apparently there's an underground gambling ring going on there. Maybe you can make it big?\"}],[\"$\",\"meta\",\"2\",{\"property\":\"og:title\",\"content\":\"San Diego CTF 2024 — Raccoon Run\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:description\",\"content\":\"The annual UC San Diego Raccoon Run is happening right now!! Apparently there's an underground gambling ring going on there. Maybe you can make it big?\"}],[\"$\",\"meta\",\"4\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"5\",{\"name\":\"twitter:title\",\"content\":\"San Diego CTF 2024 — Raccoon Run\"}],[\"$\",\"meta\",\"6\",{\"name\":\"twitter:description\",\"content\":\"The annual UC San Diego Raccoon Run is happening right now!! Apparently there's an underground gambling ring going on there. Maybe you can make it big?\"}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"e:\"$9:metadata\"\n"])</script></body></html>