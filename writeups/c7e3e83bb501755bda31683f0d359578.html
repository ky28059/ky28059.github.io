<!DOCTYPE html><html class="dark scroll-smooth"><head><meta charSet="utf-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/b41869de3b22c447.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-50d183473e3f8178.js"/><script src="/_next/static/chunks/4bd1b696-12b3d90ac4ed3802.js" async=""></script><script src="/_next/static/chunks/684-d3c2077e7b7fefb9.js" async=""></script><script src="/_next/static/chunks/main-app-99381da9a4c58049.js" async=""></script><script src="/_next/static/chunks/874-c62c375efd21db20.js" async=""></script><script src="/_next/static/chunks/app/writeups/layout-0d6432ad4376bd82.js" async=""></script><script src="/_next/static/chunks/325-8cc74193b249521f.js" async=""></script><script src="/_next/static/chunks/app/writeups/%5Bid%5D/page-d2275216898ea7fa.js" async=""></script><meta name="next-size-adjust" content=""/><title>kevin.fish</title><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="text-dark dark:text-white dark:bg-midnight" style="font-family:&#x27;Inter&#x27;, &#x27;Inter Fallback&#x27;;font-style:normal"><main class="container pt-20 pb-24"><a class="text-secondary text-sm mb-10 -ml-5 block w-max" href="/">← Back to home</a><div><main class="max-w-5xl mx-auto text-sm [&amp;_h1]:text-5xl [&amp;_h1]:font-semibold [&amp;_h1]:mb-8 [&amp;_blockquote]:text-secondary [&amp;_blockquote]:space-y-3 [&amp;_blockquote]:border-l-4 [&amp;_blockquote]:border-secondary [&amp;_blockquote]:pl-5 [&amp;_blockquote]:mb-5 [&amp;&gt;_p]:my-3 [&amp;_img]:my-5 [&amp;_ul]:list-disc [&amp;_ul]:pl-6 [&amp;_img]:rounded [&amp;_li]:my-2"><h1>CyberSpace CTF 2024 — Game with Rin</h1>
<blockquote>
<p>Nanakura Rin, a very skilled gamer, took one of the flags. You need to defeat her 200 times to get the flag back.</p>
<p><code class="text-primary bg-black/20 rounded p-1">nc game-with-rin.challs.csc.tf 1337</code></p>
</blockquote>
<p>We&#x27;re given a Python server that looks like this:</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (py)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">from</span><span class=""> basement_of_rin </span><span class="token keyword">import</span><span class=""> NanakuraRin</span><span class="token punctuation">,</span><span class=""> flag</span><span class="token punctuation">,</span><span class=""> generate_graph
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token keyword">import</span><span class=""> time
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token keyword">from</span><span class=""> random </span><span class="token keyword">import</span><span class=""> Random
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">5</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">Server</span><span class="token punctuation">(</span><span class="">m</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">	</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Server&gt; &quot;</span><span class=""> </span><span class="token operator">+</span><span class=""> m</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">8</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">Rin</span><span class="token punctuation">(</span><span class="">m</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="">	</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Rin&gt; &quot;</span><span class=""> </span><span class="token operator">+</span><span class=""> m</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">11</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">check_subset</span><span class="token punctuation">(</span><span class="">_subset</span><span class="token punctuation">,</span><span class=""> </span><span class="token builtin">set</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class="">	subset </span><span class="token operator">=</span><span class=""> </span><span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="">_subset</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class="">	</span><span class="token keyword">assert</span><span class=""> </span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="">subset</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token number">0</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class="">	</span><span class="token keyword">for</span><span class=""> i </span><span class="token keyword">in</span><span class=""> </span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="">subset</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">-</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">16</span><span class="">		subset</span><span class="token punctuation">[</span><span class="">i</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">&lt;</span><span class=""> subset</span><span class="token punctuation">[</span><span class="">i </span><span class="token operator">+</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">17</span><span class="">	</span><span class="token keyword">for</span><span class=""> x </span><span class="token keyword">in</span><span class=""> subset</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">18</span><span class="">		</span><span class="token keyword">assert</span><span class=""> x </span><span class="token keyword">in</span><span class=""> </span><span class="token builtin">set</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">19</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">20</span><span class=""></span><span class="token keyword">class</span><span class=""> </span><span class="token class-name">disjoint_set</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">21</span><span class="">	</span><span class="token keyword">def</span><span class=""> </span><span class="token function">__init__</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">,</span><span class=""> n</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">22</span><span class="">		self</span><span class="token punctuation">.</span><span class="">n </span><span class="token operator">=</span><span class=""> n
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">23</span><span class="">		self</span><span class="token punctuation">.</span><span class="">p </span><span class="token operator">=</span><span class=""> </span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">*</span><span class=""> self</span><span class="token punctuation">.</span><span class="">n
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">24</span><span class="">	</span><span class="token keyword">def</span><span class=""> </span><span class="token function">root</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">,</span><span class=""> u</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">25</span><span class="">		</span><span class="token keyword">if</span><span class=""> self</span><span class="token punctuation">.</span><span class="">p</span><span class="token punctuation">[</span><span class="">u</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">&lt;</span><span class=""> </span><span class="token number">0</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">26</span><span class="">			</span><span class="token keyword">return</span><span class=""> u
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">27</span><span class="">		self</span><span class="token punctuation">.</span><span class="">p</span><span class="token punctuation">[</span><span class="">u</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">=</span><span class=""> self</span><span class="token punctuation">.</span><span class="">root</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">.</span><span class="">p</span><span class="token punctuation">[</span><span class="">u</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">28</span><span class="">		</span><span class="token keyword">return</span><span class=""> self</span><span class="token punctuation">.</span><span class="">p</span><span class="token punctuation">[</span><span class="">u</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">29</span><span class="">	</span><span class="token keyword">def</span><span class=""> </span><span class="token function">share</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">,</span><span class=""> u</span><span class="token punctuation">,</span><span class=""> v</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">30</span><span class="">		</span><span class="token keyword">return</span><span class=""> self</span><span class="token punctuation">.</span><span class="">root</span><span class="token punctuation">(</span><span class="">u</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">==</span><span class=""> self</span><span class="token punctuation">.</span><span class="">root</span><span class="token punctuation">(</span><span class="">v</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">31</span><span class="">	</span><span class="token keyword">def</span><span class=""> </span><span class="token function">merge</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">,</span><span class=""> u</span><span class="token punctuation">,</span><span class=""> v</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">32</span><span class="">		u</span><span class="token punctuation">,</span><span class=""> v </span><span class="token operator">=</span><span class=""> self</span><span class="token punctuation">.</span><span class="">root</span><span class="token punctuation">(</span><span class="">u</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class=""> self</span><span class="token punctuation">.</span><span class="">root</span><span class="token punctuation">(</span><span class="">v</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">33</span><span class="">		</span><span class="token keyword">if</span><span class=""> u </span><span class="token operator">==</span><span class=""> v</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">34</span><span class="">			</span><span class="token keyword">return</span><span class=""> </span><span class="token boolean">False</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">35</span><span class="">		</span><span class="token keyword">if</span><span class=""> self</span><span class="token punctuation">.</span><span class="">p</span><span class="token punctuation">[</span><span class="">u</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">&gt;</span><span class=""> self</span><span class="token punctuation">.</span><span class="">p</span><span class="token punctuation">[</span><span class="">v</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">36</span><span class="">			u</span><span class="token punctuation">,</span><span class=""> v </span><span class="token operator">=</span><span class=""> v</span><span class="token punctuation">,</span><span class=""> u
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">37</span><span class="">		self</span><span class="token punctuation">.</span><span class="">p</span><span class="token punctuation">[</span><span class="">u</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">+=</span><span class=""> self</span><span class="token punctuation">.</span><span class="">p</span><span class="token punctuation">[</span><span class="">v</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">38</span><span class="">		self</span><span class="token punctuation">.</span><span class="">p</span><span class="token punctuation">[</span><span class="">v</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">=</span><span class=""> u
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">39</span><span class="">		</span><span class="token keyword">return</span><span class=""> </span><span class="token boolean">True</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">40</span><span class="">	</span><span class="token keyword">def</span><span class=""> </span><span class="token function">clear</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">41</span><span class="">		self</span><span class="token punctuation">.</span><span class="">p </span><span class="token operator">=</span><span class=""> </span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">*</span><span class=""> self</span><span class="token punctuation">.</span><span class="">n
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">42</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">43</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">check_tree</span><span class="token punctuation">(</span><span class="">subset</span><span class="token punctuation">,</span><span class=""> V</span><span class="token punctuation">,</span><span class=""> edges</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">44</span><span class="">	</span><span class="token keyword">assert</span><span class=""> </span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="">subset</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">==</span><span class=""> V </span><span class="token operator">-</span><span class=""> </span><span class="token number">1</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">45</span><span class="">	ds </span><span class="token operator">=</span><span class=""> disjoint_set</span><span class="token punctuation">(</span><span class="">V</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">46</span><span class="">	</span><span class="token keyword">for</span><span class=""> i </span><span class="token keyword">in</span><span class=""> subset</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">47</span><span class="">		</span><span class="token keyword">assert</span><span class=""> </span><span class="token builtin">isinstance</span><span class="token punctuation">(</span><span class="">i</span><span class="token punctuation">,</span><span class=""> </span><span class="token builtin">int</span><span class="token punctuation">)</span><span class=""> </span><span class="token keyword">and</span><span class=""> </span><span class="token number">0</span><span class=""> </span><span class="token operator">&lt;=</span><span class=""> i </span><span class="token operator">&lt;</span><span class=""> </span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="">edges</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">48</span><span class="">		u</span><span class="token punctuation">,</span><span class=""> v</span><span class="token punctuation">,</span><span class=""> w </span><span class="token operator">=</span><span class=""> edges</span><span class="token punctuation">[</span><span class="">i</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">49</span><span class="">		</span><span class="token keyword">assert</span><span class=""> ds</span><span class="token punctuation">.</span><span class="">merge</span><span class="token punctuation">(</span><span class="">u</span><span class="token punctuation">,</span><span class=""> v</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">50</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">51</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">determine_the_winner</span><span class="token punctuation">(</span><span class="">piles</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">52</span><span class="">	</span><span class="token comment"># https://en.wikipedia.org/wiki/Nim</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">53</span><span class="">	</span><span class="token comment"># Rin-chan is perfect, so she&#x27;ll always make the optimal move.</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">54</span><span class="">	</span><span class="token comment"># You&#x27;re perfect too, so you&#x27;ll always make the perfect move as well.</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">55</span><span class="">	</span><span class="token comment"># Let&#x27;s fast-forward the game to the end :)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">56</span><span class="">	nim </span><span class="token operator">=</span><span class=""> </span><span class="token number">0</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">57</span><span class="">	</span><span class="token keyword">for</span><span class=""> x </span><span class="token keyword">in</span><span class=""> piles</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">58</span><span class="">		nim </span><span class="token operator">^</span><span class="token operator">=</span><span class=""> x
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">59</span><span class="">	</span><span class="token keyword">return</span><span class=""> </span><span class="token string">&quot;first&quot;</span><span class=""> </span><span class="token keyword">if</span><span class=""> nim </span><span class="token operator">!=</span><span class=""> </span><span class="token number">0</span><span class=""> </span><span class="token keyword">else</span><span class=""> </span><span class="token string">&quot;second&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">60</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">61</span><span class=""></span><span class="token keyword">class</span><span class=""> </span><span class="token class-name">You</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">62</span><span class="">	</span><span class="token keyword">def</span><span class=""> </span><span class="token function">__init__</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">,</span><span class=""> V</span><span class="token punctuation">,</span><span class=""> edges</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">63</span><span class="">		Server</span><span class="token punctuation">(</span><span class="token string-interpolation string">f&quot;</span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">V </span><span class="token string-interpolation interpolation operator">=</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">64</span><span class="">		Server</span><span class="token punctuation">(</span><span class="token string-interpolation string">f&quot;</span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">edges </span><span class="token string-interpolation interpolation operator">=</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">65</span><span class="">	</span><span class="token keyword">def</span><span class=""> </span><span class="token function">first_move</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">66</span><span class="">		Server</span><span class="token punctuation">(</span><span class="token string">&quot;Please choose S&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">67</span><span class="">		</span><span class="token keyword">return</span><span class=""> </span><span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class=""> </span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;You&gt; S = &quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">split</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">68</span><span class="">	</span><span class="token keyword">def</span><span class=""> </span><span class="token function">read_first_move</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">,</span><span class=""> S</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">69</span><span class="">		Rin</span><span class="token punctuation">(</span><span class="token string-interpolation string">f&quot;I choose S = </span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation string">&#x27; &#x27;</span><span class="token string-interpolation interpolation punctuation">.</span><span class="token string-interpolation interpolation">join</span><span class="token string-interpolation interpolation punctuation">(</span><span class="token string-interpolation interpolation punctuation">[</span><span class="token string-interpolation interpolation builtin">str</span><span class="token string-interpolation interpolation punctuation">(</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation">)</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword">for</span><span class="token string-interpolation interpolation"> i </span><span class="token string-interpolation interpolation keyword">in</span><span class="token string-interpolation interpolation"> S</span><span class="token string-interpolation interpolation punctuation">]</span><span class="token string-interpolation interpolation punctuation">)</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">70</span><span class="">	</span><span class="token keyword">def</span><span class=""> </span><span class="token function">second_move</span><span class="token punctuation">(</span><span class="">self</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">71</span><span class="">		Server</span><span class="token punctuation">(</span><span class="token string">&quot;Please choose T&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">72</span><span class="">		</span><span class="token keyword">return</span><span class=""> </span><span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class=""> </span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;You&gt; T = &quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">split</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">73</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">74</span><span class="">Rin</span><span class="token punctuation">(</span><span class="token string">&quot;Do you want this flag?&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">75</span><span class="">Rin</span><span class="token punctuation">(</span><span class="token string">&quot;I&#x27;ll consider giving it to you if you defeat me 200 times :)&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">76</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">77</span><span class="">time</span><span class="token punctuation">.</span><span class="">sleep</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">78</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">79</span><span class="">Server</span><span class="token punctuation">(</span><span class="token string">&quot;-----------------------------------------------------------------------------------------&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">80</span><span class="">Server</span><span class="token punctuation">(</span><span class="token string">&quot;[Round Manual]&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">81</span><span class="">Server</span><span class="token punctuation">(</span><span class="token string">&quot;1. The server generates a set of edges with integer weight on vertices 0 ~ V-1.&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">82</span><span class="">Server</span><span class="token punctuation">(</span><span class="token string">&quot;2. You can either choose to go first or second.&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">83</span><span class="">Server</span><span class="token punctuation">(</span><span class="token string">&quot;3. First player chooses a subset S of edges of size V-1 which forms a tree.&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">84</span><span class="">Server</span><span class="token punctuation">(</span><span class="token string">&quot;( For the definition of tree, see https://en.wikipedia.org/wiki/Tree_(graph_theory) )&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">85</span><span class="">Server</span><span class="token punctuation">(</span><span class="token string">&quot;4. Second player chooses a non-empty subset T of S.&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">86</span><span class="">Server</span><span class="token punctuation">(</span><span class="token string">&quot;5. Add a pile consisting of w stones for each edge (u, v, w) in T.&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">87</span><span class="">Server</span><span class="token punctuation">(</span><span class="token string">&quot;6. Winner of the round is the winner of the nim game on those set of piles.&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">88</span><span class="">Server</span><span class="token punctuation">(</span><span class="token string">&quot;-----------------------------------------------------------------------------------------&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">89</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">90</span><span class="">time</span><span class="token punctuation">.</span><span class="">sleep</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">91</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">92</span><span class="">Rin</span><span class="token punctuation">(</span><span class="token string">&quot;GLHF!&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">93</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">94</span><span class="">time</span><span class="token punctuation">.</span><span class="">sleep</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">95</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">96</span><span class=""></span><span class="token keyword">for</span><span class=""> round_number </span><span class="token keyword">in</span><span class=""> </span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">97</span><span class="">	Server</span><span class="token punctuation">(</span><span class="token string-interpolation string">f&quot;Round </span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">round_number</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">98</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">99</span><span class="">	V</span><span class="token punctuation">,</span><span class=""> edges </span><span class="token operator">=</span><span class=""> generate_graph</span><span class="token punctuation">(</span><span class="">round_number</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">100</span><span class="">	</span><span class="token keyword">assert</span><span class=""> </span><span class="token builtin">isinstance</span><span class="token punctuation">(</span><span class="">V</span><span class="token punctuation">,</span><span class=""> </span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">101</span><span class="">	</span><span class="token keyword">assert</span><span class=""> </span><span class="token number">30</span><span class=""> </span><span class="token operator">&lt;=</span><span class=""> V </span><span class="token operator">&lt;=</span><span class=""> </span><span class="token number">200</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">102</span><span class="">	</span><span class="token keyword">assert</span><span class=""> </span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="">edges</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">&lt;=</span><span class=""> </span><span class="token number">300</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">103</span><span class="">	</span><span class="token keyword">for</span><span class=""> u</span><span class="token punctuation">,</span><span class=""> v</span><span class="token punctuation">,</span><span class=""> w </span><span class="token keyword">in</span><span class=""> edges</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">104</span><span class="">		</span><span class="token keyword">assert</span><span class=""> </span><span class="token builtin">isinstance</span><span class="token punctuation">(</span><span class="">u</span><span class="token punctuation">,</span><span class=""> </span><span class="token builtin">int</span><span class="token punctuation">)</span><span class=""> </span><span class="token keyword">and</span><span class=""> </span><span class="token builtin">isinstance</span><span class="token punctuation">(</span><span class="">v</span><span class="token punctuation">,</span><span class=""> </span><span class="token builtin">int</span><span class="token punctuation">)</span><span class=""> </span><span class="token keyword">and</span><span class=""> </span><span class="token builtin">isinstance</span><span class="token punctuation">(</span><span class="">w</span><span class="token punctuation">,</span><span class=""> </span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">105</span><span class="">		</span><span class="token keyword">assert</span><span class=""> </span><span class="token number">0</span><span class=""> </span><span class="token operator">&lt;=</span><span class=""> u </span><span class="token operator">&lt;</span><span class=""> V </span><span class="token keyword">and</span><span class=""> </span><span class="token number">0</span><span class=""> </span><span class="token operator">&lt;=</span><span class=""> v </span><span class="token operator">&lt;</span><span class=""> V </span><span class="token keyword">and</span><span class=""> </span><span class="token number">0</span><span class=""> </span><span class="token operator">&lt;=</span><span class=""> w </span><span class="token operator">&lt;</span><span class=""> </span><span class="token number">2</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="">V</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">106</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">107</span><span class="">	first</span><span class="token punctuation">,</span><span class=""> second </span><span class="token operator">=</span><span class=""> You</span><span class="token punctuation">(</span><span class="">V</span><span class="token punctuation">,</span><span class=""> edges</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class=""> NanakuraRin</span><span class="token punctuation">(</span><span class="">V</span><span class="token punctuation">,</span><span class=""> edges</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">108</span>	
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">109</span><span class="">	Rin</span><span class="token punctuation">(</span><span class="token string">&quot;Do you want to go [first] or [second]?&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">110</span><span class="">	resp </span><span class="token operator">=</span><span class=""> </span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;You&gt; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">111</span><span class="">	</span><span class="token keyword">if</span><span class=""> resp </span><span class="token keyword">not</span><span class=""> </span><span class="token keyword">in</span><span class=""> </span><span class="token punctuation">[</span><span class="token string">&quot;first&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;second&quot;</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">112</span><span class="">		Rin</span><span class="token punctuation">(</span><span class="token string">&quot;That&#x27;s not an option &gt;:(&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">113</span><span class="">		exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">114</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">115</span><span class="">	</span><span class="token keyword">if</span><span class=""> resp </span><span class="token operator">==</span><span class=""> </span><span class="token string">&quot;first&quot;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">116</span><span class="">		Rin</span><span class="token punctuation">(</span><span class="token string">&quot;Sure, you go first :D&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">117</span><span class="">	</span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">118</span><span class="">		Rin</span><span class="token punctuation">(</span><span class="token string">&quot;Ok, I go first :D&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">119</span><span class="">		first</span><span class="token punctuation">,</span><span class=""> second </span><span class="token operator">=</span><span class=""> second</span><span class="token punctuation">,</span><span class=""> first
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">120</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">121</span><span class="">	S </span><span class="token operator">=</span><span class=""> first</span><span class="token punctuation">.</span><span class="">first_move</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">122</span><span class="">	second</span><span class="token punctuation">.</span><span class="">read_first_move</span><span class="token punctuation">(</span><span class="">S</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">123</span><span class="">	check_subset</span><span class="token punctuation">(</span><span class="">S</span><span class="token punctuation">,</span><span class=""> </span><span class="token punctuation">[</span><span class="">i </span><span class="token keyword">for</span><span class=""> i </span><span class="token keyword">in</span><span class=""> </span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="">edges</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">124</span><span class="">	check_tree</span><span class="token punctuation">(</span><span class="">S</span><span class="token punctuation">,</span><span class=""> V</span><span class="token punctuation">,</span><span class=""> edges</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">125</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">126</span><span class="">	</span><span class="token keyword">if</span><span class=""> resp </span><span class="token operator">==</span><span class=""> </span><span class="token string">&quot;first&quot;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">127</span><span class="">		Rin</span><span class="token punctuation">(</span><span class="token string">&quot;My turn!&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">128</span><span class="">	</span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">129</span><span class="">		Rin</span><span class="token punctuation">(</span><span class="token string">&quot;Your turn!&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">130</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">131</span><span class="">	T </span><span class="token operator">=</span><span class=""> second</span><span class="token punctuation">.</span><span class="">second_move</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">132</span><span class="">	check_subset</span><span class="token punctuation">(</span><span class="">T</span><span class="token punctuation">,</span><span class=""> S</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">133</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">134</span><span class="">	</span><span class="token keyword">if</span><span class=""> resp </span><span class="token operator">==</span><span class=""> </span><span class="token string">&quot;first&quot;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">135</span><span class="">		Rin</span><span class="token punctuation">(</span><span class="token string-interpolation string">f&quot;I choose T = </span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation string">&#x27; &#x27;</span><span class="token string-interpolation interpolation punctuation">.</span><span class="token string-interpolation interpolation">join</span><span class="token string-interpolation interpolation punctuation">(</span><span class="token string-interpolation interpolation punctuation">[</span><span class="token string-interpolation interpolation builtin">str</span><span class="token string-interpolation interpolation punctuation">(</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation">)</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword">for</span><span class="token string-interpolation interpolation"> i </span><span class="token string-interpolation interpolation keyword">in</span><span class="token string-interpolation interpolation"> T</span><span class="token string-interpolation interpolation punctuation">]</span><span class="token string-interpolation interpolation punctuation">)</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">136</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">137</span><span class="">	winner </span><span class="token operator">=</span><span class=""> determine_the_winner</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="">edges</span><span class="token punctuation">[</span><span class="">i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class=""> </span><span class="token keyword">for</span><span class=""> i </span><span class="token keyword">in</span><span class=""> T</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">138</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">139</span><span class="">	r </span><span class="token operator">=</span><span class=""> Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">140</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">141</span><span class="">	</span><span class="token keyword">if</span><span class=""> winner </span><span class="token operator">!=</span><span class=""> resp</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">142</span><span class="">		Rin</span><span class="token punctuation">(</span><span class="">r</span><span class="token punctuation">.</span><span class="">choice</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;Git gud&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;Noob&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;Easy&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">143</span><span class="">		exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">144</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">145</span><span class="">	Rin</span><span class="token punctuation">(</span><span class="">r</span><span class="token punctuation">.</span><span class="">choice</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;Not like this!&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;You won :(&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;Ouch!&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;You got lucky this time.&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">146</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">147</span><span class="">Rin</span><span class="token punctuation">(</span><span class="token string">&quot;GG Well played!&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">148</span><span class="">Rin</span><span class="token punctuation">(</span><span class="token string">&quot;I guess I have no choice but to give you the flag.&quot;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:1em;text-align:right;user-select:none">149</span><span class="">Rin</span><span class="token punctuation">(</span><span class="token string-interpolation string">f&quot;</span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">flag</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">&quot;</span><span class="token punctuation">)</span></code></pre></div></div>
<p>On paper, the game works as follows:</p>
<ul>
<li>The server picks a <code class="text-primary bg-black/20 rounded p-1">V</code> and generates random weighted edges between those nodes.</li>
<li>We choose whether to go first or second.</li>
<li>Player 1 chooses a subset of size <code class="text-primary bg-black/20 rounded p-1">V - 1</code> that forms a tree.</li>
<li>Player 2 chooses a arbitrary (non-empty) subset of player 1&#x27;s choice.</li>
<li>This final subset is translated into <a href="https://en.wikipedia.org/wiki/Nim">Nim piles</a>, and the player who wins Nim wins the round.</li>
</ul>
<p>Unfortunately, there doesn&#x27;t seem to be duplicate protection in the subset choosing: we can always go second, and pick the same edge twice to guarantee that XOR of the weights = 0 and we win Nim.</p>
<p>Here&#x27;s a script that does just that:</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (py)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">import</span><span class=""> pwn
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">conn </span><span class="token operator">=</span><span class=""> pwn</span><span class="token punctuation">.</span><span class="">remote</span><span class="token punctuation">(</span><span class="token string">&#x27;game-with-rin.challs.csc.tf&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">1337</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">4</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token comment"># Solve proof of work</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class="">res </span><span class="token operator">=</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvuntil</span><span class="token punctuation">(</span><span class="token string">b&#x27;Solution?&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class=""></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">res</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="">sol </span><span class="token operator">=</span><span class=""> </span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&#x27;Solution: &#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">conn</span><span class="token punctuation">.</span><span class="">sendline</span><span class="token punctuation">(</span><span class="">sol</span><span class="token punctuation">.</span><span class="">encode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">10</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class=""></span><span class="token keyword">for</span><span class=""> i </span><span class="token keyword">in</span><span class=""> </span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class="">    conn</span><span class="token punctuation">.</span><span class="">recvuntil</span><span class="token punctuation">(</span><span class="token string">b&#x27;Rin&gt; Do you want to go [first] or [second]?&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class="">    conn</span><span class="token punctuation">.</span><span class="">sendline</span><span class="token punctuation">(</span><span class="token string">b&#x27;second&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">14</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class="">    conn</span><span class="token punctuation">.</span><span class="">recvuntil</span><span class="token punctuation">(</span><span class="token string">b&#x27;Rin&gt; I choose S = &#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">16</span><span class="">    first </span><span class="token operator">=</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">split</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">17</span><span class="">    conn</span><span class="token punctuation">.</span><span class="">sendline</span><span class="token punctuation">(</span><span class="token string-interpolation string">f&#x27;</span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">first</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string"> </span><span class="token string-interpolation interpolation punctuation">{</span><span class="token string-interpolation interpolation">first</span><span class="token string-interpolation interpolation punctuation">}</span><span class="token string-interpolation string">&#x27;</span><span class="token punctuation">.</span><span class="">encode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">18</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">19</span><span class="">    </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">i</span><span class="token punctuation">,</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">20</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">21</span><span class=""></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">conn</span><span class="token punctuation">.</span><span class="">recvall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div></div>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">[x] Opening connection to game-with-rin.challs.csc.tf on port 1337
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>[x] Opening connection to game-with-rin.challs.csc.tf on port 1337: Trying 34.47.157.234
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span>[+] Opening connection to game-with-rin.challs.csc.tf on port 1337: Done
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">4</span>b&#x27;== proof-of-work: enabled ==\nplease solve a pow first\nYou can run the solver with:\n    python3 &lt;(curl -sSL https://goo.gle/kctf-pow) solve s.AE5X.AAD7HTl9L2wrq2RmljReSe+H\n===================\n\nSolution?&#x27;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">5</span>Solution: s.AAAO+qBXiJTTaK0jlC9QLDOQlE+eLqJ2cuvjB9Xh6+m49FO/xJpKU+hdTKqF+QKTIlF1pDhU7X3+uSJfkUocg6Pv49kIvWSbuFX7GJg5G4wf+XrZTZCKQcRZMNT9savz2AIKAE4vEYZ3Y5qrj/Uk769dgIGqoa1yC/pkhcRCtBMmS75pFUgsITcvUaJ0j0BZVuLgb+X35Q8uLdC0ktJFX2+O
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">6</span>0 Rin&gt; Your turn!
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">7</span>1 Rin&gt; Your turn!
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">8</span>2 Rin&gt; Your turn!
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">9</span>...
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">10</span>196 Rin&gt; Your turn!
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">11</span>197 Rin&gt; Your turn!
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">12</span>198 Rin&gt; Your turn!
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">13</span>199 Rin&gt; Your turn!
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">14</span>[x] Receiving all data
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">15</span>[x] Receiving all data: 33B
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">16</span>[x] Receiving all data: 195B
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">17</span>[+] Receiving all data: Done (195B)
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">18</span>[*] Closed connection to game-with-rin.challs.csc.tf port 1337
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">19</span>Server&gt; Please choose T
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">20</span>You&gt; T = Rin&gt; You got lucky this time.
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">21</span>Rin&gt; GG Well played!
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">22</span>Rin&gt; I guess I have no choice but to give you the flag.
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">23</span>Rin&gt; CSCTF{I_just_wanted_to_spend_time_with_you_baka!}</code></pre></div></div></main></div><!--$--><!--/$--><!--$--><!--/$--></main><script src="/_next/static/chunks/webpack-50d183473e3f8178.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[87555,[],\"\"]\n3:I[31295,[],\"\"]\n4:I[6874,[\"874\",\"static/chunks/874-c62c375efd21db20.js\",\"319\",\"static/chunks/app/writeups/layout-0d6432ad4376bd82.js\"],\"\"]\n6:I[59665,[],\"MetadataBoundary\"]\n8:I[59665,[],\"OutletBoundary\"]\nb:I[74911,[],\"AsyncMetadataOutlet\"]\nd:I[59665,[],\"ViewportBoundary\"]\nf:I[26614,[],\"\"]\n:HL[\"/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/b41869de3b22c447.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"NtM4hj5y3IN8pkVEe4T_n\",\"p\":\"\",\"c\":[\"\",\"writeups\",\"c7e3e83bb501755bda31683f0d359578\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"writeups\",{\"children\":[[\"id\",\"c7e3e83bb501755bda31683f0d359578\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b41869de3b22c447.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"className\":\"dark scroll-smooth\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}]}],[\"$\",\"body\",null,{\"className\":\"text-dark dark:text-white dark:bg-midnight\",\"style\":{\"fontFamily\":\"'Inter', 'Inter Fallback'\",\"fontStyle\":\"normal\"},\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"h-screen flex items-center justify-center\",\"children\":[\"$\",\"main\",null,{\"className\":\"relative pl-14\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"absolute left-0 top-2 text-5xl text-grapefruit\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],[\"$\",\"h1\",null,{\"className\":\"font-bold text-7xl underline decoration-grapefruit mb-5\",\"children\":\"404.\"}],[\"$\",\"p\",null,{\"children\":\"Your requested page was not found.\"}],[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"font-medium text-inherit\",\"children\":\"Return to home →\"}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"writeups\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"main\",null,{\"className\":\"container pt-20 pb-24\",\"children\":[[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"text-secondary text-sm mb-10 -ml-5 block w-max\",\"children\":\"← Back to home\"}],[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]]}],{\"children\":[[\"id\",\"c7e3e83bb501755bda31683f0d359578\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[\"$\",\"$L6\",null,{\"children\":\"$L7\"}],null,[\"$\",\"$L8\",null,{\"children\":[\"$L9\",\"$La\",[\"$\",\"$Lb\",null,{\"promise\":\"$@c\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"ywJa7Bd_Iaf4kBkemjTXD\",{\"children\":[[\"$\",\"$Ld\",null,{\"children\":\"$Le\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"10:\"$Sreact.suspense\"\n11:I[74911,[],\"AsyncMetadata\"]\n7:[\"$\",\"$10\",null,{\"fallback\":null,\"children\":[\"$\",\"$L11\",null,{\"promise\":\"$@12\"}]}]\n"])</script><script>self.__next_f.push([1,"a:null\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n9:null\n"])</script><script>self.__next_f.push([1,"12:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"kevin.fish\"}]],\"error\":null,\"digest\":\"$undefined\"}\nc:{\"metadata\":\"$12:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"13:I[50674,[\"325\",\"static/chunks/325-8cc74193b249521f.js\",\"134\",\"static/chunks/app/writeups/%5Bid%5D/page-d2275216898ea7fa.js\"],\"default\"]\n14:Tfd7,"])</script><script>self.__next_f.push([1,"from basement_of_rin import NanakuraRin, flag, generate_graph\n\nimport time\nfrom random import Random\n\ndef Server(m):\n\tprint(\"Server\u003e \" + m)\n\ndef Rin(m):\n\tprint(\"Rin\u003e \" + m)\n\ndef check_subset(_subset, set):\n\tsubset = sorted(_subset)\n\tassert len(subset) != 0\n\tfor i in range(len(subset) - 1):\n\t\tsubset[i] \u003c subset[i + 1]\n\tfor x in subset:\n\t\tassert x in set\n\nclass disjoint_set:\n\tdef __init__(self, n):\n\t\tself.n = n\n\t\tself.p = [-1] * self.n\n\tdef root(self, u):\n\t\tif self.p[u] \u003c 0:\n\t\t\treturn u\n\t\tself.p[u] = self.root(self.p[u])\n\t\treturn self.p[u]\n\tdef share(self, u, v):\n\t\treturn self.root(u) == self.root(v)\n\tdef merge(self, u, v):\n\t\tu, v = self.root(u), self.root(v)\n\t\tif u == v:\n\t\t\treturn False\n\t\tif self.p[u] \u003e self.p[v]:\n\t\t\tu, v = v, u\n\t\tself.p[u] += self.p[v]\n\t\tself.p[v] = u\n\t\treturn True\n\tdef clear(self):\n\t\tself.p = [-1] * self.n\n\ndef check_tree(subset, V, edges):\n\tassert len(subset) == V - 1\n\tds = disjoint_set(V)\n\tfor i in subset:\n\t\tassert isinstance(i, int) and 0 \u003c= i \u003c len(edges)\n\t\tu, v, w = edges[i]\n\t\tassert ds.merge(u, v)\n\ndef determine_the_winner(piles):\n\t# https://en.wikipedia.org/wiki/Nim\n\t# Rin-chan is perfect, so she'll always make the optimal move.\n\t# You're perfect too, so you'll always make the perfect move as well.\n\t# Let's fast-forward the game to the end :)\n\tnim = 0\n\tfor x in piles:\n\t\tnim ^= x\n\treturn \"first\" if nim != 0 else \"second\"\n\nclass You:\n\tdef __init__(self, V, edges):\n\t\tServer(f\"{V = }\")\n\t\tServer(f\"{edges = }\")\n\tdef first_move(self):\n\t\tServer(\"Please choose S\")\n\t\treturn sorted(list(map(int, input(\"You\u003e S = \").strip().split(\" \"))))\n\tdef read_first_move(self, S):\n\t\tRin(f\"I choose S = {' '.join([str(i) for i in S])}\")\n\tdef second_move(self):\n\t\tServer(\"Please choose T\")\n\t\treturn sorted(list(map(int, input(\"You\u003e T = \").strip().split(\" \"))))\n\nRin(\"Do you want this flag?\")\nRin(\"I'll consider giving it to you if you defeat me 200 times :)\")\n\ntime.sleep(0.5)\n\nServer(\"-----------------------------------------------------------------------------------------\")\nServer(\"[Round Manual]\")\nServer(\"1. The server generates a set of edges with integer weight on vertices 0 ~ V-1.\")\nServer(\"2. You can either choose to go first or second.\")\nServer(\"3. First player chooses a subset S of edges of size V-1 which forms a tree.\")\nServer(\"( For the definition of tree, see https://en.wikipedia.org/wiki/Tree_(graph_theory) )\")\nServer(\"4. Second player chooses a non-empty subset T of S.\")\nServer(\"5. Add a pile consisting of w stones for each edge (u, v, w) in T.\")\nServer(\"6. Winner of the round is the winner of the nim game on those set of piles.\")\nServer(\"-----------------------------------------------------------------------------------------\")\n\ntime.sleep(0.5)\n\nRin(\"GLHF!\")\n\ntime.sleep(0.5)\n\nfor round_number in range(1, 201):\n\tServer(f\"Round {round_number}\")\n\n\tV, edges = generate_graph(round_number)\n\tassert isinstance(V, int)\n\tassert 30 \u003c= V \u003c= 200\n\tassert len(edges) \u003c= 300\n\tfor u, v, w in edges:\n\t\tassert isinstance(u, int) and isinstance(v, int) and isinstance(w, int)\n\t\tassert 0 \u003c= u \u003c V and 0 \u003c= v \u003c V and 0 \u003c= w \u003c 2**(V-1)\n\n\tfirst, second = You(V, edges), NanakuraRin(V, edges)\n\t\n\tRin(\"Do you want to go [first] or [second]?\")\n\tresp = input(\"You\u003e \").strip()\n\tif resp not in [\"first\", \"second\"]:\n\t\tRin(\"That's not an option \u003e:(\")\n\t\texit(0)\n\n\tif resp == \"first\":\n\t\tRin(\"Sure, you go first :D\")\n\telse:\n\t\tRin(\"Ok, I go first :D\")\n\t\tfirst, second = second, first\n\n\tS = first.first_move()\n\tsecond.read_first_move(S)\n\tcheck_subset(S, [i for i in range(len(edges))])\n\tcheck_tree(S, V, edges)\n\n\tif resp == \"first\":\n\t\tRin(\"My turn!\")\n\telse:\n\t\tRin(\"Your turn!\")\n\n\tT = second.second_move()\n\tcheck_subset(T, S)\n\n\tif resp == \"first\":\n\t\tRin(f\"I choose T = {' '.join([str(i) for i in T])}\")\n\n\twinner = determine_the_winner([edges[i][2] for i in T])\n\n\tr = Random()\n\n\tif winner != resp:\n\t\tRin(r.choice([\"Git gud\", \"Noob\", \"Easy\"]))\n\t\texit(0)\n\n\tRin(r.choice([\"Not like this!\", \"You won :(\", \"Ouch!\", \"You got lucky this time.\"]))\n\nRin(\"GG Well played!\")\nRin(\"I guess I have no choice but to give you the flag.\")\nRin(f\"{flag}\")"])</script><script>self.__next_f.push([1,"15:T49c,[x] Opening connection to game-with-rin.challs.csc.tf on port 1337\n[x] Opening connection to game-with-rin.challs.csc.tf on port 1337: Trying 34.47.157.234\n[+] Opening connection to game-with-rin.challs.csc.tf on port 1337: Done\nb'== proof-of-work: enabled ==\\nplease solve a pow first\\nYou can run the solver with:\\n    python3 \u003c(curl -sSL https://goo.gle/kctf-pow) solve s.AE5X.AAD7HTl9L2wrq2RmljReSe+H\\n===================\\n\\nSolution?'\nSolution: s.AAAO+qBXiJTTaK0jlC9QLDOQlE+eLqJ2cuvjB9Xh6+m49FO/xJpKU+hdTKqF+QKTIlF1pDhU7X3+uSJfkUocg6Pv49kIvWSbuFX7GJg5G4wf+XrZTZCKQcRZMNT9savz2AIKAE4vEYZ3Y5qrj/Uk769dgIGqoa1yC/pkhcRCtBMmS75pFUgsITcvUaJ0j0BZVuLgb+X35Q8uLdC0ktJFX2+O\n0 Rin\u003e Your turn!\n1 Rin\u003e Your turn!\n2 Rin\u003e Your turn!\n...\n196 Rin\u003e Your turn!\n197 Rin\u003e Your turn!\n198 Rin\u003e Your turn!\n199 Rin\u003e Your turn!\n[x] Receiving all data\n[x] Receiving all data: 33B\n[x] Receiving all data: 195B\n[+] Receiving all data: Done (195B)\n[*] Closed connection to game-with-rin.challs.csc.tf port 1337\nServer\u003e Please choose T\nYou\u003e T = Rin\u003e You got lucky this time.\nRin\u003e GG Well played!\nRin\u003e I guess I have no choice but to give you the flag.\nRin\u003e CSCTF{I_just_wanted_to_spend_time_with_you_baka!}"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"children\":[\"$\",\"main\",null,{\"className\":\"max-w-5xl mx-auto text-sm [\u0026_h1]:text-5xl [\u0026_h1]:font-semibold [\u0026_h1]:mb-8 [\u0026_blockquote]:text-secondary [\u0026_blockquote]:space-y-3 [\u0026_blockquote]:border-l-4 [\u0026_blockquote]:border-secondary [\u0026_blockquote]:pl-5 [\u0026_blockquote]:mb-5 [\u0026\u003e_p]:my-3 [\u0026_img]:my-5 [\u0026_ul]:list-disc [\u0026_ul]:pl-6 [\u0026_img]:rounded [\u0026_li]:my-2\",\"children\":[[\"$\",\"h1\",\"h1-0\",{\"children\":\"CyberSpace CTF 2024 — Game with Rin\"}],\"\\n\",[\"$\",\"blockquote\",\"blockquote-0\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"Nanakura Rin, a very skilled gamer, took one of the flags. You need to defeat her 200 times to get the flag back.\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"nc game-with-rin.challs.csc.tf 1337\"}]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"We're given a Python server that looks like this:\"}],\"\\n\",[\"$\",\"$L13\",\"pre-0\",{\"className\":\"my-4\",\"children\":\"$14\",\"language\":\"py\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":\"On paper, the game works as follows:\"}],\"\\n\",[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"The server picks a \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"V\"}],\" and generates random weighted edges between those nodes.\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":\"We choose whether to go first or second.\"}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[\"Player 1 chooses a subset of size \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"V - 1\"}],\" that forms a tree.\"]}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"children\":\"Player 2 chooses a arbitrary (non-empty) subset of player 1's choice.\"}],\"\\n\",[\"$\",\"li\",\"li-4\",{\"children\":[\"This final subset is translated into \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://en.wikipedia.org/wiki/Nim\",\"children\":\"Nim piles\"}],\", and the player who wins Nim wins the round.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":\"Unfortunately, there doesn't seem to be duplicate protection in the subset choosing: we can always go second, and pick the same edge twice to guarantee that XOR of the weights = 0 and we win Nim.\"}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":\"Here's a script that does just that:\"}],\"\\n\",[\"$\",\"$L13\",\"pre-1\",{\"className\":\"my-4\",\"children\":\"import pwn\\n\\nconn = pwn.remote('game-with-rin.challs.csc.tf', 1337)\\n\\n# Solve proof of work\\nres = conn.recvuntil(b'Solution?')\\nprint(res)\\nsol = input('Solution: ')\\nconn.sendline(sol.encode())\\n\\nfor i in range(200):\\n    conn.recvuntil(b'Rin\u003e Do you want to go [first] or [second]?')\\n    conn.sendline(b'second')\\n\\n    conn.recvuntil(b'Rin\u003e I choose S = ')\\n    first = conn.recvline().decode().split(\\\" \\\")[0]\\n    conn.sendline(f'{first} {first}'.encode())\\n\\n    print(i, conn.recvline().strip().decode())\\n\\nprint(conn.recvall().decode())\",\"language\":\"py\"}],\"\\n\",[\"$\",\"$L13\",\"pre-2\",{\"className\":\"my-4\",\"children\":\"$15\",\"language\":\"$undefined\"}]]}]}]\n"])</script></body></html>