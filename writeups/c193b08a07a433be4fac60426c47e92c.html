<!DOCTYPE html><html class="dark scroll-smooth"><head><meta charSet="utf-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="https://gist.github.com/assets/60120929/bbf7f4fc-96b5-4f13-9b4d-a4f418bf2828"/><link rel="stylesheet" href="/_next/static/css/cd9eb1f13d7f01c4.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-50d183473e3f8178.js"/><script src="/_next/static/chunks/4bd1b696-12b3d90ac4ed3802.js" async=""></script><script src="/_next/static/chunks/684-d3c2077e7b7fefb9.js" async=""></script><script src="/_next/static/chunks/main-app-99381da9a4c58049.js" async=""></script><script src="/_next/static/chunks/874-c62c375efd21db20.js" async=""></script><script src="/_next/static/chunks/app/writeups/layout-0d6432ad4376bd82.js" async=""></script><script src="/_next/static/chunks/325-8cc74193b249521f.js" async=""></script><script src="/_next/static/chunks/app/writeups/%5Bid%5D/page-d2275216898ea7fa.js" async=""></script><meta name="next-size-adjust" content=""/><title>kevin.fish</title><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="text-dark dark:text-white dark:bg-midnight" style="font-family:&#x27;Inter&#x27;, &#x27;Inter Fallback&#x27;;font-style:normal"><main class="container pt-20 pb-24"><a class="text-secondary text-sm mb-10 -ml-5 block w-max" href="/">← Back to home</a><div><main class="max-w-5xl mx-auto text-sm [&amp;_h1]:text-5xl [&amp;_h1]:font-semibold [&amp;_h1]:mb-8 [&amp;_blockquote]:text-secondary [&amp;_blockquote]:space-y-3 [&amp;_blockquote]:border-l-4 [&amp;_blockquote]:border-secondary [&amp;_blockquote]:pl-5 [&amp;_blockquote]:mb-5 [&amp;&gt;_p]:my-3 [&amp;_img]:my-5 [&amp;_ul]:list-disc [&amp;_ul]:pl-6 [&amp;_img]:rounded [&amp;_li]:my-2"><h1>bi0sCTF 2024 — A Block and a Hard Place</h1>
<blockquote>
<p>Are you the Far Lands because you&#x27;re a Maze? Or are you a Maze because you&#x27;re the Far Lands?</p>
</blockquote>
<p>We&#x27;re given a terminal prompt that looks like this:</p>
<p><img src="https://gist.github.com/assets/60120929/bbf7f4fc-96b5-4f13-9b4d-a4f418bf2828" alt="image"/></p>
<p>It looks like we&#x27;re blindly navigating some sort of &quot;maze&quot;, with walls blocking regular movement between certain cells.</p>
<p>As a first order of business, we should probably map out what this maze looks like. We can represent each maze position as a 2x2 grid, where the right and bottom two cells represent whether there is a wall to the right or bottom of the cell, respectively:</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">..    .X    ..    .X
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>..    .X    XX    XX</code></pre></div></div>
<p>(we don&#x27;t need to check for left or top walls as we&#x27;ll have already found them when iterating over other positions.)</p>
<p>Then, writing a python script to map out the maze&#x27;s walls, printing one row of the maze at a time,[^1]</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (py)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">import</span><span class=""> pwn
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token keyword">import</span><span class=""> numpy </span><span class="token keyword">as</span><span class=""> np
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">3</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="">conn </span><span class="token operator">=</span><span class=""> pwn</span><span class="token punctuation">.</span><span class="">remote</span><span class="token punctuation">(</span><span class="token string">&#x27;13.201.224.182&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">32545</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">SIZE </span><span class="token operator">=</span><span class=""> </span><span class="token number">36</span><span class=""> </span><span class="token operator">*</span><span class=""> </span><span class="token number">2</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">6</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">7</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">print_buf</span><span class="token punctuation">(</span><span class="">grid</span><span class="token punctuation">:</span><span class=""> np</span><span class="token punctuation">.</span><span class="">ndarray</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">    </span><span class="token keyword">for</span><span class=""> row </span><span class="token keyword">in</span><span class=""> grid</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="">        </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">.</span><span class="">join</span><span class="token punctuation">(</span><span class="token string">&#x27;█&#x27;</span><span class=""> </span><span class="token keyword">if</span><span class=""> e </span><span class="token keyword">else</span><span class=""> </span><span class="token string">&#x27; &#x27;</span><span class=""> </span><span class="token keyword">for</span><span class=""> e </span><span class="token keyword">in</span><span class=""> row</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">11</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">12</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">goto_top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class="">    </span><span class="token keyword">while</span><span class=""> </span><span class="token boolean">True</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;w&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">16</span><span class="">        </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Moved!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">17</span><span class="">            conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;W&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">18</span><span class="">            </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Jumped over a wall!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">19</span><span class="">                </span><span class="token keyword">break</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">20</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">21</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">22</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">goto_left</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">23</span><span class="">    </span><span class="token keyword">while</span><span class=""> </span><span class="token boolean">True</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">24</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;a&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">25</span><span class="">        </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Moved!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">26</span><span class="">            conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;A&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">27</span><span class="">            </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Jumped over a wall!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">28</span><span class="">                </span><span class="token keyword">return</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">29</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">30</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">31</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">check_floor</span><span class="token punctuation">(</span><span class="">x</span><span class="token punctuation">:</span><span class=""> </span><span class="token builtin">int</span><span class="token punctuation">,</span><span class=""> grid</span><span class="token punctuation">:</span><span class=""> np</span><span class="token punctuation">.</span><span class="">ndarray</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">32</span><span class="">    conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;s&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">33</span><span class="">    </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Moved!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">34</span><span class="">        grid</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class=""> x</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token number">1</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">35</span><span class="">        grid</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class=""> x </span><span class="token operator">+</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token number">1</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">36</span><span class="">    </span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">37</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;w&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">38</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">39</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">40</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">map_line_right</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">41</span><span class="">    grid </span><span class="token operator">=</span><span class=""> np</span><span class="token punctuation">.</span><span class="">zeros</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class=""> SIZE</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class=""> dtype</span><span class="token operator">=</span><span class="">np</span><span class="token punctuation">.</span><span class="">uint8</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">42</span><span class="">    x </span><span class="token operator">=</span><span class=""> </span><span class="token number">0</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">43</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">44</span><span class="">    </span><span class="token keyword">while</span><span class=""> </span><span class="token boolean">True</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">45</span><span class="">        check_floor</span><span class="token punctuation">(</span><span class="">x</span><span class="token punctuation">,</span><span class=""> grid</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">46</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">47</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;d&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">48</span><span class="">        </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Moved!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">49</span><span class="">            conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;D&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">50</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">51</span><span class="">            </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Jumped over a wall!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">52</span><span class="">                conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;s&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">53</span><span class="">                print_buf</span><span class="token punctuation">(</span><span class="">grid</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">54</span><span class="">                </span><span class="token keyword">return</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">55</span><span class="">            </span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">56</span><span class="">                grid</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class=""> x </span><span class="token operator">+</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token number">1</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">57</span><span class="">                grid</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class=""> x </span><span class="token operator">+</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token number">1</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">58</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">59</span><span class="">        x </span><span class="token operator">+=</span><span class=""> </span><span class="token number">2</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">60</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">61</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">62</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">map_line_left</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">63</span><span class="">    grid </span><span class="token operator">=</span><span class=""> np</span><span class="token punctuation">.</span><span class="">zeros</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class=""> SIZE</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class=""> dtype</span><span class="token operator">=</span><span class="">np</span><span class="token punctuation">.</span><span class="">uint8</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">64</span><span class="">    x </span><span class="token operator">=</span><span class=""> SIZE
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">65</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">66</span><span class="">    </span><span class="token keyword">while</span><span class=""> </span><span class="token boolean">True</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">67</span><span class="">        check_floor</span><span class="token punctuation">(</span><span class="">x</span><span class="token punctuation">,</span><span class=""> grid</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">68</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">69</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;a&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">70</span><span class="">        </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Moved!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">71</span><span class="">            conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;A&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">72</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">73</span><span class="">            </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Jumped over a wall!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">74</span><span class="">                conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;s&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">75</span><span class="">                print_buf</span><span class="token punctuation">(</span><span class="">grid</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">76</span><span class="">                </span><span class="token keyword">return</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">77</span><span class="">            </span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">78</span><span class="">                grid</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class=""> x </span><span class="token operator">-</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token number">1</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">79</span><span class="">                grid</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class=""> x </span><span class="token operator">-</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">]</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token number">1</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">80</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">81</span><span class="">        x </span><span class="token operator">-=</span><span class=""> </span><span class="token number">2</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">82</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">83</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">84</span><span class="">goto_top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">85</span><span class="">goto_left</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">86</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">87</span><span class=""></span><span class="token comment"># Skip top padding</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">88</span><span class=""></span><span class="token keyword">for</span><span class=""> i </span><span class="token keyword">in</span><span class=""> </span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">89</span><span class="">    conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;s&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">90</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">91</span><span class=""></span><span class="token keyword">for</span><span class=""> i </span><span class="token keyword">in</span><span class=""> </span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class=""> SIZE</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">92</span><span class="">    map_line_right</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">93</span><span class="">    map_line_left</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div></div>
<p>[^1]: A bit sloppy, but we&#x27;re somewhat forced to print the buffer before reading the next line instead of printing it all at the end because traversing the maze takes so long the connection times out (crashing the program) before the entire process is done.</p>
<p>we get</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>        ██████████████  ████  ██    ████  ████████  ██████████████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span>       █             █ █   █ █ █   █   █ █       █ █             █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">4</span>       █  ██████████ █ █  ██ █ █████   █ █  ██████ █  ██████████ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">5</span>       █ █         █ █ █ █   █         █ █ █       █ █         █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">6</span>       █ █  ██████ █ █ █ █  ██  ██████████ █       █ █  ██████ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">7</span>       █ █ █     █ █ █ █ █ █   █       █   █       █ █ █     █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">8</span>       █ █ █     █ █ █ █ ███████      ██   ███  ██ █ █ █     █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">9</span>       █ █ █     █ █ █ █   █         █       █ █ █ █ █ █     █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">10</span>       █ █ █     █ █ █ █   █████  ██ ███  ████ ███ █ █ █     █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">11</span>       █ █ █     █ █ █ █       █ █ █   █ █         █ █ █     █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">12</span>       █ █ ███████ █ █ █████   ███ █   ███         █ █ ███████ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">13</span>       █ █         █ █     █       █               █ █         █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">14</span>       █ ███████████ █  ██ █  ██  ████  ██  ██  ██ █ ███████████ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">15</span>       █             █ █ █ █ █ █ █ █ █ █ █ █ █ █ █ █             █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">16</span>       ███████████████ █ ███ █████████ █ █ █ █████ ███████████████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">17</span>                       █       █ █ █   █ █ █   █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">18</span>          ██  ██  ████ █      ██ █ █  ██ █ █  ████████  ██████████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">19</span>         █ █ █ █ █   █ █     █   █ █ █   █ █ █ █     █ █         █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">20</span>        ██ ███ █ █████ █     █████ █ █  ██ █ ███     ███  ██    ██
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">21</span>       █       █       █           █ █ █   █             █ █   █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">22</span>       █████  ████████ █  ████  ██ █ █ ███ ███████  ██  ██████ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">23</span>           █ █ █     █ █ █   █ █ █ █ █   █       █ █ █ █ █ █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">24</span>          ██ █████████ ███  ██ █████ █████  ████████ ███ █████ ███
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">25</span>         █     █           █     █         █     █         █     █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">26</span>         █  ██████  ██████ █  ██████  ████ █  ██████  ████ █  ████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">27</span>         █ █   █ █ █     █ █ █   █ █ █   █ █ █   █ █ █   █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">28</span>         ███   █ █████  ██ ███   █ ███  ██ ███   █ ███  ██ ███
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">29</span>               █   █ █ █         █     █         █     █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">30</span>            ██ █   ███████    ██ █    ████    ██ █    ████    ██
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">31</span>           █ █ █     █ █ █   █ █ █   █ █ █   █ █ █   █ █ █   █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">32</span>        ██ ███ █    ████ ███ ███ █   █████  ██ █ ███ █████  ██████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">33</span>       █ █     █   █ █     █     █     █   █   █   █   █   █ █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">34</span>       █ █  ██████ ███████ █  ██ ███   █████   ███ █   ███ █ █████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">35</span>       █ █ █   █ █   █   █ █ █ █   █             █ █     █ █   █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">36</span>       ███████████████  ██ █████████  ██████  ██ █ ███████ █  ████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">37</span>         █ █   █ █     █     █ █     █     █ █ █ █         █ █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">38</span>         ███   █ █  ██ ███  ██████  ████   █ ███ █         █ █ ███
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">39</span>               █ █ █ █   █ █ █ █ █ █ █ █   █     █         █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">40</span>            ██████ ███  ██ █ █ █ ███ ███  ████  ██    ██   ███  ██
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">41</span>           █   █       █   █ █ █         █ █ █ █     █ █       █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">42</span>        ██████████████ ███ ███ █  ██  ████ ███ ███████ █████  ████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">43</span>       █   █   █     █   █     █ █ █ █                     █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">44</span>       █████   ███████  ██  ████ █ █ █  ██  ██    ██████   ███ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">45</span>                       █   █     █ █ █ █ █ █ █   █     █       █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">46</span>        ██████████████ █████████ █████ █ █ █████ █  ██ █  ██   ███
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">47</span>       █             █     █   █   █   █ █   █ █ █ █ █ █ █ █     █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">48</span>       █  ██████████ █  ██████ █  ████████  ██ █ █ ███ █ ███    ██
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">49</span>       █ █         █ █ █   █ █ █ █ █   █   █   █ █     █       █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">50</span>       █ █  ██████ █ █ ███ █ █ █ █ █  ████ █   █ ███████      ████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">51</span>       █ █ █     █ █ █   █ █ █ █ █ █ █ █ █ █   █             █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">52</span>       █ █ █     █ █ █  ██████ █ █████ ███ █  ████  ██    ██ █████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">53</span>       █ █ █     █ █ █ █ █ █   █   █       █ █ █ █ █ █   █ █   █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">54</span>       █ █ █     █ █ █ ███ █  ████ █  ██  ██ ███████████ ███  ████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">55</span>       █ █ █     █ █ █     █ █ █ █ █ █ █ █     █ █ █ █ █     █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">56</span>       █ █ ███████ █ █  ██ █████ █ █ █ █ ███  ██ █████ █     █████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">57</span>       █ █         █ █ █ █   █   █ █ █ █   █ █     █   █       █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">58</span>       █ ███████████ █ █████ █████████ █   █ █  ██ █   ███  ████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">59</span>       █             █   █ █     █ █   █   █ █ █ █ █     █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">60</span>       ███████████████   ███     ███   █████ ███ ███     ███</code></pre></div></div>
<p>Looks a bit like a QR code, doesn&#x27;t it? 🤔</p>
<p>First, though, we need to fix up all of the top-left corners which got messed up by the traversal algorithm. Doing so yields</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>       ███████████████ █████ ███   █████ █████████ ███████████████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span>       █             █ █   █ █ █   █   █ █       █ █             █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">4</span>       █ ███████████ █ █ ███ █ █████   █ █ ███████ █ ███████████ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">5</span>       █ █         █ █ █ █   █         █ █ █       █ █         █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">6</span>       █ █ ███████ █ █ █ █ ███ ███████████ █       █ █ ███████ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">7</span>       █ █ █     █ █ █ █ █ █   █       █   █       █ █ █     █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">8</span>       █ █ █     █ █ █ █ ███████     ███   ███ ███ █ █ █     █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">9</span>       █ █ █     █ █ █ █   █         █       █ █ █ █ █ █     █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">10</span>       █ █ █     █ █ █ █   █████ ███ ███ █████ ███ █ █ █     █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">11</span>       █ █ █     █ █ █ █       █ █ █   █ █         █ █ █     █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">12</span>       █ █ ███████ █ █ █████   ███ █   ███         █ █ ███████ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">13</span>       █ █         █ █     █       █               █ █         █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">14</span>       █ ███████████ █ ███ █ ███ █████ ███ ███ ███ █ ███████████ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">15</span>       █             █ █ █ █ █ █ █ █ █ █ █ █ █ █ █ █             █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">16</span>       ███████████████ █ ███ █████████ █ █ █ █████ ███████████████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">17</span>                       █       █ █ █   █ █ █   █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">18</span>         ███ ███ █████ █     ███ █ █ ███ █ █ █████████ ███████████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">19</span>         █ █ █ █ █   █ █     █   █ █ █   █ █ █ █     █ █         █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">20</span>       ███ ███ █ █████ █     █████ █ █ ███ █ ███     ███ ███   ███
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">21</span>       █       █       █           █ █ █   █             █ █   █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">22</span>       █████ █████████ █ █████ ███ █ █ ███ ███████ ███ ███████ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">23</span>           █ █ █     █ █ █   █ █ █ █ █   █       █ █ █ █ █ █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">24</span>         ███ █████████ ███ ███ █████ █████ █████████ ███ █████ ███
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">25</span>         █     █           █     █         █     █         █     █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">26</span>         █ ███████ ███████ █ ███████ █████ █ ███████ █████ █ █████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">27</span>         █ █   █ █ █     █ █ █   █ █ █   █ █ █   █ █ █   █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">28</span>         ███   █ █████ ███ ███   █ ███ ███ ███   █ ███ ███ ███
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">29</span>               █   █ █ █         █     █         █     █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">30</span>           ███ █   ███████   ███ █   █████   ███ █   █████   ███
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">31</span>           █ █ █     █ █ █   █ █ █   █ █ █   █ █ █   █ █ █   █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">32</span>       ███ ███ █   █████ ███ ███ █   █████ ███ █ ███ █████ ███████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">33</span>       █ █     █   █ █     █     █     █   █   █   █   █   █ █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">34</span>       █ █ ███████ ███████ █ ███ ███   █████   ███ █   ███ █ █████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">35</span>       █ █ █   █ █   █   █ █ █ █   █             █ █     █ █   █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">36</span>       ███████████████ ███ █████████ ███████ ███ █ ███████ █ █████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">37</span>         █ █   █ █     █     █ █     █     █ █ █ █         █ █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">38</span>         ███   █ █ ███ ███ ███████ █████   █ ███ █         █ █ ███
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">39</span>               █ █ █ █   █ █ █ █ █ █ █ █   █     █         █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">40</span>           ███████ ███ ███ █ █ █ ███ ███ █████ ███   ███   ███ ███
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">41</span>           █   █       █   █ █ █         █ █ █ █     █ █       █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">42</span>       ███████████████ ███ ███ █ ███ █████ ███ ███████ █████ █████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">43</span>       █   █   █     █   █     █ █ █ █                     █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">44</span>       █████   ███████ ███ █████ █ █ █ ███ ███   ███████   ███ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">45</span>                       █   █     █ █ █ █ █ █ █   █     █       █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">46</span>       ███████████████ █████████ █████ █ █ █████ █ ███ █ ███   ███
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">47</span>       █             █     █   █   █   █ █   █ █ █ █ █ █ █ █     █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">48</span>       █ ███████████ █ ███████ █ █████████ ███ █ █ ███ █ ███   ███
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">49</span>       █ █         █ █ █   █ █ █ █ █   █   █   █ █     █       █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">50</span>       █ █ ███████ █ █ ███ █ █ █ █ █ █████ █   █ ███████     █████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">51</span>       █ █ █     █ █ █   █ █ █ █ █ █ █ █ █ █   █             █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">52</span>       █ █ █     █ █ █ ███████ █ █████ ███ █ █████ ███   ███ █████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">53</span>       █ █ █     █ █ █ █ █ █   █   █       █ █ █ █ █ █   █ █   █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">54</span>       █ █ █     █ █ █ ███ █ █████ █ ███ ███ ███████████ ███ █████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">55</span>       █ █ █     █ █ █     █ █ █ █ █ █ █ █     █ █ █ █ █     █ █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">56</span>       █ █ ███████ █ █ ███ █████ █ █ █ █ ███ ███ █████ █     █████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">57</span>       █ █         █ █ █ █   █   █ █ █ █   █ █     █   █       █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">58</span>       █ ███████████ █ █████ █████████ █   █ █ ███ █   ███ █████
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">59</span>       █             █   █ █     █ █   █   █ █ █ █ █     █ █
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">60</span>       ███████████████   ███     ███   █████ ███ ███     ███</code></pre></div></div>
<p>Resizing the image in Photoshop to make the corner boxes more square-like, we get an interesting pattern that looks like this:</p>
<!-- -->&lt;p align=&quot;center&quot;&gt;
  &lt;img src=&quot;https://gist.github.com/assets/60120929/e9d7885e-0836-4e5e-958b-653ec5ae846d&quot; width=&quot;600px&quot;&gt;
&lt;/p&gt;<!-- -->
<p>The key realization here is that the corners of a valid QR code should consist of a single ring around solid block of black:</p>
<!-- -->&lt;p align=&quot;center&quot;&gt;
  &lt;img src=&quot;https://gist.github.com/assets/60120929/7414e9dd-0823-4118-9d52-f0fd287e7489&quot; width=&quot;300px&quot;&gt;
&lt;/p&gt;<!-- -->
<p>Because the walls lie <em>between</em> cells, it&#x27;s clear now that the walls of the maze separate regions of different color in the QR code. Then, this challenge turns into a sort of &quot;A/B coloring&quot; problem solvable with the following routine:</p>
<ol>
<li>Keep a state tracking the current &quot;color&quot;: white/black (or filled/unfilled)</li>
<li>Iterate over all cells, painting each cell the current color.</li>
<li>When the program hits a wall in the maze while iterating, swap the current color.</li>
</ol>
<p>Modifying our traversal script with the given algorithm,</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (py)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">import</span><span class=""> pwn
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">conn </span><span class="token operator">=</span><span class=""> pwn</span><span class="token punctuation">.</span><span class="">remote</span><span class="token punctuation">(</span><span class="token string">&#x27;13.201.224.182&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">32323</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="">fill </span><span class="token operator">=</span><span class=""> </span><span class="token boolean">False</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">5</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">6</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">goto_top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="">    </span><span class="token keyword">while</span><span class=""> </span><span class="token boolean">True</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;w&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="">        </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Moved!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class="">            conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;W&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class="">            </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Jumped over a wall!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class="">                </span><span class="token keyword">break</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">14</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">15</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">16</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">goto_left</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">17</span><span class="">    </span><span class="token keyword">while</span><span class=""> </span><span class="token boolean">True</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">18</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;a&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">19</span><span class="">        </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Moved!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">20</span><span class="">            conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;A&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">21</span><span class="">            </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Jumped over a wall!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">22</span><span class="">                </span><span class="token keyword">return</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">23</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">24</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">25</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">map_line_right</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class=""> </span><span class="token builtin">str</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">26</span><span class="">    </span><span class="token keyword">global</span><span class=""> fill
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">27</span><span class="">    ret </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">28</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">29</span><span class="">    </span><span class="token keyword">while</span><span class=""> </span><span class="token boolean">True</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">30</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;d&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">31</span><span class="">        ret </span><span class="token operator">+=</span><span class=""> </span><span class="token string">&#x27;█&#x27;</span><span class=""> </span><span class="token keyword">if</span><span class=""> fill </span><span class="token keyword">else</span><span class=""> </span><span class="token string">&#x27; &#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">32</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">33</span><span class="">        </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Moved!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">34</span><span class="">            conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;D&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">35</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">36</span><span class="">            </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Jumped over a wall!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">37</span><span class="">                conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;s&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">38</span><span class="">                </span><span class="token keyword">return</span><span class=""> ret
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">39</span><span class="">            </span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">40</span><span class="">                fill </span><span class="token operator">=</span><span class=""> </span><span class="token keyword">not</span><span class=""> fill
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">41</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">42</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">43</span><span class=""></span><span class="token keyword">def</span><span class=""> </span><span class="token function">map_line_left</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class=""> </span><span class="token builtin">str</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">44</span><span class="">    </span><span class="token keyword">global</span><span class=""> fill
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">45</span><span class="">    ret </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">46</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">47</span><span class="">    </span><span class="token keyword">while</span><span class=""> </span><span class="token boolean">True</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">48</span><span class="">        conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;a&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">49</span><span class="">        ret </span><span class="token operator">+=</span><span class=""> </span><span class="token string">&#x27;█&#x27;</span><span class=""> </span><span class="token keyword">if</span><span class=""> fill </span><span class="token keyword">else</span><span class=""> </span><span class="token string">&#x27; &#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">50</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">51</span><span class="">        </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Moved!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">52</span><span class="">            conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;A&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">53</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">54</span><span class="">            </span><span class="token keyword">if</span><span class=""> conn</span><span class="token punctuation">.</span><span class="">recvline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">!=</span><span class=""> </span><span class="token string">&#x27;Jumped over a wall!&#x27;</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">55</span><span class="">                conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;s&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">56</span><span class="">                </span><span class="token keyword">return</span><span class=""> ret</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">57</span><span class="">            </span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">58</span><span class="">                fill </span><span class="token operator">=</span><span class=""> </span><span class="token keyword">not</span><span class=""> fill
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">59</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">60</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">61</span><span class="">goto_top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">62</span><span class="">goto_left</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">63</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">64</span><span class=""></span><span class="token comment"># Skip top padding</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">65</span><span class=""></span><span class="token keyword">for</span><span class=""> i </span><span class="token keyword">in</span><span class=""> </span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">66</span><span class="">    conn</span><span class="token punctuation">.</span><span class="">sendlineafter</span><span class="token punctuation">(</span><span class="token string">b&#x27;&gt; &#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">b&#x27;s&#x27;</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">67</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">68</span><span class=""></span><span class="token keyword">while</span><span class=""> </span><span class="token boolean">True</span><span class="token punctuation">:</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">69</span><span class="">    </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">map_line_right</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">70</span><span class="">    </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">map_line_left</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div></div>
<p>we get</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">    ███████ ██ █  ██ ████ ███████    
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>    █     █ █  █████ █    █     █    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span>    █ ███ █ █ ██    ██    █ ███ █    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">4</span>    █ ███ █ ██     ████ █ █ ███ █    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">5</span>    █ ███ █ ████ █  █     █ ███ █    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">6</span>    █     █   ████        █     █    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">7</span>    ███████ █ █ █ █ █ █ █ ███████    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">8</span>            ████ █  █ ██             
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">9</span>     █ █ ██ ███  █ ██ █ ███ █████    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">10</span>    ████    ██████ █  ███████ ██     
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">11</span>      █ ███ █  █ █ ██    █ █ █ █     
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">12</span>     ███      ███     ███     ███    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">13</span>     █  █ ███ █  █ ██ █  █ ██ █      
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">14</span>        ██ █     ███     ███         
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">15</span>      █ ███ █  █ ██ █  █ ██ █  █     
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">16</span>    █   ██ ███   ███  ██  ██  █ █    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">17</span>    █ ██ ██  █ █  ███████ ███ ██     
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">18</span>     █  █   ███ ███   █ █     █ █    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">19</span>        █ █  █ █ █ █  ███     █      
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">20</span>      ██    ██ █     █ █   █    █    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">21</span>    ██  ███  ███ █ ███████████ █     
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">22</span>            ██   █ █ █ ██   ████     
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">23</span>    ███████   ██  ██ ██ █ █ █ ███    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">24</span>    █     █ ██ █ █  ██  █   ████     
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">25</span>    █ ███ █  █ █ █ █ █  ███████ █    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">26</span>    █ ███ █ █ ██  ████ █ █ ██ ██     
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">27</span>    █ ███ █   █ █ █ █   █ █ ███ █    
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">28</span>    █     █ █  ██ █ ██ ███  ████     
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">29</span>    ███████  █   █  ██ █ █   █       </code></pre></div></div>
<!-- -->&lt;p align=&quot;center&quot;&gt;
  &lt;img src=&quot;https://gist.github.com/assets/60120929/e7c4c59c-33cb-406d-af9a-7e42e7b24df8&quot; width=&quot;400px&quot;&gt;
&lt;/p&gt;<!-- -->
<p>which we can scan to get the flag.</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">bi0sctf{cZrfONl+bGtGiKWMnnR5Sg==}</span></code></pre></div></div></main></div><!--$--><!--/$--><!--$--><!--/$--></main><script src="/_next/static/chunks/webpack-50d183473e3f8178.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[87555,[],\"\"]\n3:I[31295,[],\"\"]\n4:I[6874,[\"874\",\"static/chunks/874-c62c375efd21db20.js\",\"319\",\"static/chunks/app/writeups/layout-0d6432ad4376bd82.js\"],\"\"]\n6:I[59665,[],\"MetadataBoundary\"]\n8:I[59665,[],\"OutletBoundary\"]\nb:I[74911,[],\"AsyncMetadataOutlet\"]\nd:I[59665,[],\"ViewportBoundary\"]\nf:I[26614,[],\"\"]\n:HL[\"/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/cd9eb1f13d7f01c4.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"szKQotZwTHi_mCbYcI59p\",\"p\":\"\",\"c\":[\"\",\"writeups\",\"c193b08a07a433be4fac60426c47e92c\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"writeups\",{\"children\":[[\"id\",\"c193b08a07a433be4fac60426c47e92c\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/cd9eb1f13d7f01c4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"className\":\"dark scroll-smooth\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}]}],[\"$\",\"body\",null,{\"className\":\"text-dark dark:text-white dark:bg-midnight\",\"style\":{\"fontFamily\":\"'Inter', 'Inter Fallback'\",\"fontStyle\":\"normal\"},\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"h-screen flex items-center justify-center\",\"children\":[\"$\",\"main\",null,{\"className\":\"relative pl-14\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"absolute left-0 top-2 text-5xl text-grapefruit\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],[\"$\",\"h1\",null,{\"className\":\"font-bold text-7xl underline decoration-grapefruit mb-5\",\"children\":\"404.\"}],[\"$\",\"p\",null,{\"children\":\"Your requested page was not found.\"}],[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"font-medium text-inherit\",\"children\":\"Return to home →\"}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"writeups\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"main\",null,{\"className\":\"container pt-20 pb-24\",\"children\":[[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"text-secondary text-sm mb-10 -ml-5 block w-max\",\"children\":\"← Back to home\"}],[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]]}],{\"children\":[[\"id\",\"c193b08a07a433be4fac60426c47e92c\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[\"$\",\"$L6\",null,{\"children\":\"$L7\"}],null,[\"$\",\"$L8\",null,{\"children\":[\"$L9\",\"$La\",[\"$\",\"$Lb\",null,{\"promise\":\"$@c\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"gHYohj_Y3by8CHgMEJoDK\",{\"children\":[[\"$\",\"$Ld\",null,{\"children\":\"$Le\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"10:\"$Sreact.suspense\"\n11:I[74911,[],\"AsyncMetadata\"]\n7:[\"$\",\"$10\",null,{\"fallback\":null,\"children\":[\"$\",\"$L11\",null,{\"promise\":\"$@12\"}]}]\n"])</script><script>self.__next_f.push([1,"a:null\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n9:null\n"])</script><script>self.__next_f.push([1,"12:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"kevin.fish\"}]],\"error\":null,\"digest\":\"$undefined\"}\nc:{\"metadata\":\"$12:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"13:I[50674,[\"325\",\"static/chunks/325-8cc74193b249521f.js\",\"134\",\"static/chunks/app/writeups/%5Bid%5D/page-d2275216898ea7fa.js\"],\"default\"]\n14:T8cc,"])</script><script>self.__next_f.push([1,"import pwn\nimport numpy as np\n\nconn = pwn.remote('13.201.224.182', 32545)\nSIZE = 36 * 2\n\n\ndef print_buf(grid: np.ndarray):\n    for row in grid:\n        print(''.join('█' if e else ' ' for e in row))\n\n\ndef goto_top():\n    while True:\n        conn.sendlineafter(b'\u003e ', b'w')\n        if conn.recvline().decode().strip() != 'Moved!':\n            conn.sendlineafter(b'\u003e ', b'W')\n            if conn.recvline().decode().strip() != 'Jumped over a wall!':\n                break\n\n\ndef goto_left():\n    while True:\n        conn.sendlineafter(b'\u003e ', b'a')\n        if conn.recvline().decode().strip() != 'Moved!':\n            conn.sendlineafter(b'\u003e ', b'A')\n            if conn.recvline().decode().strip() != 'Jumped over a wall!':\n                return\n\n\ndef check_floor(x: int, grid: np.ndarray):\n    conn.sendlineafter(b'\u003e ', b's')\n    if conn.recvline().decode().strip() != 'Moved!':\n        grid[1, x] = 1\n        grid[1, x + 1] = 1\n    else:\n        conn.sendlineafter(b'\u003e ', b'w')\n\n\ndef map_line_right():\n    grid = np.zeros((2, SIZE), dtype=np.uint8)\n    x = 0\n\n    while True:\n        check_floor(x, grid)\n\n        conn.sendlineafter(b'\u003e ', b'd')\n        if conn.recvline().decode().strip() != 'Moved!':\n            conn.sendlineafter(b'\u003e ', b'D')\n\n            if conn.recvline().decode().strip() != 'Jumped over a wall!':\n                conn.sendlineafter(b'\u003e ', b's')\n                print_buf(grid)\n                return\n            else:\n                grid[0, x + 1] = 1\n                grid[1, x + 1] = 1\n\n        x += 2\n\n\ndef map_line_left():\n    grid = np.zeros((2, SIZE), dtype=np.uint8)\n    x = SIZE\n\n    while True:\n        check_floor(x, grid)\n\n        conn.sendlineafter(b'\u003e ', b'a')\n        if conn.recvline().decode().strip() != 'Moved!':\n            conn.sendlineafter(b'\u003e ', b'A')\n\n            if conn.recvline().decode().strip() != 'Jumped over a wall!':\n                conn.sendlineafter(b'\u003e ', b's')\n                print_buf(grid)\n                return\n            else:\n                grid[0, x - 1] = 1\n                grid[1, x - 1] = 1\n\n        x -= 2\n\n\ngoto_top()\ngoto_left()\n\n# Skip top padding\nfor i in range(3):\n    conn.sendlineafter(b'\u003e ', b's')\n\nfor i in range(0, SIZE, 2):\n    map_line_right()\n    map_line_left()"])</script><script>self.__next_f.push([1,"15:T1b71,"])</script><script>self.__next_f.push([1,"\n        ██████████████  ████  ██    ████  ████████  ██████████████\n       █             █ █   █ █ █   █   █ █       █ █             █\n       █  ██████████ █ █  ██ █ █████   █ █  ██████ █  ██████████ █\n       █ █         █ █ █ █   █         █ █ █       █ █         █ █\n       █ █  ██████ █ █ █ █  ██  ██████████ █       █ █  ██████ █ █\n       █ █ █     █ █ █ █ █ █   █       █   █       █ █ █     █ █ █\n       █ █ █     █ █ █ █ ███████      ██   ███  ██ █ █ █     █ █ █\n       █ █ █     █ █ █ █   █         █       █ █ █ █ █ █     █ █ █\n       █ █ █     █ █ █ █   █████  ██ ███  ████ ███ █ █ █     █ █ █\n       █ █ █     █ █ █ █       █ █ █   █ █         █ █ █     █ █ █\n       █ █ ███████ █ █ █████   ███ █   ███         █ █ ███████ █ █\n       █ █         █ █     █       █               █ █         █ █\n       █ ███████████ █  ██ █  ██  ████  ██  ██  ██ █ ███████████ █\n       █             █ █ █ █ █ █ █ █ █ █ █ █ █ █ █ █             █\n       ███████████████ █ ███ █████████ █ █ █ █████ ███████████████\n                       █       █ █ █   █ █ █   █\n          ██  ██  ████ █      ██ █ █  ██ █ █  ████████  ██████████\n         █ █ █ █ █   █ █     █   █ █ █   █ █ █ █     █ █         █\n        ██ ███ █ █████ █     █████ █ █  ██ █ ███     ███  ██    ██\n       █       █       █           █ █ █   █             █ █   █\n       █████  ████████ █  ████  ██ █ █ ███ ███████  ██  ██████ █\n           █ █ █     █ █ █   █ █ █ █ █   █       █ █ █ █ █ █ █ █\n          ██ █████████ ███  ██ █████ █████  ████████ ███ █████ ███\n         █     █           █     █         █     █         █     █\n         █  ██████  ██████ █  ██████  ████ █  ██████  ████ █  ████\n         █ █   █ █ █     █ █ █   █ █ █   █ █ █   █ █ █   █ █ █\n         ███   █ █████  ██ ███   █ ███  ██ ███   █ ███  ██ ███\n               █   █ █ █         █     █         █     █\n            ██ █   ███████    ██ █    ████    ██ █    ████    ██\n           █ █ █     █ █ █   █ █ █   █ █ █   █ █ █   █ █ █   █ █\n        ██ ███ █    ████ ███ ███ █   █████  ██ █ ███ █████  ██████\n       █ █     █   █ █     █     █     █   █   █   █   █   █ █ █ █\n       █ █  ██████ ███████ █  ██ ███   █████   ███ █   ███ █ █████\n       █ █ █   █ █   █   █ █ █ █   █             █ █     █ █   █\n       ███████████████  ██ █████████  ██████  ██ █ ███████ █  ████\n         █ █   █ █     █     █ █     █     █ █ █ █         █ █ █ █\n         ███   █ █  ██ ███  ██████  ████   █ ███ █         █ █ ███\n               █ █ █ █   █ █ █ █ █ █ █ █   █     █         █ █\n            ██████ ███  ██ █ █ █ ███ ███  ████  ██    ██   ███  ██\n           █   █       █   █ █ █         █ █ █ █     █ █       █ █\n        ██████████████ ███ ███ █  ██  ████ ███ ███████ █████  ████\n       █   █   █     █   █     █ █ █ █                     █ █ █\n       █████   ███████  ██  ████ █ █ █  ██  ██    ██████   ███ █\n                       █   █     █ █ █ █ █ █ █   █     █       █\n        ██████████████ █████████ █████ █ █ █████ █  ██ █  ██   ███\n       █             █     █   █   █   █ █   █ █ █ █ █ █ █ █     █\n       █  ██████████ █  ██████ █  ████████  ██ █ █ ███ █ ███    ██\n       █ █         █ █ █   █ █ █ █ █   █   █   █ █     █       █\n       █ █  ██████ █ █ ███ █ █ █ █ █  ████ █   █ ███████      ████\n       █ █ █     █ █ █   █ █ █ █ █ █ █ █ █ █   █             █ █ █\n       █ █ █     █ █ █  ██████ █ █████ ███ █  ████  ██    ██ █████\n       █ █ █     █ █ █ █ █ █   █   █       █ █ █ █ █ █   █ █   █\n       █ █ █     █ █ █ ███ █  ████ █  ██  ██ ███████████ ███  ████\n       █ █ █     █ █ █     █ █ █ █ █ █ █ █     █ █ █ █ █     █ █ █\n       █ █ ███████ █ █  ██ █████ █ █ █ █ ███  ██ █████ █     █████\n       █ █         █ █ █ █   █   █ █ █ █   █ █     █   █       █\n       █ ███████████ █ █████ █████████ █   █ █  ██ █   ███  ████\n       █             █   █ █     █ █   █   █ █ █ █ █     █ █\n       ███████████████   ███     ███   █████ ███ ███     ███"])</script><script>self.__next_f.push([1,"16:T1c4d,"])</script><script>self.__next_f.push([1,"\n       ███████████████ █████ ███   █████ █████████ ███████████████\n       █             █ █   █ █ █   █   █ █       █ █             █\n       █ ███████████ █ █ ███ █ █████   █ █ ███████ █ ███████████ █\n       █ █         █ █ █ █   █         █ █ █       █ █         █ █\n       █ █ ███████ █ █ █ █ ███ ███████████ █       █ █ ███████ █ █\n       █ █ █     █ █ █ █ █ █   █       █   █       █ █ █     █ █ █\n       █ █ █     █ █ █ █ ███████     ███   ███ ███ █ █ █     █ █ █\n       █ █ █     █ █ █ █   █         █       █ █ █ █ █ █     █ █ █\n       █ █ █     █ █ █ █   █████ ███ ███ █████ ███ █ █ █     █ █ █\n       █ █ █     █ █ █ █       █ █ █   █ █         █ █ █     █ █ █\n       █ █ ███████ █ █ █████   ███ █   ███         █ █ ███████ █ █\n       █ █         █ █     █       █               █ █         █ █\n       █ ███████████ █ ███ █ ███ █████ ███ ███ ███ █ ███████████ █\n       █             █ █ █ █ █ █ █ █ █ █ █ █ █ █ █ █             █\n       ███████████████ █ ███ █████████ █ █ █ █████ ███████████████\n                       █       █ █ █   █ █ █   █\n         ███ ███ █████ █     ███ █ █ ███ █ █ █████████ ███████████\n         █ █ █ █ █   █ █     █   █ █ █   █ █ █ █     █ █         █\n       ███ ███ █ █████ █     █████ █ █ ███ █ ███     ███ ███   ███\n       █       █       █           █ █ █   █             █ █   █\n       █████ █████████ █ █████ ███ █ █ ███ ███████ ███ ███████ █\n           █ █ █     █ █ █   █ █ █ █ █   █       █ █ █ █ █ █ █ █\n         ███ █████████ ███ ███ █████ █████ █████████ ███ █████ ███\n         █     █           █     █         █     █         █     █\n         █ ███████ ███████ █ ███████ █████ █ ███████ █████ █ █████\n         █ █   █ █ █     █ █ █   █ █ █   █ █ █   █ █ █   █ █ █\n         ███   █ █████ ███ ███   █ ███ ███ ███   █ ███ ███ ███\n               █   █ █ █         █     █         █     █\n           ███ █   ███████   ███ █   █████   ███ █   █████   ███\n           █ █ █     █ █ █   █ █ █   █ █ █   █ █ █   █ █ █   █ █\n       ███ ███ █   █████ ███ ███ █   █████ ███ █ ███ █████ ███████\n       █ █     █   █ █     █     █     █   █   █   █   █   █ █ █ █\n       █ █ ███████ ███████ █ ███ ███   █████   ███ █   ███ █ █████\n       █ █ █   █ █   █   █ █ █ █   █             █ █     █ █   █\n       ███████████████ ███ █████████ ███████ ███ █ ███████ █ █████\n         █ █   █ █     █     █ █     █     █ █ █ █         █ █ █ █\n         ███   █ █ ███ ███ ███████ █████   █ ███ █         █ █ ███\n               █ █ █ █   █ █ █ █ █ █ █ █   █     █         █ █\n           ███████ ███ ███ █ █ █ ███ ███ █████ ███   ███   ███ ███\n           █   █       █   █ █ █         █ █ █ █     █ █       █ █\n       ███████████████ ███ ███ █ ███ █████ ███ ███████ █████ █████\n       █   █   █     █   █     █ █ █ █                     █ █ █\n       █████   ███████ ███ █████ █ █ █ ███ ███   ███████   ███ █\n                       █   █     █ █ █ █ █ █ █   █     █       █\n       ███████████████ █████████ █████ █ █ █████ █ ███ █ ███   ███\n       █             █     █   █   █   █ █   █ █ █ █ █ █ █ █     █\n       █ ███████████ █ ███████ █ █████████ ███ █ █ ███ █ ███   ███\n       █ █         █ █ █   █ █ █ █ █   █   █   █ █     █       █\n       █ █ ███████ █ █ ███ █ █ █ █ █ █████ █   █ ███████     █████\n       █ █ █     █ █ █   █ █ █ █ █ █ █ █ █ █   █             █ █ █\n       █ █ █     █ █ █ ███████ █ █████ ███ █ █████ ███   ███ █████\n       █ █ █     █ █ █ █ █ █   █   █       █ █ █ █ █ █   █ █   █\n       █ █ █     █ █ █ ███ █ █████ █ ███ ███ ███████████ ███ █████\n       █ █ █     █ █ █     █ █ █ █ █ █ █ █     █ █ █ █ █     █ █ █\n       █ █ ███████ █ █ ███ █████ █ █ █ █ ███ ███ █████ █     █████\n       █ █         █ █ █ █   █   █ █ █ █   █ █     █   █       █\n       █ ███████████ █ █████ █████████ █   █ █ ███ █   ███ █████\n       █             █   █ █     █ █   █   █ █ █ █ █     █ █\n       ███████████████   ███     ███   █████ ███ ███     ███"])</script><script>self.__next_f.push([1,"17:T6a2,import pwn\n\nconn = pwn.remote('13.201.224.182', 32323)\nfill = False\n\n\ndef goto_top():\n    while True:\n        conn.sendlineafter(b'\u003e ', b'w')\n        if conn.recvline().decode().strip() != 'Moved!':\n            conn.sendlineafter(b'\u003e ', b'W')\n            if conn.recvline().decode().strip() != 'Jumped over a wall!':\n                break\n\n\ndef goto_left():\n    while True:\n        conn.sendlineafter(b'\u003e ', b'a')\n        if conn.recvline().decode().strip() != 'Moved!':\n            conn.sendlineafter(b'\u003e ', b'A')\n            if conn.recvline().decode().strip() != 'Jumped over a wall!':\n                return\n\n\ndef map_line_right() -\u003e str:\n    global fill\n    ret = ''\n\n    while True:\n        conn.sendlineafter(b'\u003e ', b'd')\n        ret += '█' if fill else ' '\n\n        if conn.recvline().decode().strip() != 'Moved!':\n            conn.sendlineafter(b'\u003e ', b'D')\n\n            if conn.recvline().decode().strip() != 'Jumped over a wall!':\n                conn.sendlineafter(b'\u003e ', b's')\n                return ret\n            else:\n                fill = not fill\n\n\ndef map_line_left() -\u003e str:\n    global fill\n    ret = ''\n\n    while True:\n        conn.sendlineafter(b'\u003e ', b'a')\n        ret += '█' if fill else ' '\n\n        if conn.recvline().decode().strip() != 'Moved!':\n            conn.sendlineafter(b'\u003e ', b'A')\n\n            if conn.recvline().decode().strip() != 'Jumped over a wall!':\n                conn.sendlineafter(b'\u003e ', b's')\n                return ret[::-1]\n            else:\n                fill = not fill\n\n\ngoto_top()\ngoto_left()\n\n# Skip top padding\nfor i in range(4):\n    conn.sendlineafter(b'\u003e ', b's')\n\nwhile True:\n    print(map_line_right())\n    print(map_line_left())18:T7a7,    ███████ ██ █  ██ ████ ███████    \n    █     █ █  █████ █    █     █    \n    █ ███ █ █ ██    ██    █ ███ █    \n    █ ███ █ ██     ████ █ █ ███ █    \n    █ ███ █ ████ █  █     "])</script><script>self.__next_f.push([1,"█ ███ █    \n    █     █   ████        █     █    \n    ███████ █ █ █ █ █ █ █ ███████    \n            ████ █  █ ██             \n     █ █ ██ ███  █ ██ █ ███ █████    \n    ████    ██████ █  ███████ ██     \n      █ ███ █  █ █ ██    █ █ █ █     \n     ███      ███     ███     ███    \n     █  █ ███ █  █ ██ █  █ ██ █      \n        ██ █     ███     ███         \n      █ ███ █  █ ██ █  █ ██ █  █     \n    █   ██ ███   ███  ██  ██  █ █    \n    █ ██ ██  █ █  ███████ ███ ██     \n     █  █   ███ ███   █ █     █ █    \n        █ █  █ █ █ █  ███     █      \n      ██    ██ █     █ █   █    █    \n    ██  ███  ███ █ ███████████ █     \n            ██   █ █ █ ██   ████     \n    ███████   ██  ██ ██ █ █ █ ███    \n    █     █ ██ █ █  ██  █   ████     \n    █ ███ █  █ █ █ █ █  ███████ █    \n    █ ███ █ █ ██  ████ █ █ ██ ██     \n    █ ███ █   █ █ █ █   █ █ ███ █    \n    █     █ █  ██ █ ██ ███  ████     \n    ███████  █   █  ██ █ █   █       "])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"children\":[\"$\",\"main\",null,{\"className\":\"max-w-5xl mx-auto text-sm [\u0026_h1]:text-5xl [\u0026_h1]:font-semibold [\u0026_h1]:mb-8 [\u0026_blockquote]:text-secondary [\u0026_blockquote]:space-y-3 [\u0026_blockquote]:border-l-4 [\u0026_blockquote]:border-secondary [\u0026_blockquote]:pl-5 [\u0026_blockquote]:mb-5 [\u0026\u003e_p]:my-3 [\u0026_img]:my-5 [\u0026_ul]:list-disc [\u0026_ul]:pl-6 [\u0026_img]:rounded [\u0026_li]:my-2\",\"children\":[[\"$\",\"h1\",\"h1-0\",{\"children\":\"bi0sCTF 2024 — A Block and a Hard Place\"}],\"\\n\",[\"$\",\"blockquote\",\"blockquote-0\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"Are you the Far Lands because you're a Maze? Or are you a Maze because you're the Far Lands?\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"We're given a terminal prompt that looks like this:\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/assets/60120929/bbf7f4fc-96b5-4f13-9b4d-a4f418bf2828\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":\"It looks like we're blindly navigating some sort of \\\"maze\\\", with walls blocking regular movement between certain cells.\"}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":\"As a first order of business, we should probably map out what this maze looks like. We can represent each maze position as a 2x2 grid, where the right and bottom two cells represent whether there is a wall to the right or bottom of the cell, respectively:\"}],\"\\n\",[\"$\",\"$L13\",\"pre-0\",{\"className\":\"my-4\",\"children\":\"..    .X    ..    .X\\n..    .X    XX    XX\",\"language\":\"$undefined\"}],\"\\n\",[\"$\",\"p\",\"p-4\",{\"children\":\"(we don't need to check for left or top walls as we'll have already found them when iterating over other positions.)\"}],\"\\n\",[\"$\",\"p\",\"p-5\",{\"children\":\"Then, writing a python script to map out the maze's walls, printing one row of the maze at a time,[^1]\"}],\"\\n\",[\"$\",\"$L13\",\"pre-1\",{\"className\":\"my-4\",\"children\":\"$14\",\"language\":\"py\"}],\"\\n\",[\"$\",\"p\",\"p-6\",{\"children\":\"[^1]: A bit sloppy, but we're somewhat forced to print the buffer before reading the next line instead of printing it all at the end because traversing the maze takes so long the connection times out (crashing the program) before the entire process is done.\"}],\"\\n\",[\"$\",\"p\",\"p-7\",{\"children\":\"we get\"}],\"\\n\",[\"$\",\"$L13\",\"pre-2\",{\"className\":\"my-4\",\"children\":\"$15\",\"language\":\"$undefined\"}],\"\\n\",[\"$\",\"p\",\"p-8\",{\"children\":\"Looks a bit like a QR code, doesn't it? 🤔\"}],\"\\n\",[\"$\",\"p\",\"p-9\",{\"children\":\"First, though, we need to fix up all of the top-left corners which got messed up by the traversal algorithm. Doing so yields\"}],\"\\n\",[\"$\",\"$L13\",\"pre-3\",{\"className\":\"my-4\",\"children\":\"$16\",\"language\":\"$undefined\"}],\"\\n\",[\"$\",\"p\",\"p-10\",{\"children\":\"Resizing the image in Photoshop to make the corner boxes more square-like, we get an interesting pattern that looks like this:\"}],\"\\n\",\"\u003cp align=\\\"center\\\"\u003e\\n  \u003cimg src=\\\"https://gist.github.com/assets/60120929/e9d7885e-0836-4e5e-958b-653ec5ae846d\\\" width=\\\"600px\\\"\u003e\\n\u003c/p\u003e\",\"\\n\",[\"$\",\"p\",\"p-11\",{\"children\":\"The key realization here is that the corners of a valid QR code should consist of a single ring around solid block of black:\"}],\"\\n\",\"\u003cp align=\\\"center\\\"\u003e\\n  \u003cimg src=\\\"https://gist.github.com/assets/60120929/7414e9dd-0823-4118-9d52-f0fd287e7489\\\" width=\\\"300px\\\"\u003e\\n\u003c/p\u003e\",\"\\n\",[\"$\",\"p\",\"p-12\",{\"children\":[\"Because the walls lie \",[\"$\",\"em\",\"em-0\",{\"children\":\"between\"}],\" cells, it's clear now that the walls of the maze separate regions of different color in the QR code. Then, this challenge turns into a sort of \\\"A/B coloring\\\" problem solvable with the following routine:\"]}],\"\\n\",[\"$\",\"ol\",\"ol-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":\"Keep a state tracking the current \\\"color\\\": white/black (or filled/unfilled)\"}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":\"Iterate over all cells, painting each cell the current color.\"}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":\"When the program hits a wall in the maze while iterating, swap the current color.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-13\",{\"children\":\"Modifying our traversal script with the given algorithm,\"}],\"\\n\",[\"$\",\"$L13\",\"pre-4\",{\"className\":\"my-4\",\"children\":\"$17\",\"language\":\"py\"}],\"\\n\",[\"$\",\"p\",\"p-14\",{\"children\":\"we get\"}],\"\\n\",[\"$\",\"$L13\",\"pre-5\",{\"className\":\"my-4\",\"children\":\"$18\",\"language\":\"$undefined\"}],\"\\n\",\"\u003cp align=\\\"center\\\"\u003e\\n  \u003cimg src=\\\"https://gist.github.com/assets/60120929/e7c4c59c-33cb-406d-af9a-7e42e7b24df8\\\" width=\\\"400px\\\"\u003e\\n\u003c/p\u003e\",\"\\n\",[\"$\",\"p\",\"p-15\",{\"children\":\"which we can scan to get the flag.\"}],\"\\n\",[\"$\",\"$L13\",\"pre-6\",{\"className\":\"my-4\",\"children\":\"bi0sctf{cZrfONl+bGtGiKWMnnR5Sg==}\",\"language\":\"$undefined\"}]]}]}]\n"])</script></body></html>