<!DOCTYPE html><!--s9MJ02MDGdivoliH5zigB--><html class="dark scroll-smooth"><head><meta charSet="utf-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/f53d5288e842910a.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-7cc99edc1a50fd44.js"/><script src="/_next/static/chunks/4bd1b696-9911af18dede28aa.js" async=""></script><script src="/_next/static/chunks/964-2bcac1827bbf29c7.js" async=""></script><script src="/_next/static/chunks/main-app-771e5b53791411ad.js" async=""></script><script src="/_next/static/chunks/874-3e820bd666038662.js" async=""></script><script src="/_next/static/chunks/app/writeups/%5Bid%5D/layout-2577bd3482649595.js" async=""></script><script src="/_next/static/chunks/bc9c3264-6371ca03223855d4.js" async=""></script><script src="/_next/static/chunks/48507feb-8452885980bba250.js" async=""></script><script src="/_next/static/chunks/08ffe114-f47006c90e36a3eb.js" async=""></script><script src="/_next/static/chunks/800-bd0deb6e7b7e903a.js" async=""></script><script src="/_next/static/chunks/app/writeups/%5Bid%5D/page-54fe20cc7a9d3224.js" async=""></script><meta name="next-size-adjust" content=""/><title>SDCTF 2025 ‚Äî triglot | kevin.fish</title><meta name="description" content="You think you know programming? You think you know languages? heh... as if üôÑ"/><meta property="og:title" content="SDCTF 2025 ‚Äî triglot"/><meta property="og:description" content="You think you know programming? You think you know languages? heh... as if üôÑ"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="SDCTF 2025 ‚Äî triglot"/><meta name="twitter:description" content="You think you know programming? You think you know languages? heh... as if üôÑ"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="text-dark dark:text-white dark:bg-midnight" style="font-family:&#x27;Inter&#x27;, &#x27;Inter Fallback&#x27;;font-style:normal"><div hidden=""><!--$--><!--/$--></div><main class="container pt-20 pb-24"><a class="text-secondary text-sm mb-10 -ml-5 block w-max" href="/writeups">‚Üê Back to writeups</a><div><main class="text-pretty max-w-5xl mx-auto text-sm [&amp;_h1]:text-5xl [&amp;_h1]:font-semibold [&amp;_h1]:mb-8 [&amp;_blockquote]:text-secondary [&amp;_blockquote]:space-y-3 [&amp;_blockquote]:border-l-4 [&amp;_blockquote]:border-secondary [&amp;_blockquote]:pl-5 [&amp;_blockquote]:mb-5 [&amp;&gt;_p]:my-4 [&amp;_img]:my-5 [&amp;_ul]:list-disc [&amp;_ul]:pl-6 [&amp;_ol]:list-decimal [&amp;_ol]:pl-6 [&amp;_img]:rounded [&amp;_li]:my-2"><h1>SDCTF 2025 ‚Äî triglot</h1>
<blockquote>
<p>You think you know programming? You think you know languages? heh... as if üôÑ</p>
<p>Come back to me when you can write a program that runs in the 3 deadly P&#x27;s: Perl, Python, and (P)Javascript</p>
<p>Connect with <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">nc -q 2 -N 52.8.15.62 8001</code></p>
<p>Flag is located at <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">./flag.txt</code></p>
</blockquote>
<p>We&#x27;re given a script that looks like this:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M21.038,4.9l-7.577-4.498C13.009,0.134,12.505,0,12,0c-0.505,0-1.009,0.134-1.462,0.403L2.961,4.9 C2.057,5.437,1.5,6.429,1.5,7.503v8.995c0,1.073,0.557,2.066,1.462,2.603l7.577,4.497C10.991,23.866,11.495,24,12,24 c0.505,0,1.009-0.134,1.461-0.402l7.577-4.497c0.904-0.537,1.462-1.529,1.462-2.603V7.503C22.5,6.429,21.943,5.437,21.038,4.9z M15.17,18.946l0.013,0.646c0.001,0.078-0.05,0.167-0.111,0.198l-0.383,0.22c-0.061,0.031-0.111-0.007-0.112-0.085L14.57,19.29 c-0.328,0.136-0.66,0.169-0.872,0.084c-0.04-0.016-0.057-0.075-0.041-0.142l0.139-0.584c0.011-0.046,0.036-0.092,0.069-0.121 c0.012-0.011,0.024-0.02,0.036-0.026c0.022-0.011,0.043-0.014,0.062-0.006c0.229,0.077,0.521,0.041,0.802-0.101 c0.357-0.181,0.596-0.545,0.592-0.907c-0.003-0.328-0.181-0.465-0.613-0.468c-0.55,0.001-1.064-0.107-1.072-0.917 c-0.007-0.667,0.34-1.361,0.889-1.8l-0.007-0.652c-0.001-0.08,0.048-0.168,0.111-0.2l0.37-0.236 c0.061-0.031,0.111,0.007,0.112,0.087l0.006,0.653c0.273-0.109,0.511-0.138,0.726-0.088c0.047,0.012,0.067,0.076,0.048,0.151 l-0.144,0.578c-0.011,0.044-0.036,0.088-0.065,0.116c-0.012,0.012-0.025,0.021-0.038,0.028c-0.019,0.01-0.038,0.013-0.057,0.009 c-0.098-0.022-0.332-0.073-0.699,0.113c-0.385,0.195-0.52,0.53-0.517,0.778c0.003,0.297,0.155,0.387,0.681,0.396 c0.7,0.012,1.003,0.318,1.01,1.023C16.105,17.747,15.736,18.491,15.17,18.946z M19.143,17.859c0,0.06-0.008,0.116-0.058,0.145 l-1.916,1.164c-0.05,0.029-0.09,0.004-0.09-0.056v-0.494c0-0.06,0.037-0.093,0.087-0.122l1.887-1.129 c0.05-0.029,0.09-0.004,0.09,0.056V17.859z M20.459,6.797l-7.168,4.427c-0.894,0.523-1.553,1.109-1.553,2.187v8.833 c0,0.645,0.26,1.063,0.66,1.184c-0.131,0.023-0.264,0.039-0.398,0.039c-0.42,0-0.833-0.114-1.197-0.33L3.226,18.64 c-0.741-0.44-1.201-1.261-1.201-2.142V7.503c0-0.881,0.46-1.702,1.201-2.142l7.577-4.498c0.363-0.216,0.777-0.33,1.197-0.33 c0.419,0,0.833,0.114,1.197,0.33l7.577,4.498c0.624,0.371,1.046,1.013,1.164,1.732C21.686,6.557,21.12,6.411,20.459,6.797z"></path></svg> <!-- -->bash<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token shebang important">#!/usr/bin/env bash</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token builtin class-name">set</span><span class=""> -eo pipefail
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">3</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token function-name function">wrong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">  </span><span class="token builtin class-name">printf</span><span class=""> </span><span class="token string">&quot;EXTREMELY LOUD INCORRECT BUZZER!!!</span><span class="token string entity">\n</span><span class="token string">&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class=""></span><span class="token builtin class-name">trap</span><span class=""> wrong ERR
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">8</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class=""></span><span class="token assign-left variable">code</span><span class="token operator">=</span><span class="token variable">$(</span><span class="token variable function">cat</span><span class="token variable">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">10</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class=""></span><span class="token builtin class-name">printf</span><span class=""> </span><span class="token string">&#x27;%s&#x27;</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$code</span><span class="token string">&quot;</span><span class=""> </span><span class="token operator">|</span><span class=""> perl -c
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class=""></span><span class="token builtin class-name">printf</span><span class=""> </span><span class="token string">&#x27;%s&#x27;</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$code</span><span class="token string">&quot;</span><span class=""> </span><span class="token operator">|</span><span class=""> python3 -c </span><span class="token string">&#x27;import sys,ast; ast.parse(sys.stdin.read())&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class=""></span><span class="token builtin class-name">printf</span><span class=""> </span><span class="token string">&#x27;%s&#x27;</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$code</span><span class="token string">&quot;</span><span class=""> </span><span class="token operator">|</span><span class=""> </span><span class="token function">node</span><span class=""> -e </span><span class="token string">&quot;const fs=require(&#x27;fs&#x27;), src=fs.readFileSync(0,&#x27;utf8&#x27;); require(&#x27;vm&#x27;).createScript(src)&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">14</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class=""></span><span class="token assign-left variable">perl_out</span><span class="token operator">=</span><span class="token variable">$(</span><span class="token variable builtin class-name">printf</span><span class="token variable"> </span><span class="token variable string">&#x27;%s&#x27;</span><span class="token variable"> </span><span class="token variable string">&quot;</span><span class="token variable string">$code</span><span class="token variable string">&quot;</span><span class="token variable"> </span><span class="token variable operator">|</span><span class="token variable"> perl -</span><span class="token variable">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">16</span><span class=""></span><span class="token assign-left variable">py_out</span><span class="token operator">=</span><span class="token variable">$(</span><span class="token variable builtin class-name">printf</span><span class="token variable"> </span><span class="token variable string">&#x27;%s&#x27;</span><span class="token variable"> </span><span class="token variable string">&quot;</span><span class="token variable string">$code</span><span class="token variable string">&quot;</span><span class="token variable"> </span><span class="token variable operator">|</span><span class="token variable"> python3 -</span><span class="token variable">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">17</span><span class=""></span><span class="token assign-left variable">js_out</span><span class="token operator">=</span><span class="token variable">$(</span><span class="token variable builtin class-name">printf</span><span class="token variable"> </span><span class="token variable string">&#x27;%s&#x27;</span><span class="token variable"> </span><span class="token variable string">&quot;</span><span class="token variable string">$code</span><span class="token variable string">&quot;</span><span class="token variable"> </span><span class="token variable operator">|</span><span class="token variable"> </span><span class="token variable function">node</span><span class="token variable"> -</span><span class="token variable">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">18</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">19</span><span class=""></span><span class="token keyword">if</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$perl_out</span><span class="token string">&quot;</span><span class=""> </span><span class="token operator">==</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$py_out</span><span class="token string">&quot;</span><span class=""> </span><span class="token operator">&amp;&amp;</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$perl_out</span><span class="token string">&quot;</span><span class=""> </span><span class="token operator">==</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$js_out</span><span class="token string">&quot;</span><span class=""> </span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">then</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">20</span><span class="">  </span><span class="token builtin class-name">printf</span><span class=""> </span><span class="token string">&quot;Your triglot compiles!! Here&#x27;s your output:</span><span class="token string entity">\n</span><span class="token string">&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">21</span><span class="">  </span><span class="token builtin class-name">printf</span><span class=""> </span><span class="token string">&#x27;%s\n&#x27;</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$perl_out</span><span class="token string">&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">22</span><span class=""></span><span class="token keyword">else</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">23</span><span class="">  </span><span class="token builtin class-name">exit</span><span class=""> </span><span class="token number">1</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">24</span><span class=""></span><span class="token keyword">fi</span></code></pre></div></div>
<p>It seems like we just need to make a script that runs in Perl, Python, and JS, and prints the flag in each one.</p>
<p>To start, a Python / JS polyglot seems pretty straightforward: we can use the fact that <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">//</code> is floor division
in Python and a line comment in JS to create areas of our script only executed in Python:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z"></path></svg> <!-- -->js<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; [... code only executed in python]</span></code></pre></div></div>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"></path></svg> <!-- -->py<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class=""> code only executed </span><span class="token keyword">in</span><span class=""> python</span><span class="token punctuation">]</span></code></pre></div></div>
<p>With this, we can use Python multi-line strings to &quot;comment out&quot; chunks of code to be only executed in JS:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z"></path></svg> <!-- -->js<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; &#x27;&#x27;&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token punctuation">[</span><span class="token spread operator">...</span><span class=""> code only executed </span><span class="token keyword">in</span><span class=""> </span><span class="token constant">JS</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token comment">//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"></path></svg> <!-- -->py<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token triple-quoted-string string">&#x27;&#x27;&#x27;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>[... code only executed in JS]
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span>//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<p>Thus, our Python / JS polyglot that cats the flag is as simple as</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z"></path></svg> <!-- -->js<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; print(open(&#x27;./flag.txt&#x27;).read()); &#x27;&#x27;&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token keyword">const</span><span class=""> </span><span class="token punctuation">{</span><span class=""> readFileSync </span><span class="token punctuation">}</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;fs&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token comment">//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"></path></svg> <!-- -->py<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token triple-quoted-string string">&#x27;&#x27;&#x27;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>const { readFileSync } = require(&#x27;fs&#x27;); console.log(readFileSync(&#x27;./flag.txt&#x27;).toString());
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<p>Now for the challenging part: adding Perl. We can try to use <a href="https://stackoverflow.com/questions/3828205/how-do-i-enter-a-multi-line-comment-in-perl">Perl multiline comments</a> to embed the above Python /
JS payload in a surrounding Perl script, but the syntax is too strange: the <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">=hello</code> &quot;start comment&quot; deliminator</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M11.638 0c-.148 0-.207.689-.252 2.925-.058 2.86-.07 2.949-.51 3.914-.36.793-1.623 2.676-2.037 3.04-.373.328-1.183 1.56-1.58 2.401-.71 1.504-.659 3.52-.04 5.047.518 1.194 1.262 2.156 2.46 3.182.94.805 1.23.919 1.375.544.049-.128-.162-.572-.483-1.018-.313-.436-.843-1.362-1.178-2.059-1.382-2.926-.7-5.357.902-8.045.89-1.393 1.403-2.642 1.579-3.852.22-1.515.043-6.079-.236-6.079zm-.757 1.215c-.186 0-.228.26-.228 1.422 0 .782-.08 1.654-.177 1.938-.312.914-1.154 1.737-3.482 3.404-1.684 1.205-3.096 2.652-3.64 3.732-1.666 3.299-.195 7.311 3.42 9.333 1.613.902 2.966 1.253 2.966.768 0-.126-.054-.228-.121-.228s-.632-.332-1.254-.738c-2.69-1.755-3.947-3.927-3.747-6.482.15-1.91.873-3.08 3.796-6.135 2.522-2.636 2.69-2.97 2.693-5.304.001-1.42-.036-1.71-.226-1.71zm1.508.632c-.103.017-.14.905-.142 2.903l-.004 2.926-.744 2.812c-.83 2.54-.954 5.133-.345 7.725.558 2.202.796 2.638 1.567 2.857.343.098.89.355 1.216.572.736.49 1.395.435 2.715-.232 1.92-.97 3.209-2.222 4.067-3.953.745-1.648.856-3.71.068-5.35-.7-1.414-1.882-2.554-4.358-4.197-2.162-1.436-2.617-1.82-3.15-2.652-.322-.503-.369-.724-.308-1.444.04-.468.126-.978.192-1.134.101-.239.069-.268-.202-.182-.26.082-.34.027-.42-.286-.061-.245-.112-.372-.152-.365zm.714 4.586c.034-.007.135.113.252.306.144.237 1.022 1 1.952 1.697 2.888 2.189 5.27 4.378 4.087 8.2-.405 1.146-.99 2.07-1.963 3.098-.544.575-1.266 1.09-1.53 1.09-.047 0 .252-.43.664-.954 1.337-1.7 1.972-3.718 1.79-5.674-.168-1.796-1.557-3.975-3.753-5.89-.912-.796-1.518-1.536-1.512-1.846 0-.016.005-.025.013-.027zm-1.089 15.492c-.208-.006-.297.349-.297 1.121 0 .94.018.988.342.942.302-.042.347-.15.387-.899.032-.613-.019-.902-.183-1.039-.097-.08-.18-.123-.249-.125zm-1.052.28c-.124-.002-.226.14-.327.43-.085.245-.253.481-.373.527-.322.124-.264.55.075.55.162 0 .402-.109.534-.24.441-.442.579-.824.382-1.062-.111-.134-.206-.203-.29-.205zm2.074.063c-.312 0-.28.61.053 1.034.309.392.908.567.908.264 0-.252-.775-1.298-.961-1.298z"></path></svg> <!-- -->perl<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token comment">=hello
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>... perl comment
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span>=cut</span></code></pre></div></div>
<p>would give syntax errors in JS and Python, and trying to disguise it as a variable assignment e.g.</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z"></path></svg> <!-- -->js<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">hello </span><span class="token operator">=</span><span class=""> </span><span class="token number">5</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>a
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token operator">=</span><span class="">hello
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token spread operator">...</span><span class=""> perl comment
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token operator">=</span><span class="">cut</span></code></pre></div></div>
<p>would also lead to it being parsed as an assignment in Perl (with many errors following).</p>
<p>Instead, we can use the convenient <a href="https://perldoc.perl.org/perldata#Special-Literals">Perl <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">__END__</code> special token</a>
to cause the Perl interpreter to ignore all subsequent text in the payload, avoiding having to manage Perl syntax errors
in the process!</p>
<p>Thus, the main idea becomes doing something like:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z"></path></svg> <!-- -->js<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token constant">FH</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;./flag.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> print </span><span class="token operator">&lt;</span><span class="token constant">FH</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">__END__</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; print(open(&#x27;./flag.txt&#x27;).read()); &#x27;&#x27;&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token keyword">const</span><span class=""> </span><span class="token punctuation">{</span><span class=""> readFileSync </span><span class="token punctuation">}</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;fs&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class=""></span><span class="token comment">//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"></path></svg> <!-- -->py<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="">FH</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;./flag.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class=""> </span><span class="token operator">&lt;</span><span class="">FH</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">__END__</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token triple-quoted-string string">&#x27;&#x27;&#x27;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span>const { readFileSync } = require(&#x27;fs&#x27;); console.log(readFileSync(&#x27;./flag.txt&#x27;).toString());
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span>//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M11.638 0c-.148 0-.207.689-.252 2.925-.058 2.86-.07 2.949-.51 3.914-.36.793-1.623 2.676-2.037 3.04-.373.328-1.183 1.56-1.58 2.401-.71 1.504-.659 3.52-.04 5.047.518 1.194 1.262 2.156 2.46 3.182.94.805 1.23.919 1.375.544.049-.128-.162-.572-.483-1.018-.313-.436-.843-1.362-1.178-2.059-1.382-2.926-.7-5.357.902-8.045.89-1.393 1.403-2.642 1.579-3.852.22-1.515.043-6.079-.236-6.079zm-.757 1.215c-.186 0-.228.26-.228 1.422 0 .782-.08 1.654-.177 1.938-.312.914-1.154 1.737-3.482 3.404-1.684 1.205-3.096 2.652-3.64 3.732-1.666 3.299-.195 7.311 3.42 9.333 1.613.902 2.966 1.253 2.966.768 0-.126-.054-.228-.121-.228s-.632-.332-1.254-.738c-2.69-1.755-3.947-3.927-3.747-6.482.15-1.91.873-3.08 3.796-6.135 2.522-2.636 2.69-2.97 2.693-5.304.001-1.42-.036-1.71-.226-1.71zm1.508.632c-.103.017-.14.905-.142 2.903l-.004 2.926-.744 2.812c-.83 2.54-.954 5.133-.345 7.725.558 2.202.796 2.638 1.567 2.857.343.098.89.355 1.216.572.736.49 1.395.435 2.715-.232 1.92-.97 3.209-2.222 4.067-3.953.745-1.648.856-3.71.068-5.35-.7-1.414-1.882-2.554-4.358-4.197-2.162-1.436-2.617-1.82-3.15-2.652-.322-.503-.369-.724-.308-1.444.04-.468.126-.978.192-1.134.101-.239.069-.268-.202-.182-.26.082-.34.027-.42-.286-.061-.245-.112-.372-.152-.365zm.714 4.586c.034-.007.135.113.252.306.144.237 1.022 1 1.952 1.697 2.888 2.189 5.27 4.378 4.087 8.2-.405 1.146-.99 2.07-1.963 3.098-.544.575-1.266 1.09-1.53 1.09-.047 0 .252-.43.664-.954 1.337-1.7 1.972-3.718 1.79-5.674-.168-1.796-1.557-3.975-3.753-5.89-.912-.796-1.518-1.536-1.512-1.846 0-.016.005-.025.013-.027zm-1.089 15.492c-.208-.006-.297.349-.297 1.121 0 .94.018.988.342.942.302-.042.347-.15.387-.899.032-.613-.019-.902-.183-1.039-.097-.08-.18-.123-.249-.125zm-1.052.28c-.124-.002-.226.14-.327.43-.085.245-.253.481-.373.527-.322.124-.264.55.075.55.162 0 .402-.109.534-.24.441-.442.579-.824.382-1.062-.111-.134-.206-.203-.29-.205zm2.074.063c-.312 0-.28.61.053 1.034.309.392.908.567.908.264 0-.252-.775-1.298-.961-1.298z"></path></svg> <!-- -->perl<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">open</span><span class="token punctuation">(</span><span class="">FH</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;./flag.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class=""> </span><span class="token filehandle symbol">&lt;FH&gt;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">__END__</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">open</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token string">&#x27;&#x27;</span><span class="">&#x27;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">const </span><span class="token punctuation">{</span><span class=""> readFileSync </span><span class="token punctuation">}</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&#x27;fs&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> console</span><span class="token operator">.</span><span class="">log</span><span class="token punctuation">(</span><span class="">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class=""></span><span class="token operator">//</span><span class="token string">&#x27;&#x27;</span><span class="">&#x27;</span></code></pre></div></div>
<p>where we paste our JS / Python polyglot after the <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">__END__</code> token to avoid having to deal with Perl syntax there.</p>
<p>(note: we need to do <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">__END__=5</code> and wrap the <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">__END__</code> token in an assignment to avoid a JS <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">ReferenceError</code> or Python
<code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">NameError</code>.)</p>
<p>Finally, we just need to figure out a way to get the first</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M11.638 0c-.148 0-.207.689-.252 2.925-.058 2.86-.07 2.949-.51 3.914-.36.793-1.623 2.676-2.037 3.04-.373.328-1.183 1.56-1.58 2.401-.71 1.504-.659 3.52-.04 5.047.518 1.194 1.262 2.156 2.46 3.182.94.805 1.23.919 1.375.544.049-.128-.162-.572-.483-1.018-.313-.436-.843-1.362-1.178-2.059-1.382-2.926-.7-5.357.902-8.045.89-1.393 1.403-2.642 1.579-3.852.22-1.515.043-6.079-.236-6.079zm-.757 1.215c-.186 0-.228.26-.228 1.422 0 .782-.08 1.654-.177 1.938-.312.914-1.154 1.737-3.482 3.404-1.684 1.205-3.096 2.652-3.64 3.732-1.666 3.299-.195 7.311 3.42 9.333 1.613.902 2.966 1.253 2.966.768 0-.126-.054-.228-.121-.228s-.632-.332-1.254-.738c-2.69-1.755-3.947-3.927-3.747-6.482.15-1.91.873-3.08 3.796-6.135 2.522-2.636 2.69-2.97 2.693-5.304.001-1.42-.036-1.71-.226-1.71zm1.508.632c-.103.017-.14.905-.142 2.903l-.004 2.926-.744 2.812c-.83 2.54-.954 5.133-.345 7.725.558 2.202.796 2.638 1.567 2.857.343.098.89.355 1.216.572.736.49 1.395.435 2.715-.232 1.92-.97 3.209-2.222 4.067-3.953.745-1.648.856-3.71.068-5.35-.7-1.414-1.882-2.554-4.358-4.197-2.162-1.436-2.617-1.82-3.15-2.652-.322-.503-.369-.724-.308-1.444.04-.468.126-.978.192-1.134.101-.239.069-.268-.202-.182-.26.082-.34.027-.42-.286-.061-.245-.112-.372-.152-.365zm.714 4.586c.034-.007.135.113.252.306.144.237 1.022 1 1.952 1.697 2.888 2.189 5.27 4.378 4.087 8.2-.405 1.146-.99 2.07-1.963 3.098-.544.575-1.266 1.09-1.53 1.09-.047 0 .252-.43.664-.954 1.337-1.7 1.972-3.718 1.79-5.674-.168-1.796-1.557-3.975-3.753-5.89-.912-.796-1.518-1.536-1.512-1.846 0-.016.005-.025.013-.027zm-1.089 15.492c-.208-.006-.297.349-.297 1.121 0 .94.018.988.342.942.302-.042.347-.15.387-.899.032-.613-.019-.902-.183-1.039-.097-.08-.18-.123-.249-.125zm-1.052.28c-.124-.002-.226.14-.327.43-.085.245-.253.481-.373.527-.322.124-.264.55.075.55.162 0 .402-.109.534-.24.441-.442.579-.824.382-1.062-.111-.134-.206-.203-.29-.205zm2.074.063c-.312 0-.28.61.053 1.034.309.392.908.567.908.264 0-.252-.775-1.298-.961-1.298z"></path></svg> <!-- -->perl<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">open</span><span class="token punctuation">(</span><span class="">FH</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;./flag.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class=""> </span><span class="token filehandle symbol">&lt;FH&gt;</span><span class="token punctuation">;</span></code></pre></div></div>
<p>Perl snippet to not raise syntax errors in Python or JS.</p>
<p>This part is a bit tricky: we need to use the <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">//</code> trick from before (which is luckily valid Perl for <a href="https://perldoc.perl.org/perlop#Logical-Defined-Or">short-circuited &quot;definedness
OR&quot;</a>) to comment out Python- / Perl-only areas.</p>
<p>Since single-line comments are started by <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">#</code> in both Perl and Python, we need to use multiline strings for Python
comments instead. Note that if we&#x27;re <em>inside a string</em>, <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">#</code> won&#x27;t start a single-line comment; thus, we can try to layer strings
such that we are inside a string in Python and not Perl, and vice versa to comment out different sections of code in each.</p>
<p>But there&#x27;s one last trick, since simply having a python triple-quoted string in Perl will raise syntax errors: <a href="https://perldoc.perl.org/perlop#Quote-Like-Operators">Perl &quot;quote-like operators&quot;</a> (which I learned about from this <a href="https://github.com/floyd-fuh/C-CPP-Perl-Ruby-Python-Polyglot/blob/master/python_2_and_3_improvement/code.c">C, Ruby Perl, Python polyglot on GitHub</a>).</p>
<p>We can use the token <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">q=&quot;&quot;&quot;</code> to start a multi-line string in Python and a q-string in Perl, where:</p>
<ul>
<li><code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">&quot;&quot;&quot;</code> ends the Python string, and</li>
<li><code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">=</code> ends the Perl string,</li>
</ul>
<p>letting us construct something like</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"></path></svg> <!-- -->py<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">q</span><span class="token operator">=</span><span class="token triple-quoted-string string">&quot;&quot;&quot;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>[... this is commented out in python and perl]
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span>=;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">4</span>[... this is commented out in python only]
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">5</span>#&quot;&quot;&quot;</span></code></pre></div></div>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M11.638 0c-.148 0-.207.689-.252 2.925-.058 2.86-.07 2.949-.51 3.914-.36.793-1.623 2.676-2.037 3.04-.373.328-1.183 1.56-1.58 2.401-.71 1.504-.659 3.52-.04 5.047.518 1.194 1.262 2.156 2.46 3.182.94.805 1.23.919 1.375.544.049-.128-.162-.572-.483-1.018-.313-.436-.843-1.362-1.178-2.059-1.382-2.926-.7-5.357.902-8.045.89-1.393 1.403-2.642 1.579-3.852.22-1.515.043-6.079-.236-6.079zm-.757 1.215c-.186 0-.228.26-.228 1.422 0 .782-.08 1.654-.177 1.938-.312.914-1.154 1.737-3.482 3.404-1.684 1.205-3.096 2.652-3.64 3.732-1.666 3.299-.195 7.311 3.42 9.333 1.613.902 2.966 1.253 2.966.768 0-.126-.054-.228-.121-.228s-.632-.332-1.254-.738c-2.69-1.755-3.947-3.927-3.747-6.482.15-1.91.873-3.08 3.796-6.135 2.522-2.636 2.69-2.97 2.693-5.304.001-1.42-.036-1.71-.226-1.71zm1.508.632c-.103.017-.14.905-.142 2.903l-.004 2.926-.744 2.812c-.83 2.54-.954 5.133-.345 7.725.558 2.202.796 2.638 1.567 2.857.343.098.89.355 1.216.572.736.49 1.395.435 2.715-.232 1.92-.97 3.209-2.222 4.067-3.953.745-1.648.856-3.71.068-5.35-.7-1.414-1.882-2.554-4.358-4.197-2.162-1.436-2.617-1.82-3.15-2.652-.322-.503-.369-.724-.308-1.444.04-.468.126-.978.192-1.134.101-.239.069-.268-.202-.182-.26.082-.34.027-.42-.286-.061-.245-.112-.372-.152-.365zm.714 4.586c.034-.007.135.113.252.306.144.237 1.022 1 1.952 1.697 2.888 2.189 5.27 4.378 4.087 8.2-.405 1.146-.99 2.07-1.963 3.098-.544.575-1.266 1.09-1.53 1.09-.047 0 .252-.43.664-.954 1.337-1.7 1.972-3.718 1.79-5.674-.168-1.796-1.557-3.975-3.753-5.89-.912-.796-1.518-1.536-1.512-1.846 0-.016.005-.025.013-.027zm-1.089 15.492c-.208-.006-.297.349-.297 1.121 0 .94.018.988.342.942.302-.042.347-.15.387-.899.032-.613-.019-.902-.183-1.039-.097-.08-.18-.123-.249-.125zm-1.052.28c-.124-.002-.226.14-.327.43-.085.245-.253.481-.373.527-.322.124-.264.55.075.55.162 0 .402-.109.534-.24.441-.442.579-.824.382-1.062-.111-.134-.206-.203-.29-.205zm2.074.063c-.312 0-.28.61.053 1.034.309.392.908.567.908.264 0-.252-.775-1.298-.961-1.298z"></path></svg> <!-- -->perl<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token string">q=&quot;&quot;&quot;
</span><span class="token string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>[... this is commented out in python and perl]
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="token string">=</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token punctuation">[</span><span class="token operator">...</span><span class=""> this is commented out in python only</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token comment">#&quot;&quot;&quot;</span></code></pre></div></div>
<p>Weaving these all together, we can construct</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z"></path></svg> <!-- -->js<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; q=&quot;&quot;&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token comment">/*=;
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>open(FH, &quot;&lt;&quot;, &quot;./flag.txt&quot;); print &lt;FH&gt;;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="token comment">#*/</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2;#&quot;&quot;&quot;</span></code></pre></div></div>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"></path></svg> <!-- -->py<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> q</span><span class="token operator">=</span><span class="token triple-quoted-string string">&quot;&quot;&quot;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>/*=;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>open(FH, &quot;&lt;&quot;, &quot;./flag.txt&quot;); print &lt;FH&gt;;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span>#*/
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span>3 // 2;#&quot;&quot;&quot;</span></code></pre></div></div>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M11.638 0c-.148 0-.207.689-.252 2.925-.058 2.86-.07 2.949-.51 3.914-.36.793-1.623 2.676-2.037 3.04-.373.328-1.183 1.56-1.58 2.401-.71 1.504-.659 3.52-.04 5.047.518 1.194 1.262 2.156 2.46 3.182.94.805 1.23.919 1.375.544.049-.128-.162-.572-.483-1.018-.313-.436-.843-1.362-1.178-2.059-1.382-2.926-.7-5.357.902-8.045.89-1.393 1.403-2.642 1.579-3.852.22-1.515.043-6.079-.236-6.079zm-.757 1.215c-.186 0-.228.26-.228 1.422 0 .782-.08 1.654-.177 1.938-.312.914-1.154 1.737-3.482 3.404-1.684 1.205-3.096 2.652-3.64 3.732-1.666 3.299-.195 7.311 3.42 9.333 1.613.902 2.966 1.253 2.966.768 0-.126-.054-.228-.121-.228s-.632-.332-1.254-.738c-2.69-1.755-3.947-3.927-3.747-6.482.15-1.91.873-3.08 3.796-6.135 2.522-2.636 2.69-2.97 2.693-5.304.001-1.42-.036-1.71-.226-1.71zm1.508.632c-.103.017-.14.905-.142 2.903l-.004 2.926-.744 2.812c-.83 2.54-.954 5.133-.345 7.725.558 2.202.796 2.638 1.567 2.857.343.098.89.355 1.216.572.736.49 1.395.435 2.715-.232 1.92-.97 3.209-2.222 4.067-3.953.745-1.648.856-3.71.068-5.35-.7-1.414-1.882-2.554-4.358-4.197-2.162-1.436-2.617-1.82-3.15-2.652-.322-.503-.369-.724-.308-1.444.04-.468.126-.978.192-1.134.101-.239.069-.268-.202-.182-.26.082-.34.027-.42-.286-.061-.245-.112-.372-.152-.365zm.714 4.586c.034-.007.135.113.252.306.144.237 1.022 1 1.952 1.697 2.888 2.189 5.27 4.378 4.087 8.2-.405 1.146-.99 2.07-1.963 3.098-.544.575-1.266 1.09-1.53 1.09-.047 0 .252-.43.664-.954 1.337-1.7 1.972-3.718 1.79-5.674-.168-1.796-1.557-3.975-3.753-5.89-.912-.796-1.518-1.536-1.512-1.846 0-.016.005-.025.013-.027zm-1.089 15.492c-.208-.006-.297.349-.297 1.121 0 .94.018.988.342.942.302-.042.347-.15.387-.899.032-.613-.019-.902-.183-1.039-.097-.08-.18-.123-.249-.125zm-1.052.28c-.124-.002-.226.14-.327.43-.085.245-.253.481-.373.527-.322.124-.264.55.075.55.162 0 .402-.109.534-.24.441-.442.579-.824.382-1.062-.111-.134-.206-.203-.29-.205zm2.074.063c-.312 0-.28.61.053 1.034.309.392.908.567.908.264 0-.252-.775-1.298-.961-1.298z"></path></svg> <!-- -->perl<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token string">q=&quot;&quot;&quot;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="token string">/*=</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">open</span><span class="token punctuation">(</span><span class="">FH</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;./flag.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class=""> </span><span class="token filehandle symbol">&lt;FH&gt;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token comment">#*/</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">#&quot;&quot;&quot;</span></code></pre></div></div>
<p>for a final payload of</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z"></path></svg> <!-- -->js<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; q=&quot;&quot;&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token comment">/*=;
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>open(FH, &quot;&lt;&quot;, &quot;./flag.txt&quot;); print &lt;FH&gt;;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="token comment">#*/</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2;#&quot;&quot;&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">__END__</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; print(open(&#x27;./flag.txt&#x27;).read()); &#x27;&#x27;&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class=""></span><span class="token keyword">const</span><span class=""> </span><span class="token punctuation">{</span><span class=""> readFileSync </span><span class="token punctuation">}</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;fs&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class=""></span><span class="token comment">//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"></path></svg> <!-- -->py<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> q</span><span class="token operator">=</span><span class="token triple-quoted-string string">&quot;&quot;&quot;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>/*=;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>open(FH, &quot;&lt;&quot;, &quot;./flag.txt&quot;); print &lt;FH&gt;;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span>#*/
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="token triple-quoted-string string">3 // 2;#&quot;&quot;&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">__END__</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token triple-quoted-string string">&#x27;&#x27;&#x27;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span>const { readFileSync } = require(&#x27;fs&#x27;); console.log(readFileSync(&#x27;./flag.txt&#x27;).toString());
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span>//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M11.638 0c-.148 0-.207.689-.252 2.925-.058 2.86-.07 2.949-.51 3.914-.36.793-1.623 2.676-2.037 3.04-.373.328-1.183 1.56-1.58 2.401-.71 1.504-.659 3.52-.04 5.047.518 1.194 1.262 2.156 2.46 3.182.94.805 1.23.919 1.375.544.049-.128-.162-.572-.483-1.018-.313-.436-.843-1.362-1.178-2.059-1.382-2.926-.7-5.357.902-8.045.89-1.393 1.403-2.642 1.579-3.852.22-1.515.043-6.079-.236-6.079zm-.757 1.215c-.186 0-.228.26-.228 1.422 0 .782-.08 1.654-.177 1.938-.312.914-1.154 1.737-3.482 3.404-1.684 1.205-3.096 2.652-3.64 3.732-1.666 3.299-.195 7.311 3.42 9.333 1.613.902 2.966 1.253 2.966.768 0-.126-.054-.228-.121-.228s-.632-.332-1.254-.738c-2.69-1.755-3.947-3.927-3.747-6.482.15-1.91.873-3.08 3.796-6.135 2.522-2.636 2.69-2.97 2.693-5.304.001-1.42-.036-1.71-.226-1.71zm1.508.632c-.103.017-.14.905-.142 2.903l-.004 2.926-.744 2.812c-.83 2.54-.954 5.133-.345 7.725.558 2.202.796 2.638 1.567 2.857.343.098.89.355 1.216.572.736.49 1.395.435 2.715-.232 1.92-.97 3.209-2.222 4.067-3.953.745-1.648.856-3.71.068-5.35-.7-1.414-1.882-2.554-4.358-4.197-2.162-1.436-2.617-1.82-3.15-2.652-.322-.503-.369-.724-.308-1.444.04-.468.126-.978.192-1.134.101-.239.069-.268-.202-.182-.26.082-.34.027-.42-.286-.061-.245-.112-.372-.152-.365zm.714 4.586c.034-.007.135.113.252.306.144.237 1.022 1 1.952 1.697 2.888 2.189 5.27 4.378 4.087 8.2-.405 1.146-.99 2.07-1.963 3.098-.544.575-1.266 1.09-1.53 1.09-.047 0 .252-.43.664-.954 1.337-1.7 1.972-3.718 1.79-5.674-.168-1.796-1.557-3.975-3.753-5.89-.912-.796-1.518-1.536-1.512-1.846 0-.016.005-.025.013-.027zm-1.089 15.492c-.208-.006-.297.349-.297 1.121 0 .94.018.988.342.942.302-.042.347-.15.387-.899.032-.613-.019-.902-.183-1.039-.097-.08-.18-.123-.249-.125zm-1.052.28c-.124-.002-.226.14-.327.43-.085.245-.253.481-.373.527-.322.124-.264.55.075.55.162 0 .402-.109.534-.24.441-.442.579-.824.382-1.062-.111-.134-.206-.203-.29-.205zm2.074.063c-.312 0-.28.61.053 1.034.309.392.908.567.908.264 0-.252-.775-1.298-.961-1.298z"></path></svg> <!-- -->perl<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token string">q=&quot;&quot;&quot;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="token string">/*=</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">open</span><span class="token punctuation">(</span><span class="">FH</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;./flag.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class=""> </span><span class="token filehandle symbol">&lt;FH&gt;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token comment">#*/</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">#&quot;&quot;&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">__END__</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">open</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token string">&#x27;&#x27;</span><span class="">&#x27;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">const </span><span class="token punctuation">{</span><span class=""> readFileSync </span><span class="token punctuation">}</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&#x27;fs&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> console</span><span class="token operator">.</span><span class="">log</span><span class="token punctuation">(</span><span class="">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class=""></span><span class="token operator">//</span><span class="token string">&#x27;&#x27;</span><span class="">&#x27;</span></code></pre></div></div>
<p>Submitting this, we get our flag:</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M21.038,4.9l-7.577-4.498C13.009,0.134,12.505,0,12,0c-0.505,0-1.009,0.134-1.462,0.403L2.961,4.9 C2.057,5.437,1.5,6.429,1.5,7.503v8.995c0,1.073,0.557,2.066,1.462,2.603l7.577,4.497C10.991,23.866,11.495,24,12,24 c0.505,0,1.009-0.134,1.461-0.402l7.577-4.497c0.904-0.537,1.462-1.529,1.462-2.603V7.503C22.5,6.429,21.943,5.437,21.038,4.9z M15.17,18.946l0.013,0.646c0.001,0.078-0.05,0.167-0.111,0.198l-0.383,0.22c-0.061,0.031-0.111-0.007-0.112-0.085L14.57,19.29 c-0.328,0.136-0.66,0.169-0.872,0.084c-0.04-0.016-0.057-0.075-0.041-0.142l0.139-0.584c0.011-0.046,0.036-0.092,0.069-0.121 c0.012-0.011,0.024-0.02,0.036-0.026c0.022-0.011,0.043-0.014,0.062-0.006c0.229,0.077,0.521,0.041,0.802-0.101 c0.357-0.181,0.596-0.545,0.592-0.907c-0.003-0.328-0.181-0.465-0.613-0.468c-0.55,0.001-1.064-0.107-1.072-0.917 c-0.007-0.667,0.34-1.361,0.889-1.8l-0.007-0.652c-0.001-0.08,0.048-0.168,0.111-0.2l0.37-0.236 c0.061-0.031,0.111,0.007,0.112,0.087l0.006,0.653c0.273-0.109,0.511-0.138,0.726-0.088c0.047,0.012,0.067,0.076,0.048,0.151 l-0.144,0.578c-0.011,0.044-0.036,0.088-0.065,0.116c-0.012,0.012-0.025,0.021-0.038,0.028c-0.019,0.01-0.038,0.013-0.057,0.009 c-0.098-0.022-0.332-0.073-0.699,0.113c-0.385,0.195-0.52,0.53-0.517,0.778c0.003,0.297,0.155,0.387,0.681,0.396 c0.7,0.012,1.003,0.318,1.01,1.023C16.105,17.747,15.736,18.491,15.17,18.946z M19.143,17.859c0,0.06-0.008,0.116-0.058,0.145 l-1.916,1.164c-0.05,0.029-0.09,0.004-0.09-0.056v-0.494c0-0.06,0.037-0.093,0.087-0.122l1.887-1.129 c0.05-0.029,0.09-0.004,0.09,0.056V17.859z M20.459,6.797l-7.168,4.427c-0.894,0.523-1.553,1.109-1.553,2.187v8.833 c0,0.645,0.26,1.063,0.66,1.184c-0.131,0.023-0.264,0.039-0.398,0.039c-0.42,0-0.833-0.114-1.197-0.33L3.226,18.64 c-0.741-0.44-1.201-1.261-1.201-2.142V7.503c0-0.881,0.46-1.702,1.201-2.142l7.577-4.498c0.363-0.216,0.777-0.33,1.197-0.33 c0.419,0,0.833,0.114,1.197,0.33l7.577,4.498c0.624,0.371,1.046,1.013,1.164,1.732C21.686,6.557,21.12,6.411,20.459,6.797z"></path></svg> <!-- -->bash<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">kevin@ky28059:/mnt/c/users/kevin/Downloads$ </span><span class="token function">cat</span><span class=""> payload </span><span class="token operator">|</span><span class=""> </span><span class="token function">nc</span><span class=""> -q </span><span class="token number">4</span><span class=""> -N </span><span class="token number">52.8</span><span class="">.15.62 </span><span class="token number">8001</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="">Your triglot compiles</span><span class="token operator">!</span><span class="token operator">!</span><span class=""> Here&#x27;s your output:
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">sdctf</span><span class="token punctuation">{</span><span class="">y0u_know_s0_m4ny_langu4g3s</span><span class="token operator">!</span><span class="token punctuation">}</span></code></pre></div></div>
<div class="relative"><span id="final-notes" class="absolute -top-16"></span><a class="group flex gap-2 items-center text-inherit hover:underline decoration-1 underline-offset-4 decoration-secondary decoration-dotted text-3xl font-bold mt-10 mb-4 " href="#final-notes"><h2>Final notes</h2><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="hidden group-hover:block text-xl absolute pt-0.5 -left-7 stroke-[1.5px] text-secondary" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></div>
<p>As I was making this writeup, I realized that the quote-wrapping tricks used for the initial Perl part of the payload was sufficient for the entire payload, as it had code areas that ran exclusively in Perl, JS, and Python.</p>
<p>Then, our entire payload can just be simplified to</p>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z"></path></svg> <!-- -->js<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; q=&quot;&quot;&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;fs&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token comment">/*=;
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>open(FH, &quot;&lt;&quot;, &quot;./flag.txt&quot;); print &lt;FH&gt;;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="token comment">#*/</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2;#&quot;&quot;&quot;; print(open(&#x27;./flag.txt&#x27;).read())</span></code></pre></div></div>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"></path></svg> <!-- -->py<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> q</span><span class="token operator">=</span><span class="token triple-quoted-string string">&quot;&quot;&quot;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>console.log(require(&#x27;fs&#x27;).readFileSync(&#x27;./flag.txt&#x27;).toString()); /*=;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>open(FH, &quot;&lt;&quot;, &quot;./flag.txt&quot;); print &lt;FH&gt;;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span>#*/
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="token triple-quoted-string string">3 // 2;#&quot;&quot;&quot;</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div></div>
<div class="border border-white/10 rounded-lg my-2"><p class="flex items-center text-xs rounded-t-lg px-3 py-0.5 text-secondary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" class="text-sm mr-1.5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M11.638 0c-.148 0-.207.689-.252 2.925-.058 2.86-.07 2.949-.51 3.914-.36.793-1.623 2.676-2.037 3.04-.373.328-1.183 1.56-1.58 2.401-.71 1.504-.659 3.52-.04 5.047.518 1.194 1.262 2.156 2.46 3.182.94.805 1.23.919 1.375.544.049-.128-.162-.572-.483-1.018-.313-.436-.843-1.362-1.178-2.059-1.382-2.926-.7-5.357.902-8.045.89-1.393 1.403-2.642 1.579-3.852.22-1.515.043-6.079-.236-6.079zm-.757 1.215c-.186 0-.228.26-.228 1.422 0 .782-.08 1.654-.177 1.938-.312.914-1.154 1.737-3.482 3.404-1.684 1.205-3.096 2.652-3.64 3.732-1.666 3.299-.195 7.311 3.42 9.333 1.613.902 2.966 1.253 2.966.768 0-.126-.054-.228-.121-.228s-.632-.332-1.254-.738c-2.69-1.755-3.947-3.927-3.747-6.482.15-1.91.873-3.08 3.796-6.135 2.522-2.636 2.69-2.97 2.693-5.304.001-1.42-.036-1.71-.226-1.71zm1.508.632c-.103.017-.14.905-.142 2.903l-.004 2.926-.744 2.812c-.83 2.54-.954 5.133-.345 7.725.558 2.202.796 2.638 1.567 2.857.343.098.89.355 1.216.572.736.49 1.395.435 2.715-.232 1.92-.97 3.209-2.222 4.067-3.953.745-1.648.856-3.71.068-5.35-.7-1.414-1.882-2.554-4.358-4.197-2.162-1.436-2.617-1.82-3.15-2.652-.322-.503-.369-.724-.308-1.444.04-.468.126-.978.192-1.134.101-.239.069-.268-.202-.182-.26.082-.34.027-.42-.286-.061-.245-.112-.372-.152-.365zm.714 4.586c.034-.007.135.113.252.306.144.237 1.022 1 1.952 1.697 2.888 2.189 5.27 4.378 4.087 8.2-.405 1.146-.99 2.07-1.963 3.098-.544.575-1.266 1.09-1.53 1.09-.047 0 .252-.43.664-.954 1.337-1.7 1.972-3.718 1.79-5.674-.168-1.796-1.557-3.975-3.753-5.89-.912-.796-1.518-1.536-1.512-1.846 0-.016.005-.025.013-.027zm-1.089 15.492c-.208-.006-.297.349-.297 1.121 0 .94.018.988.342.942.302-.042.347-.15.387-.899.032-.613-.019-.902-.183-1.039-.097-.08-.18-.123-.249-.125zm-1.052.28c-.124-.002-.226.14-.327.43-.085.245-.253.481-.373.527-.322.124-.264.55.075.55.162 0 .402-.109.534-.24.441-.442.579-.824.382-1.062-.111-.134-.206-.203-.29-.205zm2.074.063c-.312 0-.28.61.053 1.034.309.392.908.567.908.264 0-.252-.775-1.298-.961-1.298z"></path></svg> <!-- -->perl<button class="ml-auto hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token string">q=&quot;&quot;&quot;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="token string">console.log(require(&#x27;fs&#x27;).readFileSync(&#x27;./flag.txt&#x27;).toString()); /*=</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">open</span><span class="token punctuation">(</span><span class="">FH</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;./flag.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class=""> </span><span class="token filehandle symbol">&lt;FH&gt;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token comment">#*/</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">#&quot;&quot;&quot;; print(open(&#x27;./flag.txt&#x27;).read())</span></code></pre></div></div>
<p>(we need to be careful about avoiding <code class="opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]">=</code>s in the JS section, lest we end the Perl string prematurely.)</p></main></div><!--$--><!--/$--></main><script src="/_next/static/chunks/webpack-7cc99edc1a50fd44.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[87555,[],\"\"]\n3:I[31295,[],\"\"]\n4:I[6874,[\"874\",\"static/chunks/874-3e820bd666038662.js\",\"633\",\"static/chunks/app/writeups/%5Bid%5D/layout-2577bd3482649595.js\"],\"\"]\n6:I[59665,[],\"OutletBoundary\"]\n8:I[74911,[],\"AsyncMetadataOutlet\"]\na:I[59665,[],\"ViewportBoundary\"]\nc:I[59665,[],\"MetadataBoundary\"]\nd:\"$Sreact.suspense\"\nf:I[28393,[],\"\"]\n:HL[\"/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/f53d5288e842910a.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"s9MJ02MDGdivoliH5zigB\",\"p\":\"\",\"c\":[\"\",\"writeups\",\"5ffffe2d75240def2e2d77c7e8243229\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"writeups\",{\"children\":[[\"id\",\"5ffffe2d75240def2e2d77c7e8243229\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f53d5288e842910a.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"className\":\"dark scroll-smooth\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}]}],[\"$\",\"body\",null,{\"className\":\"text-dark dark:text-white dark:bg-midnight\",\"style\":{\"fontFamily\":\"'Inter', 'Inter Fallback'\",\"fontStyle\":\"normal\"},\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"h-screen flex items-center justify-center\",\"children\":[\"$\",\"main\",null,{\"className\":\"relative pl-14\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"absolute left-0 top-2 text-5xl text-grapefruit\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],[\"$\",\"h1\",null,{\"className\":\"font-bold text-7xl underline decoration-grapefruit mb-5\",\"children\":\"404.\"}],[\"$\",\"p\",null,{\"children\":\"Your requested page was not found.\"}],[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"font-medium text-inherit\",\"children\":\"Return to home ‚Üí\"}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"writeups\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"main\",null,{\"className\":\"container pt-20 pb-24\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}],{\"children\":[[\"id\",\"5ffffe2d75240def2e2d77c7e8243229\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[[\"$\",\"$L4\",null,{\"href\":\"/writeups\",\"className\":\"text-secondary text-sm mb-10 -ml-5 block w-max\",\"children\":\"‚Üê Back to writeups\"}],[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$L7\",[\"$\",\"$L8\",null,{\"promise\":\"$@9\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$La\",null,{\"children\":\"$Lb\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$Lc\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$d\",null,{\"fallback\":null,\"children\":\"$Le\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n7:null\n"])</script><script>self.__next_f.push([1,"10:I[50674,[\"263\",\"static/chunks/bc9c3264-6371ca03223855d4.js\",\"810\",\"static/chunks/48507feb-8452885980bba250.js\",\"330\",\"static/chunks/08ffe114-f47006c90e36a3eb.js\",\"800\",\"static/chunks/800-bd0deb6e7b7e903a.js\",\"134\",\"static/chunks/app/writeups/%5Bid%5D/page-54fe20cc7a9d3224.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"children\":[\"$\",\"main\",null,{\"className\":\"text-pretty max-w-5xl mx-auto text-sm [\u0026_h1]:text-5xl [\u0026_h1]:font-semibold [\u0026_h1]:mb-8 [\u0026_blockquote]:text-secondary [\u0026_blockquote]:space-y-3 [\u0026_blockquote]:border-l-4 [\u0026_blockquote]:border-secondary [\u0026_blockquote]:pl-5 [\u0026_blockquote]:mb-5 [\u0026\u003e_p]:my-4 [\u0026_img]:my-5 [\u0026_ul]:list-disc [\u0026_ul]:pl-6 [\u0026_ol]:list-decimal [\u0026_ol]:pl-6 [\u0026_img]:rounded [\u0026_li]:my-2\",\"children\":[[\"$\",\"h1\",\"h1-0\",{\"children\":\"SDCTF 2025 ‚Äî triglot\"}],\"\\n\",[\"$\",\"blockquote\",\"blockquote-0\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"You think you know programming? You think you know languages? heh... as if üôÑ\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":\"Come back to me when you can write a program that runs in the 3 deadly P's: Perl, Python, and (P)Javascript\"}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":[\"Connect with \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"nc -q 2 -N 52.8.15.62 8001\"}]]}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":[\"Flag is located at \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"./flag.txt\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"We're given a script that looks like this:\"}],\"\\n\",[\"$\",\"$L10\",\"pre-0\",{\"className\":\"my-2\",\"children\":\"#!/usr/bin/env bash\\nset -eo pipefail\\n\\nwrong() {\\n  printf \\\"EXTREMELY LOUD INCORRECT BUZZER!!!\\\\n\\\"\\n}\\ntrap wrong ERR\\n\\ncode=$(cat)\\n\\nprintf '%s' \\\"$code\\\" | perl -c\\nprintf '%s' \\\"$code\\\" | python3 -c 'import sys,ast; ast.parse(sys.stdin.read())'\\nprintf '%s' \\\"$code\\\" | node -e \\\"const fs=require('fs'), src=fs.readFileSync(0,'utf8'); require('vm').createScript(src)\\\"\\n\\nperl_out=$(printf '%s' \\\"$code\\\" | perl -)\\npy_out=$(printf '%s' \\\"$code\\\" | python3 -)\\njs_out=$(printf '%s' \\\"$code\\\" | node -)\\n\\nif [[ \\\"$perl_out\\\" == \\\"$py_out\\\" \u0026\u0026 \\\"$perl_out\\\" == \\\"$js_out\\\" ]]; then\\n  printf \\\"Your triglot compiles!! Here's your output:\\\\n\\\"\\n  printf '%s\\\\n' \\\"$perl_out\\\"\\nelse\\n  exit 1\\nfi\",\"language\":\"bash\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":\"It seems like we just need to make a script that runs in Perl, Python, and JS, and prints the flag in each one.\"}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":[\"To start, a Python / JS polyglot seems pretty straightforward: we can use the fact that \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"//\"}],\" is floor division\\nin Python and a line comment in JS to create areas of our script only executed in Python:\"]}],\"\\n\",[\"$\",\"$L10\",\"pre-1\",{\"className\":\"my-2\",\"children\":\"3 // 2; [... code only executed in python]\",\"language\":\"js\"}],\"\\n\",[\"$\",\"$L10\",\"pre-2\",{\"className\":\"my-2\",\"children\":\"3 // 2; [... code only executed in python]\",\"language\":\"py\"}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":\"With this, we can use Python multi-line strings to \\\"comment out\\\" chunks of code to be only executed in JS:\"}],\"\\n\",[\"$\",\"$L10\",\"pre-3\",{\"className\":\"my-2\",\"children\":\"3 // 2; '''\\n[... code only executed in JS]\\n//'''\",\"language\":\"js\"}],\"\\n\",[\"$\",\"$L10\",\"pre-4\",{\"className\":\"my-2\",\"children\":\"3 // 2; '''\\n[... code only executed in JS]\\n//'''\",\"language\":\"py\"}],\"\\n\",[\"$\",\"p\",\"p-4\",{\"children\":\"Thus, our Python / JS polyglot that cats the flag is as simple as\"}],\"\\n\",[\"$\",\"$L10\",\"pre-5\",{\"className\":\"my-2\",\"children\":\"3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"js\"}],\"\\n\",[\"$\",\"$L10\",\"pre-6\",{\"className\":\"my-2\",\"children\":\"3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"py\"}],\"\\n\",[\"$\",\"p\",\"p-5\",{\"children\":[\"Now for the challenging part: adding Perl. We can try to use \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://stackoverflow.com/questions/3828205/how-do-i-enter-a-multi-line-comment-in-perl\",\"children\":\"Perl multiline comments\"}],\" to embed the above Python /\\nJS payload in a surrounding Perl script, but the syntax is too strange: the \",\"$L11\",\" \\\"start comment\\\" deliminator\"]}],\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\",\"\\n\",\"$L25\",\"\\n\",\"$L26\",\"\\n\",\"$L27\",\"\\n\",\"$L28\",\"\\n\",\"$L29\",\"\\n\",\"$L2a\",\"\\n\",\"$L2b\",\"\\n\",\"$L2c\",\"\\n\",\"$L2d\",\"\\n\",\"$L2e\",\"\\n\",\"$L2f\",\"\\n\",\"$L30\",\"\\n\",\"$L31\",\"\\n\",\"$L32\",\"\\n\",\"$L33\",\"\\n\",\"$L34\",\"\\n\",\"$L35\",\"\\n\",\"$L36\",\"\\n\",\"$L37\",\"\\n\",\"$L38\"]}]}]\n"])</script><script>self.__next_f.push([1,"11:[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"=hello\"}]\n12:[\"$\",\"$L10\",\"pre-7\",{\"className\":\"my-2\",\"children\":\"=hello\\n... perl comment\\n=cut\",\"language\":\"perl\"}]\n13:[\"$\",\"p\",\"p-6\",{\"children\":\"would give syntax errors in JS and Python, and trying to disguise it as a variable assignment e.g.\"}]\n14:[\"$\",\"$L10\",\"pre-8\",{\"className\":\"my-2\",\"children\":\"hello = 5;\\na\\n=hello\\n... perl comment\\n=cut\",\"language\":\"js\"}]\n15:[\"$\",\"p\",\"p-7\",{\"children\":\"would also lead to it being parsed as an assignment in Perl (with many errors following).\"}]\n16:[\"$\",\"p\",\"p-8\",{\"children\":[\"Instead, we can use the convenient \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://perldoc.perl.org/perldata#Special-Literals\",\"children\":[\"Perl \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"__END__\"}],\" special token\"]}],\"\\nto cause the Perl interpreter to ignore all subsequent text in the payload, avoiding having to manage Perl syntax errors\\nin the process!\"]}]\n17:[\"$\",\"p\",\"p-9\",{\"children\":\"Thus, the main idea becomes doing something like:\"}]\n18:[\"$\",\"$L10\",\"pre-9\",{\"className\":\"my-2\",\"children\":\"open(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n\\n__END__=5;\\n3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"js\"}]\n19:[\"$\",\"$L10\",\"pre-10\",{\"className\":\"my-2\",\"children\":\"open(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n\\n__END__=5;\\n3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"py\"}]\n1a:[\"$\",\"$L10\",\"pre-11\",{\"className\":\"my-2\",\"children\":\"open(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n\\n__END__=5;\\n3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"perl\"}]\n1b:[\"$\",\"p\",\"p-10\",{\"children\":[\"where we paste our JS / Python polyglot a"])</script><script>self.__next_f.push([1,"fter the \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"__END__\"}],\" token to avoid having to deal with Perl syntax there.\"]}]\n1c:[\"$\",\"p\",\"p-11\",{\"children\":[\"(note: we need to do \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"__END__=5\"}],\" and wrap the \",[\"$\",\"code\",\"code-1\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"__END__\"}],\" token in an assignment to avoid a JS \",[\"$\",\"code\",\"code-2\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"ReferenceError\"}],\" or Python\\n\",[\"$\",\"code\",\"code-3\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"NameError\"}],\".)\"]}]\n1d:[\"$\",\"p\",\"p-12\",{\"children\":\"Finally, we just need to figure out a way to get the first\"}]\n1e:[\"$\",\"$L10\",\"pre-12\",{\"className\":\"my-2\",\"children\":\"open(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\",\"language\":\"perl\"}]\n1f:[\"$\",\"p\",\"p-13\",{\"children\":\"Perl snippet to not raise syntax errors in Python or JS.\"}]\n20:[\"$\",\"p\",\"p-14\",{\"children\":[\"This part is a bit tricky: we need to use the \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"//\"}],\" trick from before (which is luckily valid Perl for \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://perldoc.perl.org/perlop#Logical-Defined-Or\",\"children\":\"short-circuited \\\"definedness\\nOR\\\"\"}],\") to comment out Python- / Perl-only areas.\"]}]\n21:[\"$\",\"p\",\"p-15\",{\"children\":[\"Since single-line comments are started by \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"#\"}],\" in both Perl and Python, we need to use multiline strings for Python\\ncomments instead. Note that if we're \",[\"$\",\"em\",\"em-0\",{\"children\":\"inside a string\"}],\", \",[\"$\",\"code\",\"code-1\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"#\"}],\" won't start a single-line comment; thus, we can try to layer s"])</script><script>self.__next_f.push([1,"trings\\nsuch that we are inside a string in Python and not Perl, and vice versa to comment out different sections of code in each.\"]}]\n22:[\"$\",\"p\",\"p-16\",{\"children\":[\"But there's one last trick, since simply having a python triple-quoted string in Perl will raise syntax errors: \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://perldoc.perl.org/perlop#Quote-Like-Operators\",\"children\":\"Perl \\\"quote-like operators\\\"\"}],\" (which I learned about from this \",[\"$\",\"a\",\"a-1\",{\"href\":\"https://github.com/floyd-fuh/C-CPP-Perl-Ruby-Python-Polyglot/blob/master/python_2_and_3_improvement/code.c\",\"children\":\"C, Ruby Perl, Python polyglot on GitHub\"}],\").\"]}]\n23:[\"$\",\"p\",\"p-17\",{\"children\":[\"We can use the token \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"q=\\\"\\\"\\\"\"}],\" to start a multi-line string in Python and a q-string in Perl, where:\"]}]\n24:[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"\\\"\\\"\\\"\"}],\" ends the Python string, and\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"=\"}],\" ends the Perl string,\"]}],\"\\n\"]}]\n25:[\"$\",\"p\",\"p-18\",{\"children\":\"letting us construct something like\"}]\n26:[\"$\",\"$L10\",\"pre-13\",{\"className\":\"my-2\",\"children\":\"q=\\\"\\\"\\\"\\n[... this is commented out in python and perl]\\n=;\\n[... this is commented out in python only]\\n#\\\"\\\"\\\"\",\"language\":\"py\"}]\n27:[\"$\",\"$L10\",\"pre-14\",{\"className\":\"my-2\",\"children\":\"q=\\\"\\\"\\\"\\n[... this is commented out in python and perl]\\n=;\\n[... this is commented out in python only]\\n#\\\"\\\"\\\"\",\"language\":\"perl\"}]\n28:[\"$\",\"p\",\"p-19\",{\"children\":\"Weaving these all together, we can construct\"}]\n29:[\"$\",\"$L10\",\"pre-15\",{\"className\":\"my-2\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\n/*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"\",\"language\":\"js\"}]\n2a:[\"$\",\"$L10\",\"pre-16\",{\"className\":\"my-2\",\"children\":\"3 // 2; q=\\\"\\\"\\"])</script><script>self.__next_f.push([1,"\"\\n/*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"\",\"language\":\"py\"}]\n2b:[\"$\",\"$L10\",\"pre-17\",{\"className\":\"my-2\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\n/*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"\",\"language\":\"perl\"}]\n2c:[\"$\",\"p\",\"p-20\",{\"children\":\"for a final payload of\"}]\n2d:[\"$\",\"$L10\",\"pre-18\",{\"className\":\"my-2\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\n/*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"\\n\\n__END__=5;\\n3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"js\"}]\n2e:[\"$\",\"$L10\",\"pre-19\",{\"className\":\"my-2\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\n/*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"\\n\\n__END__=5;\\n3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"py\"}]\n2f:[\"$\",\"$L10\",\"pre-20\",{\"className\":\"my-2\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\n/*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"\\n\\n__END__=5;\\n3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"perl\"}]\n30:[\"$\",\"p\",\"p-21\",{\"children\":\"Submitting this, we get our flag:\"}]\n31:[\"$\",\"$L10\",\"pre-21\",{\"className\":\"my-2\",\"children\":\"kevin@ky28059:/mnt/c/users/kevin/Downloads$ cat payload | nc -q 4 -N 52.8.15.62 8001\\nYour triglot compiles!! Here's your output:\\nsdctf{y0u_know_s0_m4ny_langu4g3s!}\",\"language\":\"bash\"}]\n"])</script><script>self.__next_f.push([1,"32:[\"$\",\"div\",\"h3-0\",{\"className\":\"relative\",\"children\":[[\"$\",\"span\",null,{\"id\":\"final-notes\",\"className\":\"absolute -top-16\"}],[\"$\",\"a\",null,{\"className\":\"group flex gap-2 items-center text-inherit hover:underline decoration-1 underline-offset-4 decoration-secondary decoration-dotted text-3xl font-bold mt-10 mb-4 \",\"href\":\"#final-notes\",\"children\":[[\"$\",\"h2\",null,{\"children\":\"Final notes\"}],[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"none\",\"strokeWidth\":\"2\",\"viewBox\":\"0 0 24 24\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"hidden group-hover:block text-xl absolute pt-0.5 -left-7 stroke-[1.5px] text-secondary\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\",\"children\":\"$undefined\"}],[\"$\",\"path\",\"1\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}]]}]]}]\n"])</script><script>self.__next_f.push([1,"33:[\"$\",\"p\",\"p-22\",{\"children\":\"As I was making this writeup, I realized that the quote-wrapping tricks used for the initial Perl part of the payload was sufficient for the entire payload, as it had code areas that ran exclusively in Perl, JS, and Python.\"}]\n34:[\"$\",\"p\",\"p-23\",{\"children\":\"Then, our entire payload can just be simplified to\"}]\n35:[\"$\",\"$L10\",\"pre-22\",{\"className\":\"my-2\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\nconsole.log(require('fs').readFileSync('./flag.txt').toString()); /*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"; print(open('./flag.txt').read())\",\"language\":\"js\"}]\n36:[\"$\",\"$L10\",\"pre-23\",{\"className\":\"my-2\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\nconsole.log(require('fs').readFileSync('./flag.txt').toString()); /*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"; print(open('./flag.txt').read())\",\"language\":\"py\"}]\n37:[\"$\",\"$L10\",\"pre-24\",{\"className\":\"my-2\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\nconsole.log(require('fs').readFileSync('./flag.txt').toString()); /*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"; print(open('./flag.txt').read())\",\"language\":\"perl\"}]\n38:[\"$\",\"p\",\"p-24\",{\"children\":[\"(we need to be careful about avoiding \",[\"$\",\"code\",\"code-0\",{\"className\":\"opacity-75 bg-black/30 rounded px-1.5 py-1 text-[0.9em]\",\"children\":\"=\"}],\"s in the JS section, lest we end the Perl string prematurely.)\"]}]\n"])</script><script>self.__next_f.push([1,"9:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"SDCTF 2025 ‚Äî triglot | kevin.fish\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"You think you know programming? You think you know languages? heh... as if üôÑ\"}],[\"$\",\"meta\",\"2\",{\"property\":\"og:title\",\"content\":\"SDCTF 2025 ‚Äî triglot\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:description\",\"content\":\"You think you know programming? You think you know languages? heh... as if üôÑ\"}],[\"$\",\"meta\",\"4\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"5\",{\"name\":\"twitter:title\",\"content\":\"SDCTF 2025 ‚Äî triglot\"}],[\"$\",\"meta\",\"6\",{\"name\":\"twitter:description\",\"content\":\"You think you know programming? You think you know languages? heh... as if üôÑ\"}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"e:\"$9:metadata\"\n"])</script></body></html>