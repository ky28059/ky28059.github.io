<!DOCTYPE html><html class="dark scroll-smooth"><head><meta charSet="utf-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/cd9eb1f13d7f01c4.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-50d183473e3f8178.js"/><script src="/_next/static/chunks/4bd1b696-12b3d90ac4ed3802.js" async=""></script><script src="/_next/static/chunks/684-d3c2077e7b7fefb9.js" async=""></script><script src="/_next/static/chunks/main-app-99381da9a4c58049.js" async=""></script><script src="/_next/static/chunks/874-c62c375efd21db20.js" async=""></script><script src="/_next/static/chunks/app/writeups/layout-0d6432ad4376bd82.js" async=""></script><script src="/_next/static/chunks/325-8cc74193b249521f.js" async=""></script><script src="/_next/static/chunks/app/writeups/%5Bid%5D/page-d2275216898ea7fa.js" async=""></script><meta name="next-size-adjust" content=""/><title>kevin.fish</title><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="text-dark dark:text-white dark:bg-midnight" style="font-family:&#x27;Inter&#x27;, &#x27;Inter Fallback&#x27;;font-style:normal"><main class="container pt-20 pb-24"><a class="text-secondary text-sm mb-10 -ml-5 block w-max" href="/">‚Üê Back to home</a><div><main class="max-w-5xl mx-auto text-sm [&amp;_h1]:text-5xl [&amp;_h1]:font-semibold [&amp;_h1]:mb-8 [&amp;_blockquote]:text-secondary [&amp;_blockquote]:space-y-3 [&amp;_blockquote]:border-l-4 [&amp;_blockquote]:border-secondary [&amp;_blockquote]:pl-5 [&amp;_blockquote]:mb-5 [&amp;&gt;_p]:my-3 [&amp;_img]:my-5 [&amp;_ul]:list-disc [&amp;_ul]:pl-6 [&amp;_img]:rounded [&amp;_li]:my-2"><h1>SDCTF 2025 ‚Äî triglot</h1>
<blockquote>
<p>You think you know programming? You think you know languages? heh... as if üôÑ</p>
<p>Come back to me when you can write a program that runs in the 3 deadly P&#x27;s: Perl, Python, and (P)Javascript</p>
<p>Connect with <code class="text-primary bg-black/20 rounded p-1">nc -q 2 -N 52.8.15.62 8001</code></p>
<p>Flag is located at <code class="text-primary bg-black/20 rounded p-1">./flag.txt</code></p>
</blockquote>
<p>We&#x27;re given a script that looks like this:</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (bash)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token shebang important">#!/usr/bin/env bash</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token builtin class-name">set</span><span class=""> -eo pipefail
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">3</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token function-name function">wrong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class=""> </span><span class="token punctuation">{</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">  </span><span class="token builtin class-name">printf</span><span class=""> </span><span class="token string">&quot;EXTREMELY LOUD INCORRECT BUZZER!!!</span><span class="token string entity">\n</span><span class="token string">&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class=""></span><span class="token punctuation">}</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class=""></span><span class="token builtin class-name">trap</span><span class=""> wrong ERR
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">8</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class=""></span><span class="token assign-left variable">code</span><span class="token operator">=</span><span class="token variable">$(</span><span class="token variable function">cat</span><span class="token variable">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">10</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">11</span><span class=""></span><span class="token builtin class-name">printf</span><span class=""> </span><span class="token string">&#x27;%s&#x27;</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$code</span><span class="token string">&quot;</span><span class=""> </span><span class="token operator">|</span><span class=""> perl -c
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">12</span><span class=""></span><span class="token builtin class-name">printf</span><span class=""> </span><span class="token string">&#x27;%s&#x27;</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$code</span><span class="token string">&quot;</span><span class=""> </span><span class="token operator">|</span><span class=""> python3 -c </span><span class="token string">&#x27;import sys,ast; ast.parse(sys.stdin.read())&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">13</span><span class=""></span><span class="token builtin class-name">printf</span><span class=""> </span><span class="token string">&#x27;%s&#x27;</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$code</span><span class="token string">&quot;</span><span class=""> </span><span class="token operator">|</span><span class=""> </span><span class="token function">node</span><span class=""> -e </span><span class="token string">&quot;const fs=require(&#x27;fs&#x27;), src=fs.readFileSync(0,&#x27;utf8&#x27;); require(&#x27;vm&#x27;).createScript(src)&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">14</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">15</span><span class=""></span><span class="token assign-left variable">perl_out</span><span class="token operator">=</span><span class="token variable">$(</span><span class="token variable builtin class-name">printf</span><span class="token variable"> </span><span class="token variable string">&#x27;%s&#x27;</span><span class="token variable"> </span><span class="token variable string">&quot;</span><span class="token variable string">$code</span><span class="token variable string">&quot;</span><span class="token variable"> </span><span class="token variable operator">|</span><span class="token variable"> perl -</span><span class="token variable">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">16</span><span class=""></span><span class="token assign-left variable">py_out</span><span class="token operator">=</span><span class="token variable">$(</span><span class="token variable builtin class-name">printf</span><span class="token variable"> </span><span class="token variable string">&#x27;%s&#x27;</span><span class="token variable"> </span><span class="token variable string">&quot;</span><span class="token variable string">$code</span><span class="token variable string">&quot;</span><span class="token variable"> </span><span class="token variable operator">|</span><span class="token variable"> python3 -</span><span class="token variable">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">17</span><span class=""></span><span class="token assign-left variable">js_out</span><span class="token operator">=</span><span class="token variable">$(</span><span class="token variable builtin class-name">printf</span><span class="token variable"> </span><span class="token variable string">&#x27;%s&#x27;</span><span class="token variable"> </span><span class="token variable string">&quot;</span><span class="token variable string">$code</span><span class="token variable string">&quot;</span><span class="token variable"> </span><span class="token variable operator">|</span><span class="token variable"> </span><span class="token variable function">node</span><span class="token variable"> -</span><span class="token variable">)</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">18</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">19</span><span class=""></span><span class="token keyword">if</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$perl_out</span><span class="token string">&quot;</span><span class=""> </span><span class="token operator">==</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$py_out</span><span class="token string">&quot;</span><span class=""> </span><span class="token operator">&amp;&amp;</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$perl_out</span><span class="token string">&quot;</span><span class=""> </span><span class="token operator">==</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$js_out</span><span class="token string">&quot;</span><span class=""> </span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">then</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">20</span><span class="">  </span><span class="token builtin class-name">printf</span><span class=""> </span><span class="token string">&quot;Your triglot compiles!! Here&#x27;s your output:</span><span class="token string entity">\n</span><span class="token string">&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">21</span><span class="">  </span><span class="token builtin class-name">printf</span><span class=""> </span><span class="token string">&#x27;%s\n&#x27;</span><span class=""> </span><span class="token string">&quot;</span><span class="token string variable">$perl_out</span><span class="token string">&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">22</span><span class=""></span><span class="token keyword">else</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">23</span><span class="">  </span><span class="token builtin class-name">exit</span><span class=""> </span><span class="token number">1</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none">24</span><span class=""></span><span class="token keyword">fi</span></code></pre></div></div>
<p>It seems like we just need to make a script that runs in Perl, Python, and JS, and prints the flag in each one.</p>
<p>To start, a Python / JS polyglot seems pretty straightforward: we can use the fact that <code class="text-primary bg-black/20 rounded p-1">//</code> is floor division
in Python and a line comment in JS to create areas of our script only executed in Python:</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; [... code only executed in python]</span></code></pre></div></div>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (py)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class=""> code only executed </span><span class="token keyword">in</span><span class=""> python</span><span class="token punctuation">]</span></code></pre></div></div>
<p>With this, we can use Python multi-line strings to &quot;comment out&quot; chunks of code to be only executed in JS:</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; &#x27;&#x27;&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token punctuation">[</span><span class="token spread operator">...</span><span class=""> code only executed </span><span class="token keyword">in</span><span class=""> </span><span class="token constant">JS</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token comment">//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (py)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token triple-quoted-string string">&#x27;&#x27;&#x27;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>[... code only executed in JS]
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span>//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<p>Thus, our Python / JS polyglot that cats the flag is as simple as</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; print(open(&#x27;./flag.txt&#x27;).read()); &#x27;&#x27;&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token keyword">const</span><span class=""> </span><span class="token punctuation">{</span><span class=""> readFileSync </span><span class="token punctuation">}</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;fs&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token comment">//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (py)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token triple-quoted-string string">&#x27;&#x27;&#x27;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>const { readFileSync } = require(&#x27;fs&#x27;); console.log(readFileSync(&#x27;./flag.txt&#x27;).toString());
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<p>Now for the challenging part: adding Perl. We can try to use <a href="https://stackoverflow.com/questions/3828205/how-do-i-enter-a-multi-line-comment-in-perl">Perl multiline comments</a> to embed the above Python /
JS payload in a surrounding Perl script, but the syntax is too strange: the <code class="text-primary bg-black/20 rounded p-1">=hello</code> &quot;start comment&quot; deliminator</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (perl)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token comment">=hello
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>... perl comment
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span>=cut</span></code></pre></div></div>
<p>would give syntax errors in JS and Python, and trying to disguise it as a variable assignment e.g.</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">hello </span><span class="token operator">=</span><span class=""> </span><span class="token number">5</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>a
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class=""></span><span class="token operator">=</span><span class="">hello
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token spread operator">...</span><span class=""> perl comment
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token operator">=</span><span class="">cut</span></code></pre></div></div>
<p>would also lead to it being parsed as an assignment in Perl (with many errors following).</p>
<p>Instead, we can use the convenient <a href="https://perldoc.perl.org/perldata#Special-Literals">Perl <code class="text-primary bg-black/20 rounded p-1">__END__</code> special token</a>
to cause the Perl interpreter to ignore all subsequent text in the payload, avoiding having to manage Perl syntax errors
in the process!</p>
<p>Thus, the main idea becomes doing something like:</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token constant">FH</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;./flag.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> print </span><span class="token operator">&lt;</span><span class="token constant">FH</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">__END__</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; print(open(&#x27;./flag.txt&#x27;).read()); &#x27;&#x27;&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token keyword">const</span><span class=""> </span><span class="token punctuation">{</span><span class=""> readFileSync </span><span class="token punctuation">}</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;fs&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class=""></span><span class="token comment">//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (py)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="">FH</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;./flag.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class=""> </span><span class="token operator">&lt;</span><span class="">FH</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">__END__</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token triple-quoted-string string">&#x27;&#x27;&#x27;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span>const { readFileSync } = require(&#x27;fs&#x27;); console.log(readFileSync(&#x27;./flag.txt&#x27;).toString());
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span>//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (perl)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">open</span><span class="token punctuation">(</span><span class="">FH</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;./flag.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class=""> </span><span class="token filehandle symbol">&lt;FH&gt;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">__END__</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">open</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token string">&#x27;&#x27;</span><span class="">&#x27;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="">const </span><span class="token punctuation">{</span><span class=""> readFileSync </span><span class="token punctuation">}</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&#x27;fs&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> console</span><span class="token operator">.</span><span class="">log</span><span class="token punctuation">(</span><span class="">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span class=""></span><span class="token operator">//</span><span class="token string">&#x27;&#x27;</span><span class="">&#x27;</span></code></pre></div></div>
<p>where we paste our JS / Python polyglot after the <code class="text-primary bg-black/20 rounded p-1">__END__</code> token to avoid having to deal with Perl syntax there.</p>
<p>(note: we need to do <code class="text-primary bg-black/20 rounded p-1">__END__=5</code> and wrap the <code class="text-primary bg-black/20 rounded p-1">__END__</code> token in an assignment to avoid a JS <code class="text-primary bg-black/20 rounded p-1">ReferenceError</code> or Python
<code class="text-primary bg-black/20 rounded p-1">NameError</code>.)</p>
<p>Finally, we just need to figure out a way to get the first</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (perl)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">open</span><span class="token punctuation">(</span><span class="">FH</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;./flag.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class=""> </span><span class="token filehandle symbol">&lt;FH&gt;</span><span class="token punctuation">;</span></code></pre></div></div>
<p>Perl snippet to not raise syntax errors in Python or JS.</p>
<p>This part is a bit tricky: we need to use the <code class="text-primary bg-black/20 rounded p-1">//</code> trick from before (which is luckily valid Perl for <a href="https://perldoc.perl.org/perlop#Logical-Defined-Or">short-circuited &quot;definedness
OR&quot;</a>) to comment out Python- / Perl-only areas.</p>
<p>Since single-line comments are started by <code class="text-primary bg-black/20 rounded p-1">#</code> in both Perl and Python, we need to use multiline strings for Python
comments instead. Note that if we&#x27;re <em>inside a string</em>, <code class="text-primary bg-black/20 rounded p-1">#</code> won&#x27;t start a single-line comment; thus, we can try to layer strings
such that we are inside a string in Python and not Perl, and vice versa to comment out different sections of code in each.</p>
<p>But there&#x27;s one last trick, since simply having a python triple-quoted string in Perl will raise syntax errors: <a href="https://perldoc.perl.org/perlop#Quote-Like-Operators">Perl &quot;quote-like operators&quot;</a> (which I learned about from this <a href="https://github.com/floyd-fuh/C-CPP-Perl-Ruby-Python-Polyglot/blob/master/python_2_and_3_improvement/code.c">C, Ruby Perl, Python polyglot on GitHub</a>).</p>
<p>We can use the token <code class="text-primary bg-black/20 rounded p-1">q=&quot;&quot;&quot;</code> to start a multi-line string in Python and a q-string in Perl, where:</p>
<ul>
<li><code class="text-primary bg-black/20 rounded p-1">&quot;&quot;&quot;</code> ends the Python string, and</li>
<li><code class="text-primary bg-black/20 rounded p-1">=</code> ends the Perl string,</li>
</ul>
<p>letting us construct something like</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (py)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">q</span><span class="token operator">=</span><span class="token triple-quoted-string string">&quot;&quot;&quot;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>[... this is commented out in python and perl]
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span>=;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">4</span>[... this is commented out in python only]
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">5</span>#&quot;&quot;&quot;</span></code></pre></div></div>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (perl)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token string">q=&quot;&quot;&quot;
</span><span class="token string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>[... this is commented out in python and perl]
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="token string">=</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token punctuation">[</span><span class="token operator">...</span><span class=""> this is commented out in python only</span><span class="token punctuation">]</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token comment">#&quot;&quot;&quot;</span></code></pre></div></div>
<p>Weaving these all together, we can construct</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; q=&quot;&quot;&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token comment">/*=;
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>open(FH, &quot;&lt;&quot;, &quot;./flag.txt&quot;); print &lt;FH&gt;;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="token comment">#*/</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2;#&quot;&quot;&quot;</span></code></pre></div></div>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (py)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> q</span><span class="token operator">=</span><span class="token triple-quoted-string string">&quot;&quot;&quot;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>/*=;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>open(FH, &quot;&lt;&quot;, &quot;./flag.txt&quot;); print &lt;FH&gt;;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span>#*/
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span>3 // 2;#&quot;&quot;&quot;</span></code></pre></div></div>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (perl)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token string">q=&quot;&quot;&quot;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="token string">/*=</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">open</span><span class="token punctuation">(</span><span class="">FH</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;./flag.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class=""> </span><span class="token filehandle symbol">&lt;FH&gt;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token comment">#*/</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">#&quot;&quot;&quot;</span></code></pre></div></div>
<p>for a final payload of</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; q=&quot;&quot;&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token comment">/*=;
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>open(FH, &quot;&lt;&quot;, &quot;./flag.txt&quot;); print &lt;FH&gt;;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="token comment">#*/</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2;#&quot;&quot;&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">__END__</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; print(open(&#x27;./flag.txt&#x27;).read()); &#x27;&#x27;&#x27;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class=""></span><span class="token keyword">const</span><span class=""> </span><span class="token punctuation">{</span><span class=""> readFileSync </span><span class="token punctuation">}</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;fs&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class=""></span><span class="token comment">//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (py)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> q</span><span class="token operator">=</span><span class="token triple-quoted-string string">&quot;&quot;&quot;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>/*=;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>open(FH, &quot;&lt;&quot;, &quot;./flag.txt&quot;); print &lt;FH&gt;;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span>#*/
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="token triple-quoted-string string">3 // 2;#&quot;&quot;&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">__END__</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token triple-quoted-string string">&#x27;&#x27;&#x27;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span>const { readFileSync } = require(&#x27;fs&#x27;); console.log(readFileSync(&#x27;./flag.txt&#x27;).toString());
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span>//&#x27;&#x27;&#x27;</span></code></pre></div></div>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (perl)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token string">q=&quot;&quot;&quot;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="token string">/*=</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">open</span><span class="token punctuation">(</span><span class="">FH</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;./flag.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class=""> </span><span class="token filehandle symbol">&lt;FH&gt;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token comment">#*/</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">#&quot;&quot;&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span class="">__END__</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="">open</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token string">&#x27;&#x27;</span><span class="">&#x27;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span class="">const </span><span class="token punctuation">{</span><span class=""> readFileSync </span><span class="token punctuation">}</span><span class=""> </span><span class="token operator">=</span><span class=""> </span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&#x27;fs&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> console</span><span class="token operator">.</span><span class="">log</span><span class="token punctuation">(</span><span class="">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span><span class=""></span><span class="token operator">//</span><span class="token string">&#x27;&#x27;</span><span class="">&#x27;</span></code></pre></div></div>
<p>Submitting this, we get our flag:</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (bash)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="">kevin@ky28059:/mnt/c/users/kevin/Downloads$ </span><span class="token function">cat</span><span class=""> payload </span><span class="token operator">|</span><span class=""> </span><span class="token function">nc</span><span class=""> -q </span><span class="token number">4</span><span class=""> -N </span><span class="token number">52.8</span><span class="">.15.62 </span><span class="token number">8001</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="">Your triglot compiles</span><span class="token operator">!</span><span class="token operator">!</span><span class=""> Here&#x27;s your output:
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">sdctf</span><span class="token punctuation">{</span><span class="">y0u_know_s0_m4ny_langu4g3s</span><span class="token operator">!</span><span class="token punctuation">}</span></code></pre></div></div>
<div class="relative"><span id="final-notes" class="absolute -top-16"></span><a class="group flex gap-2 items-center text-inherit hover:underline decoration-1 underline-offset-4 decoration-secondary decoration-dotted text-3xl font-bold mt-10 mb-4 " href="#final-notes"><h2>Final notes</h2><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="hidden group-hover:block text-xl absolute pt-0.5 -left-7 stroke-[1.5px] text-secondary" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></div>
<p>As I was making this writeup, I realized that the quote-wrapping tricks used for the initial Perl part of the payload was sufficient for the entire payload, as it had code areas that ran exclusively in Perl, JS, and Python.</p>
<p>Then, our entire payload can just be simplified to</p>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (js)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2; q=&quot;&quot;&quot;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class=""></span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;fs&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">readFileSync</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token comment">/*=;
</span><span class="token comment"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>open(FH, &quot;&lt;&quot;, &quot;./flag.txt&quot;); print &lt;FH&gt;;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class="token comment">#*/</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token comment">// 2;#&quot;&quot;&quot;; print(open(&#x27;./flag.txt&#x27;).read())</span></code></pre></div></div>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (py)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> q</span><span class="token operator">=</span><span class="token triple-quoted-string string">&quot;&quot;&quot;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>console.log(require(&#x27;fs&#x27;).readFileSync(&#x27;./flag.txt&#x27;).toString()); /*=;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>open(FH, &quot;&lt;&quot;, &quot;./flag.txt&quot;); print &lt;FH&gt;;
</span><span class="token triple-quoted-string string"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span>#*/
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class="token triple-quoted-string string">3 // 2;#&quot;&quot;&quot;</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#x27;./flag.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div></div>
<div class="my-4"><p class="text-xs bg-black/10 rounded-t-lg px-4 py-0.5 text-secondary">Code<!-- --> (perl)<!-- -->:<!-- --> <button class="hover:underline">(copy)</button></p><div class="rounded-b-lg overflow-hidden text-xs"><pre class="prismjs"><code style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class=""> </span><span class="token string">q=&quot;&quot;&quot;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span class="token string">console.log(require(&#x27;fs&#x27;).readFileSync(&#x27;./flag.txt&#x27;).toString()); /*=</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span class="">open</span><span class="token punctuation">(</span><span class="">FH</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">,</span><span class=""> </span><span class="token string">&quot;./flag.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class=""> </span><span class="token keyword">print</span><span class=""> </span><span class="token filehandle symbol">&lt;FH&gt;</span><span class="token punctuation">;</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span class=""></span><span class="token comment">#*/</span><span class="">
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span class=""></span><span class="token number">3</span><span class=""> </span><span class="token operator">//</span><span class=""> </span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">#&quot;&quot;&quot;; print(open(&#x27;./flag.txt&#x27;).read())</span></code></pre></div></div>
<p>(we need to be careful about avoiding <code class="text-primary bg-black/20 rounded p-1">=</code>s in the JS section, lest we end the Perl string prematurely.)</p></main></div><!--$--><!--/$--><!--$--><!--/$--></main><script src="/_next/static/chunks/webpack-50d183473e3f8178.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[87555,[],\"\"]\n3:I[31295,[],\"\"]\n4:I[6874,[\"874\",\"static/chunks/874-c62c375efd21db20.js\",\"319\",\"static/chunks/app/writeups/layout-0d6432ad4376bd82.js\"],\"\"]\n6:I[59665,[],\"MetadataBoundary\"]\n8:I[59665,[],\"OutletBoundary\"]\nb:I[74911,[],\"AsyncMetadataOutlet\"]\nd:I[59665,[],\"ViewportBoundary\"]\nf:I[26614,[],\"\"]\n:HL[\"/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/cd9eb1f13d7f01c4.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"szKQotZwTHi_mCbYcI59p\",\"p\":\"\",\"c\":[\"\",\"writeups\",\"5ffffe2d75240def2e2d77c7e8243229\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"writeups\",{\"children\":[[\"id\",\"5ffffe2d75240def2e2d77c7e8243229\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/cd9eb1f13d7f01c4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"className\":\"dark scroll-smooth\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}]}],[\"$\",\"body\",null,{\"className\":\"text-dark dark:text-white dark:bg-midnight\",\"style\":{\"fontFamily\":\"'Inter', 'Inter Fallback'\",\"fontStyle\":\"normal\"},\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"h-screen flex items-center justify-center\",\"children\":[\"$\",\"main\",null,{\"className\":\"relative pl-14\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"absolute left-0 top-2 text-5xl text-grapefruit\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],[\"$\",\"h1\",null,{\"className\":\"font-bold text-7xl underline decoration-grapefruit mb-5\",\"children\":\"404.\"}],[\"$\",\"p\",null,{\"children\":\"Your requested page was not found.\"}],[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"font-medium text-inherit\",\"children\":\"Return to home ‚Üí\"}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"writeups\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"main\",null,{\"className\":\"container pt-20 pb-24\",\"children\":[[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"text-secondary text-sm mb-10 -ml-5 block w-max\",\"children\":\"‚Üê Back to home\"}],[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]]}],{\"children\":[[\"id\",\"5ffffe2d75240def2e2d77c7e8243229\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[\"$\",\"$L6\",null,{\"children\":\"$L7\"}],null,[\"$\",\"$L8\",null,{\"children\":[\"$L9\",\"$La\",[\"$\",\"$Lb\",null,{\"promise\":\"$@c\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"UdnOk5vJJQ5vgpNnxwa2d\",{\"children\":[[\"$\",\"$Ld\",null,{\"children\":\"$Le\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"10:\"$Sreact.suspense\"\n11:I[74911,[],\"AsyncMetadata\"]\n7:[\"$\",\"$10\",null,{\"fallback\":null,\"children\":[\"$\",\"$L11\",null,{\"promise\":\"$@12\"}]}]\n"])</script><script>self.__next_f.push([1,"a:null\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n9:null\n"])</script><script>self.__next_f.push([1,"12:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"kevin.fish\"}]],\"error\":null,\"digest\":\"$undefined\"}\nc:{\"metadata\":\"$12:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"13:I[50674,[\"325\",\"static/chunks/325-8cc74193b249521f.js\",\"134\",\"static/chunks/app/writeups/%5Bid%5D/page-d2275216898ea7fa.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"children\":[\"$\",\"main\",null,{\"className\":\"max-w-5xl mx-auto text-sm [\u0026_h1]:text-5xl [\u0026_h1]:font-semibold [\u0026_h1]:mb-8 [\u0026_blockquote]:text-secondary [\u0026_blockquote]:space-y-3 [\u0026_blockquote]:border-l-4 [\u0026_blockquote]:border-secondary [\u0026_blockquote]:pl-5 [\u0026_blockquote]:mb-5 [\u0026\u003e_p]:my-3 [\u0026_img]:my-5 [\u0026_ul]:list-disc [\u0026_ul]:pl-6 [\u0026_img]:rounded [\u0026_li]:my-2\",\"children\":[[\"$\",\"h1\",\"h1-0\",{\"children\":\"SDCTF 2025 ‚Äî triglot\"}],\"\\n\",[\"$\",\"blockquote\",\"blockquote-0\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"You think you know programming? You think you know languages? heh... as if üôÑ\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":\"Come back to me when you can write a program that runs in the 3 deadly P's: Perl, Python, and (P)Javascript\"}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":[\"Connect with \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"nc -q 2 -N 52.8.15.62 8001\"}]]}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":[\"Flag is located at \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"./flag.txt\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"We're given a script that looks like this:\"}],\"\\n\",[\"$\",\"$L13\",\"pre-0\",{\"className\":\"my-4\",\"children\":\"#!/usr/bin/env bash\\nset -eo pipefail\\n\\nwrong() {\\n  printf \\\"EXTREMELY LOUD INCORRECT BUZZER!!!\\\\n\\\"\\n}\\ntrap wrong ERR\\n\\ncode=$(cat)\\n\\nprintf '%s' \\\"$code\\\" | perl -c\\nprintf '%s' \\\"$code\\\" | python3 -c 'import sys,ast; ast.parse(sys.stdin.read())'\\nprintf '%s' \\\"$code\\\" | node -e \\\"const fs=require('fs'), src=fs.readFileSync(0,'utf8'); require('vm').createScript(src)\\\"\\n\\nperl_out=$(printf '%s' \\\"$code\\\" | perl -)\\npy_out=$(printf '%s' \\\"$code\\\" | python3 -)\\njs_out=$(printf '%s' \\\"$code\\\" | node -)\\n\\nif [[ \\\"$perl_out\\\" == \\\"$py_out\\\" \u0026\u0026 \\\"$perl_out\\\" == \\\"$js_out\\\" ]]; then\\n  printf \\\"Your triglot compiles!! Here's your output:\\\\n\\\"\\n  printf '%s\\\\n' \\\"$perl_out\\\"\\nelse\\n  exit 1\\nfi\",\"language\":\"bash\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":\"It seems like we just need to make a script that runs in Perl, Python, and JS, and prints the flag in each one.\"}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":[\"To start, a Python / JS polyglot seems pretty straightforward: we can use the fact that \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"//\"}],\" is floor division\\nin Python and a line comment in JS to create areas of our script only executed in Python:\"]}],\"\\n\",[\"$\",\"$L13\",\"pre-1\",{\"className\":\"my-4\",\"children\":\"3 // 2; [... code only executed in python]\",\"language\":\"js\"}],\"\\n\",[\"$\",\"$L13\",\"pre-2\",{\"className\":\"my-4\",\"children\":\"3 // 2; [... code only executed in python]\",\"language\":\"py\"}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":\"With this, we can use Python multi-line strings to \\\"comment out\\\" chunks of code to be only executed in JS:\"}],\"\\n\",[\"$\",\"$L13\",\"pre-3\",{\"className\":\"my-4\",\"children\":\"3 // 2; '''\\n[... code only executed in JS]\\n//'''\",\"language\":\"js\"}],\"\\n\",[\"$\",\"$L13\",\"pre-4\",{\"className\":\"my-4\",\"children\":\"3 // 2; '''\\n[... code only executed in JS]\\n//'''\",\"language\":\"py\"}],\"\\n\",[\"$\",\"p\",\"p-4\",{\"children\":\"Thus, our Python / JS polyglot that cats the flag is as simple as\"}],\"\\n\",[\"$\",\"$L13\",\"pre-5\",{\"className\":\"my-4\",\"children\":\"3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"js\"}],\"\\n\",[\"$\",\"$L13\",\"pre-6\",{\"className\":\"my-4\",\"children\":\"3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"py\"}],\"\\n\",[\"$\",\"p\",\"p-5\",{\"children\":[\"Now for the challenging part: adding Perl. We can try to use \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://stackoverflow.com/questions/3828205/how-do-i-enter-a-multi-line-comment-in-perl\",\"children\":\"Perl multiline comments\"}],\" to embed the above Python /\\nJS payload in a surrounding Perl script, but the syntax is too strange: the \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"=hello\"}],\" \\\"start comment\\\" deliminator\"]}],\"\\n\",[\"$\",\"$L13\",\"pre-7\",{\"className\":\"my-4\",\"children\":\"=hello\\n... perl comment\\n=cut\",\"language\":\"perl\"}],\"\\n\",[\"$\",\"p\",\"p-6\",{\"children\":\"would give syntax errors in JS and Python, and trying to disguise it as a variable assignment e.g.\"}],\"\\n\",[\"$\",\"$L13\",\"pre-8\",{\"className\":\"my-4\",\"children\":\"hello = 5;\\na\\n=hello\\n... perl comment\\n=cut\",\"language\":\"js\"}],\"\\n\",[\"$\",\"p\",\"p-7\",{\"children\":\"would also lead to it being parsed as an assignment in Perl (with many errors following).\"}],\"\\n\",[\"$\",\"p\",\"p-8\",{\"children\":[\"Instead, we can use the convenient \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://perldoc.perl.org/perldata#Special-Literals\",\"children\":[\"Perl \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"__END__\"}],\" special token\"]}],\"\\nto cause the Perl interpreter to ignore all subsequent text in the payload, avoiding having to manage Perl syntax errors\\nin the process!\"]}],\"\\n\",[\"$\",\"p\",\"p-9\",{\"children\":\"Thus, the main idea becomes doing something like:\"}],\"\\n\",[\"$\",\"$L13\",\"pre-9\",{\"className\":\"my-4\",\"children\":\"open(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n\\n__END__=5;\\n3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"js\"}],\"\\n\",[\"$\",\"$L13\",\"pre-10\",{\"className\":\"my-4\",\"children\":\"open(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n\\n__END__=5;\\n3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"py\"}],\"\\n\",[\"$\",\"$L13\",\"pre-11\",{\"className\":\"my-4\",\"children\":\"open(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n\\n__END__=5;\\n3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"perl\"}],\"\\n\",[\"$\",\"p\",\"p-10\",{\"children\":[\"where we paste our JS / Python polyglot after the \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"__END__\"}],\" token to avoid having to deal with Perl syntax there.\"]}],\"\\n\",[\"$\",\"p\",\"p-11\",{\"children\":[\"(note: we need to do \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"__END__=5\"}],\" and wrap the \",[\"$\",\"code\",\"code-1\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"__END__\"}],\" token in an assignment to avoid a JS \",[\"$\",\"code\",\"code-2\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"ReferenceError\"}],\" or Python\\n\",[\"$\",\"code\",\"code-3\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"NameError\"}],\".)\"]}],\"\\n\",[\"$\",\"p\",\"p-12\",{\"children\":\"Finally, we just need to figure out a way to get the first\"}],\"\\n\",[\"$\",\"$L13\",\"pre-12\",{\"className\":\"my-4\",\"children\":\"open(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\",\"language\":\"perl\"}],\"\\n\",[\"$\",\"p\",\"p-13\",{\"children\":\"Perl snippet to not raise syntax errors in Python or JS.\"}],\"\\n\",[\"$\",\"p\",\"p-14\",{\"children\":[\"This part is a bit tricky: we need to use the \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"//\"}],\" trick from before (which is luckily valid Perl for \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://perldoc.perl.org/perlop#Logical-Defined-Or\",\"children\":\"short-circuited \\\"definedness\\nOR\\\"\"}],\") to comment out Python- / Perl-only areas.\"]}],\"\\n\",[\"$\",\"p\",\"p-15\",{\"children\":[\"Since single-line comments are started by \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"#\"}],\" in both Perl and Python, we need to use multiline strings for Python\\ncomments instead. Note that if we're \",[\"$\",\"em\",\"em-0\",{\"children\":\"inside a string\"}],\", \",[\"$\",\"code\",\"code-1\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"#\"}],\" won't start a single-line comment; thus, we can try to layer strings\\nsuch that we are inside a string in Python and not Perl, and vice versa to comment out different sections of code in each.\"]}],\"\\n\",[\"$\",\"p\",\"p-16\",{\"children\":[\"But there's one last trick, since simply having a python triple-quoted string in Perl will raise syntax errors: \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://perldoc.perl.org/perlop#Quote-Like-Operators\",\"children\":\"Perl \\\"quote-like operators\\\"\"}],\" (which I learned about from this \",[\"$\",\"a\",\"a-1\",{\"href\":\"https://github.com/floyd-fuh/C-CPP-Perl-Ruby-Python-Polyglot/blob/master/python_2_and_3_improvement/code.c\",\"children\":\"C, Ruby Perl, Python polyglot on GitHub\"}],\").\"]}],\"\\n\",[\"$\",\"p\",\"p-17\",{\"children\":[\"We can use the token \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"q=\\\"\\\"\\\"\"}],\" to start a multi-line string in Python and a q-string in Perl, where:\"]}],\"\\n\",[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"\\\"\\\"\\\"\"}],\" ends the Python string, and\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"=\"}],\" ends the Perl string,\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-18\",{\"children\":\"letting us construct something like\"}],\"\\n\",[\"$\",\"$L13\",\"pre-13\",{\"className\":\"my-4\",\"children\":\"q=\\\"\\\"\\\"\\n[... this is commented out in python and perl]\\n=;\\n[... this is commented out in python only]\\n#\\\"\\\"\\\"\",\"language\":\"py\"}],\"\\n\",[\"$\",\"$L13\",\"pre-14\",{\"className\":\"my-4\",\"children\":\"q=\\\"\\\"\\\"\\n[... this is commented out in python and perl]\\n=;\\n[... this is commented out in python only]\\n#\\\"\\\"\\\"\",\"language\":\"perl\"}],\"\\n\",[\"$\",\"p\",\"p-19\",{\"children\":\"Weaving these all together, we can construct\"}],\"\\n\",[\"$\",\"$L13\",\"pre-15\",{\"className\":\"my-4\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\n/*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"\",\"language\":\"js\"}],\"\\n\",[\"$\",\"$L13\",\"pre-16\",{\"className\":\"my-4\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\n/*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"\",\"language\":\"py\"}],\"\\n\",[\"$\",\"$L13\",\"pre-17\",{\"className\":\"my-4\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\n/*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"\",\"language\":\"perl\"}],\"\\n\",[\"$\",\"p\",\"p-20\",{\"children\":\"for a final payload of\"}],\"\\n\",[\"$\",\"$L13\",\"pre-18\",{\"className\":\"my-4\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\n/*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"\\n\\n__END__=5;\\n3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"js\"}],\"\\n\",[\"$\",\"$L13\",\"pre-19\",{\"className\":\"my-4\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\n/*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"\\n\\n__END__=5;\\n3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"py\"}],\"\\n\",[\"$\",\"$L13\",\"pre-20\",{\"className\":\"my-4\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\n/*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"\\n\\n__END__=5;\\n3 // 2; print(open('./flag.txt').read()); '''\\nconst { readFileSync } = require('fs'); console.log(readFileSync('./flag.txt').toString());\\n//'''\",\"language\":\"perl\"}],\"\\n\",[\"$\",\"p\",\"p-21\",{\"children\":\"Submitting this, we get our flag:\"}],\"\\n\",[\"$\",\"$L13\",\"pre-21\",{\"className\":\"my-4\",\"children\":\"kevin@ky28059:/mnt/c/users/kevin/Downloads$ cat payload | nc -q 4 -N 52.8.15.62 8001\\nYour triglot compiles!! Here's your output:\\nsdctf{y0u_know_s0_m4ny_langu4g3s!}\",\"language\":\"bash\"}],\"\\n\",[\"$\",\"div\",\"h3-0\",{\"className\":\"relative\",\"children\":[[\"$\",\"span\",null,{\"id\":\"final-notes\",\"className\":\"absolute -top-16\"}],[\"$\",\"a\",null,{\"className\":\"group flex gap-2 items-center text-inherit hover:underline decoration-1 underline-offset-4 decoration-secondary decoration-dotted text-3xl font-bold mt-10 mb-4 \",\"href\":\"#final-notes\",\"children\":[[\"$\",\"h2\",null,{\"children\":\"Final notes\"}],[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"none\",\"strokeWidth\":\"2\",\"viewBox\":\"0 0 24 24\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"hidden group-hover:block text-xl absolute pt-0.5 -left-7 stroke-[1.5px] text-secondary\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\",\"children\":\"$undefined\"}],[\"$\",\"path\",\"1\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}]]}]]}],\"\\n\",[\"$\",\"p\",\"p-22\",{\"children\":\"As I was making this writeup, I realized that the quote-wrapping tricks used for the initial Perl part of the payload was sufficient for the entire payload, as it had code areas that ran exclusively in Perl, JS, and Python.\"}],\"\\n\",[\"$\",\"p\",\"p-23\",{\"children\":\"Then, our entire payload can just be simplified to\"}],\"\\n\",[\"$\",\"$L13\",\"pre-22\",{\"className\":\"my-4\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\nconsole.log(require('fs').readFileSync('./flag.txt').toString()); /*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"; print(open('./flag.txt').read())\",\"language\":\"js\"}],\"\\n\",[\"$\",\"$L13\",\"pre-23\",{\"className\":\"my-4\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\nconsole.log(require('fs').readFileSync('./flag.txt').toString()); /*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"; print(open('./flag.txt').read())\",\"language\":\"py\"}],\"\\n\",[\"$\",\"$L13\",\"pre-24\",{\"className\":\"my-4\",\"children\":\"3 // 2; q=\\\"\\\"\\\"\\nconsole.log(require('fs').readFileSync('./flag.txt').toString()); /*=;\\nopen(FH, \\\"\u003c\\\", \\\"./flag.txt\\\"); print \u003cFH\u003e;\\n#*/\\n3 // 2;#\\\"\\\"\\\"; print(open('./flag.txt').read())\",\"language\":\"perl\"}],\"\\n\",[\"$\",\"p\",\"p-24\",{\"children\":[\"(we need to be careful about avoiding \",[\"$\",\"code\",\"code-0\",{\"className\":\"text-primary bg-black/20 rounded p-1\",\"children\":\"=\"}],\"s in the JS section, lest we end the Perl string prematurely.)\"]}]]}]}]\n"])</script></body></html>